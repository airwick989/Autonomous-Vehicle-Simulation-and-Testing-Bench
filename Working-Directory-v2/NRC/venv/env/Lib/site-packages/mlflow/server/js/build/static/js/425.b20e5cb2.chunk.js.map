{"version":3,"file":"static/js/425.b20e5cb2.chunk.js","mappings":"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","sources":["experiment-tracking/components/experiment-page/hooks/useAsyncDispatch.ts","experiment-tracking/components/experiment-page/contexts/GetExperimentsContext.tsx","common/static/permission-denied-lock.svg","experiment-tracking/components/PermissionDeniedView.js","experiment-tracking/components/experiment-page/components/ExperimentViewArtifactLocation.tsx","experiment-tracking/components/experiment-page/components/ExperimentViewDescriptions.tsx","experiment-tracking/components/experiment-page/hooks/useFetchExperiments.ts","experiment-tracking/components/experiment-page/components/ExperimentViewNotes.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentViewLocalStore.ts","experiment-tracking/components/experiment-page/components/ExperimentViewOnboarding.tsx","../node_modules/react-intl/lib/src/components/useIntl.js","experiment-tracking/components/experiment-page/components/header/ExperimentViewCopyTitle.tsx","shared/building_blocks/CopyButton.jsx","shared/building_blocks/CopyBox.jsx","experiment-tracking/components/modals/GetLinkModal.js","experiment-tracking/components/experiment-page/components/header/ExperimentViewHeaderShareButton.tsx","experiment-tracking/components/experiment-page/components/header/ExperimentViewHeader.tsx","experiment-tracking/components/experiment-page/components/header/ExperimentViewHeaderCompare.tsx","experiment-tracking/types.ts","experiment-tracking/components/experiment-page/utils/experimentRuns.selector.ts","experiment-tracking/components/experiment-page/components/runs/cells/ColumnHeaderCell.tsx","experiment-tracking/components/experiment-page/components/runs/cells/DateCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/ExperimentNameCellRenderer.tsx","common/components/TrimmedText.js","common/static/logged-model.svg","common/static/registered-model.svg","experiment-tracking/components/experiment-page/components/runs/cells/ModelsCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/SourceCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/VersionCellRenderer.tsx","experiment-tracking/utils/CsvUtils.ts","experiment-tracking/components/experiment-page/utils/experimentPage.common-utils.ts","experiment-tracking/components/experiment-page/components/runs/cells/PinRowCellRenderer.tsx","experiment-tracking/components/experiment-page/components/runs/cells/RunNameCellRenderer.tsx","experiment-tracking/components/experiment-page/utils/experimentPage.column-utils.ts","experiment-tracking/components/modals/DeleteRunModal.js","experiment-tracking/components/modals/RestoreRunModal.js","experiment-tracking/components/experiment-page/hooks/useExperimentIds.ts","experiment-tracking/components/experiment-page/utils/experimentPage.fetch-utils.ts","experiment-tracking/components/experiment-page/models/SearchExperimentRunsFacetsState.ts","experiment-tracking/components/experiment-page/utils/persistSearchFacets.serializers.ts","experiment-tracking/components/experiment-page/utils/persistSearchFacets.ts","experiment-tracking/components/experiment-page/contexts/GetExperimentRunsContext.tsx","experiment-tracking/components/experiment-page/hooks/useFetchExperimentRuns.ts","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunModals.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsControlsActions.tsx","../node_modules/antd/es/badge/SingleNumber.js","../node_modules/antd/es/badge/ScrollNumber.js","../node_modules/antd/es/badge/utils.js","../node_modules/antd/es/badge/Ribbon.js","../node_modules/antd/es/badge/index.js","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRefreshButton.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsColumnSelector.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsControlsFilters.tsx","common/utils/FeatureUtils.ts","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsControls.tsx","experiment-tracking/components/experiment-page/hooks/useRunSortOptions.ts","common/components/ag-grid/AgGridLoader.tsx","common/components/ExperimentRunsTableEmptyOverlay.js","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTableAddColumnCTA.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRunsTable.tsx","experiment-tracking/components/experiment-page/models/SearchExperimentRunsViewState.ts","experiment-tracking/components/experiment-page/components/runs/ExperimentViewLoadMore.tsx","experiment-tracking/components/experiment-page/utils/experimentPage.row-utils.ts","experiment-tracking/components/runs-compare/RunsCompareCharts.tsx","experiment-tracking/components/runs-compare/charts/CompareRunsCharts.common.ts","experiment-tracking/components/runs-compare/charts/CompareRunsScatterPlot.tsx","experiment-tracking/components/runs-compare/ConfigureChartModal.tsx","experiment-tracking/components/runs-compare/RunsCompare.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewRuns.tsx","experiment-tracking/components/experiment-page/ExperimentView.tsx","experiment-tracking/components/experiment-page/hooks/useExperiments.ts","experiment-tracking/components/experiment-page/ExperimentPage.tsx"],"sourcesContent":["import { useDispatch } from 'react-redux';\nimport type { AnyAction } from 'redux';\n\n/**\n * Since we're using redux middlewares that promisify action dispatch\n * ('redux-promise-middleware'), we use this method as a sugar for useDispatch()\n * with correct typings.\n */\nexport const useAsyncDispatch = useDispatch as () => (action: AnyAction) => Promise<AnyAction>;\n","import { isEqual } from 'lodash';\nimport React, { createContext, useCallback, useMemo, useState } from 'react';\nimport RequestStateWrapper from '../../../../common/components/RequestStateWrapper';\nimport Utils from '../../../../common/utils/Utils';\n\nimport type {\n  getExperimentApi,\n  setCompareExperiments,\n  setExperimentTagApi,\n} from '../../../actions';\nimport { useAsyncDispatch } from '../hooks/useAsyncDispatch';\n\nexport interface GetExperimentsContextActions {\n  setExperimentTagApi: typeof setExperimentTagApi;\n  getExperimentApi: typeof getExperimentApi;\n  setCompareExperiments: typeof setCompareExperiments;\n}\n\nexport interface GetExperimentsContextType {\n  /**\n   * Function used to (re)fetch experiments using their IDs.\n   */\n  fetchExperiments: (experimentIds: string[]) => void;\n\n  /**\n   * Indicates if experiments are being loaded at the moment\n   */\n  isLoadingExperiment: boolean;\n\n  /**\n   * Contains error descriptor if fetching runs failed\n   */\n  requestError: any;\n\n  /**\n   * All experiment-related actions creators\n   */\n  actions: GetExperimentsContextActions;\n}\n\n/**\n * Wrapper context that aggregates concrete redux actions necessary to fetch experiments.\n */\nexport const GetExperimentsContext = createContext<GetExperimentsContextType | null>(null);\n\n/**\n * Provider component for GetExperimentsContext.\n * Accepts concrete redux actions for searching experiments.\n */\nexport const GetExperimentsContextProvider = ({\n  children,\n  actions,\n}: React.PropsWithChildren<{\n  actions: GetExperimentsContextActions;\n}>) => {\n  const [fetchExperimentsRequestIds, setFetchExperimentsRequestIds] = useState<string[]>([]);\n  const [isLoadingExperiment, setIsLoadingExperiment] = useState(false);\n\n  const [requestError, setRequestError] = useState<any>(null);\n\n  const dispatch = useAsyncDispatch();\n\n  const fetchExperiments = useCallback(\n    (experimentIds: string[]) => {\n      const fetchFn = () => {\n        const newRequestIds = experimentIds.map((experimentId) => {\n          const requestAction = actions.getExperimentApi(experimentId);\n          dispatch(requestAction).catch((e) => {\n            Utils.logErrorAndNotifyUser(e);\n          });\n          return requestAction.meta.id;\n        });\n        setFetchExperimentsRequestIds((requestIds) =>\n          isEqual(newRequestIds, requestIds) ? requestIds : newRequestIds,\n        );\n      };\n\n      setRequestError(null);\n      fetchFn();\n    },\n    [actions, dispatch],\n  );\n\n  const contextValue = useMemo(\n    () => ({\n      fetchExperiments,\n      isLoadingExperiment,\n      requestError: requestError,\n      actions,\n    }),\n    [actions, fetchExperiments, isLoadingExperiment, requestError],\n  );\n\n  const renderFn = (_isLoading: false, _renderError: any, requests: any[]) => {\n    /**\n     * TODO:\n     * Defer setting this state because currently it might happen inside\n     * RequestStateWrapper's render function which causes React to act up.\n     * Either rebuild RequestStateWrapper or introduce some workaround.\n     */\n    setIsLoadingExperiment(\n      requests.some((r) => fetchExperimentsRequestIds.includes(r.id) && r.active),\n    );\n\n    if (!requestError) {\n      requests.forEach((request) => {\n        if (request.error) {\n          setRequestError(request.error);\n        }\n      });\n    }\n\n    return children;\n  };\n\n  return (\n    <GetExperimentsContext.Provider value={contextValue}>\n      <RequestStateWrapper\n        shouldOptimisticallyRender\n        // eslint-disable-next-line no-trailing-spaces\n        requestIds={fetchExperimentsRequestIds}\n      >\n        {renderFn}\n      </RequestStateWrapper>\n    </GetExperimentsContext.Provider>\n  );\n};\n","var _desc, _g;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgPermissionDeniedLock(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"58px\",\n    height: \"75px\",\n    viewBox: \"0 0 58 75\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Privacy_Lock\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _desc || (_desc = /*#__PURE__*/React.createElement(\"desc\", null, \"Created with Sketch.\")), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"EmptyState\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"ErrorPage-noPermission\",\n    transform: \"translate(-691.000000, -194.000000)\",\n    fill: \"#43C8EC\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Privacy_Lock\",\n    transform: \"translate(691.000000, 194.250000)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M45.8,24.31 L45.8,17.16 C45.8,7.84295627 38.2470437,0.29 28.93,0.29 C19.6129563,0.29 12.06,7.84295627 12.06,17.16 L12.06,24.3 L0.14,24.3 L0.14,74.64 L57.71,74.64 L57.71,24.31 L45.8,24.31 Z M14.05,17.16 C14.05,8.94752577 20.7075258,2.29 28.92,2.29 C37.1324742,2.29 43.79,8.94752577 43.79,17.16 L43.79,24.3 L14.05,24.3 L14.05,17.16 Z M55.71,72.64 L2.14,72.64 L2.14,26.31 L55.71,26.31 L55.71,72.64 Z\",\n    id: \"Shape\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M28.93,37.33 C26.5550177,37.3567611 24.5749652,39.154747 24.319954,41.5161505 C24.0649429,43.8775541 25.6154871,46.0568139 27.93,46.59 L27.93,62.54 L29.93,62.54 L29.93,46.6 C32.2445129,46.0668139 33.7950571,43.8875541 33.540046,41.5261505 C33.2850348,39.164747 31.3049823,37.3667611 28.93,37.34 L28.93,37.33 Z\",\n    id: \"Path\"\n  }))))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgPermissionDeniedLock);\nexport default __webpack_public_path__ + \"static/media/permission-denied-lock.16036747d57cd663d7df223781a447b2.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\nimport PropTypes from 'prop-types';\nimport permissionDeniedLock from '../../common/static/permission-denied-lock.svg';\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nconst defaultMessage = 'The current user does not have permission to view this page.';\n\nexport function PermissionDeniedView({ errorMessage }) {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div className='center'>\n      <img\n        style={{ height: 300, marginTop: 80 }}\n        src={permissionDeniedLock}\n        alt='permission denied'\n      />\n      <h1 style={{ paddingTop: 10 }}>Permission Denied</h1>\n      <h2 data-testid='error-message' css={{ color: theme.colors.textSecondary }}>\n        {errorMessage || defaultMessage}\n      </h2>\n    </div>\n  );\n}\n\nPermissionDeniedView.propTypes = {\n  errorMessage: PropTypes.string,\n};\n","import React from 'react';\n\nexport interface ExperimentViewArtifactLocationProps {\n  artifactLocation: string;\n}\n\nexport const ExperimentViewArtifactLocation = ({\n  artifactLocation,\n}: ExperimentViewArtifactLocationProps) => {\n  return <>{artifactLocation}</>;\n};\n","import { Typography } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { ExperimentEntity } from '../../../types';\nimport { ExperimentViewArtifactLocation } from './ExperimentViewArtifactLocation';\n\nexport const ExperimentViewDescriptions = React.memo(\n  ({ experiment }: { experiment: ExperimentEntity }) => (\n    <div css={styles.container}>\n      <Typography.Text color='secondary'>\n        <FormattedMessage\n          defaultMessage='Experiment ID'\n          description='Label for displaying the current experiment in view'\n        />\n        : {experiment.experiment_id}\n      </Typography.Text>\n      <Typography.Text color='secondary'>\n        <FormattedMessage\n          defaultMessage='Artifact Location'\n          description='Label for displaying the experiment artifact location'\n        />\n        : <ExperimentViewArtifactLocation artifactLocation={experiment.artifact_location} />\n      </Typography.Text>\n    </div>\n  ),\n);\n\nconst styles = {\n  container: (theme: Theme) => ({\n    display: 'flex' as const,\n    gap: theme.spacing.lg,\n  }),\n};\n","import { useContext } from 'react';\n\nimport { GetExperimentsContext } from '../contexts/GetExperimentsContext';\n\nexport const useFetchExperiments = () => {\n  const getExperimentsContext = useContext(GetExperimentsContext);\n\n  if (!getExperimentsContext) {\n    throw new Error('Trying to use GetExperimentsContext actions outside of the context!');\n  }\n\n  return getExperimentsContext;\n};\n","import { Button } from '@databricks/design-system';\nimport React, { useCallback, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { useSelector } from 'react-redux';\nimport { CollapsibleSection } from '../../../../common/components/CollapsibleSection';\nimport { EditableNote } from '../../../../common/components/EditableNote';\nimport { getExperimentTags } from '../../../reducers/Reducers';\nimport { ExperimentEntity, KeyValueEntity } from '../../../types';\nimport { NOTE_CONTENT_TAG } from '../../../utils/NoteUtils';\nimport { useAsyncDispatch } from '../hooks/useAsyncDispatch';\nimport { useFetchExperiments } from '../hooks/useFetchExperiments';\n\nconst extractNoteFromTags = (tags: Record<string, KeyValueEntity>) =>\n  Object.values(tags).find((t) => t.getKey() === NOTE_CONTENT_TAG)?.value || undefined;\n\nexport interface ExperimentViewNotesProps {\n  experiment: ExperimentEntity;\n}\n\n/**\n * ExperimentView part responsible for displaying/editing note.\n *\n * Consumes note from the redux store and dispatches\n * `setExperimentTagApi` redux action from the context.\n */\nexport const ExperimentViewNotes = React.memo(({ experiment }: ExperimentViewNotesProps) => {\n  const storedNote = useSelector((state) => {\n    const tags = getExperimentTags(experiment.experiment_id, state);\n    return tags ? extractNoteFromTags(tags) : '';\n  });\n\n  const [showNotesEditor, setShowNotesEditor] = useState(false);\n\n  const {\n    actions: { setExperimentTagApi },\n  } = useFetchExperiments();\n\n  const dispatch = useAsyncDispatch();\n\n  const handleSubmitEditNote = useCallback(\n    (updatedNote: any) => {\n      const action = setExperimentTagApi(experiment.experiment_id, NOTE_CONTENT_TAG, updatedNote);\n      dispatch(action).then(() => setShowNotesEditor(false));\n    },\n    [experiment.experiment_id, setExperimentTagApi, dispatch],\n  );\n\n  return (\n    <CollapsibleSection\n      title={\n        <span css={styles.collapsibleSectionHeader}>\n          <FormattedMessage\n            defaultMessage='Description'\n            description='Header for displaying notes for the experiment table'\n          />{' '}\n          {!showNotesEditor && (\n            <Button type='link' onClick={() => setShowNotesEditor(true)}>\n              <FormattedMessage\n                defaultMessage='Edit'\n                // eslint-disable-next-line max-len\n                description='Text for the edit button next to the description section title on the experiment view page'\n              />\n            </Button>\n          )}\n        </span>\n      }\n      forceOpen={showNotesEditor}\n      defaultCollapsed={!storedNote}\n      data-test-id='experiment-notes-section'\n    >\n      <EditableNote\n        defaultMarkdown={storedNote}\n        onSubmit={handleSubmitEditNote}\n        onCancel={() => setShowNotesEditor(false)}\n        showEditor={showNotesEditor}\n      />\n    </CollapsibleSection>\n  );\n});\n\nconst styles = {\n  collapsibleSectionHeader: {\n    height: '32px',\n    lineHeight: '32px',\n  },\n};\n","import { useMemo } from 'react';\nimport LocalStorageUtils from '../../../../common/utils/LocalStorageUtils';\n\n/**\n * This hook returns a memoized version of persistable store namespaced for the ExperimentView.\n * It can serve as a store for persisting state for a particular experiment - in this case,\n * the experiment id should be provided as a `identifier` parameter. It can also serve as a store for some\n * general purpose - e.g. you can provide \"onboarding\" as a identifier to get a store specific\n * for the onboarding section of the experiment view.\n *\n * @param storeIdentifier a unique identifier of created store - can be an experiment id or a general purpose name\n */\nexport const useExperimentViewLocalStore = (storeIdentifier: string) =>\n  useMemo(\n    () => LocalStorageUtils.getStoreForComponent('ExperimentView', storeIdentifier),\n    [storeIdentifier],\n  );\n","import { Alert, Spacer } from '@databricks/design-system';\nimport React, { useCallback } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { useExperimentViewLocalStore } from '../hooks/useExperimentViewLocalStore';\nimport { ExperimentTrackingDocUrl, onboarding as ONBOARDING } from '../../../../common/constants';\n\nconst showTrackingHelperStoreKey = 'showTrackingHelper';\n\nconst getLearnMoreLinkUrl = () => ExperimentTrackingDocUrl;\n\nexport const ExperimentViewOnboarding = React.memo(() => {\n  const onboardingLocalStore = useExperimentViewLocalStore(ONBOARDING);\n\n  const disableOnboardingHelper = useCallback(() => {\n    onboardingLocalStore.setItem(showTrackingHelperStoreKey, 'false');\n  }, [onboardingLocalStore]);\n\n  const displayOnboarding = onboardingLocalStore.getItem(showTrackingHelperStoreKey) !== 'false';\n\n  return displayOnboarding ? (\n    <>\n      <Alert\n        message={\n          <FormattedMessage\n            defaultMessage='Track machine learning training runs in experiments. <link>Learn more</link>'\n            description='Information banner text to provide more information about experiments runs page'\n            values={{\n              link: (chunks: any) => (\n                <a href={getLearnMoreLinkUrl()} target='_blank' rel='noopener noreferrer'>\n                  {chunks}\n                </a>\n              ),\n            }}\n          />\n        }\n        type='info'\n        closable\n        onClose={disableOnboardingHelper}\n      />\n      <Spacer />\n    </>\n  ) : null;\n});\n","import * as React from 'react';\nimport { Context } from './injectIntl';\nimport { invariantIntlContext } from '../utils';\nexport default function useIntl() {\n    var intl = React.useContext(Context);\n    invariantIntlContext(intl);\n    return intl;\n}\n","import { CopyIcon, Typography } from '@databricks/design-system';\nimport { useIntl } from 'react-intl';\nimport { ExperimentEntity } from '../../../../types';\n\n/**\n * Experiment page header part responsible for copying\n * the title after clicking on the icon\n */\nexport const ExperimentViewCopyTitle = ({ experiment }: { experiment: ExperimentEntity }) => {\n  const intl = useIntl();\n\n  return (\n    <Typography.Text\n      size='xl'\n      dangerouslySetAntdProps={{\n        copyable: {\n          text: experiment.name,\n          icon: <CopyIcon />,\n          tooltips: [\n            intl.formatMessage({\n              defaultMessage: 'Copy path',\n              description: 'Copy tooltip to copy experiment path from experiment runs table header',\n            }),\n            intl.formatMessage({\n              defaultMessage: 'Path copied',\n              description:\n                'Tooltip displayed after experiment path was successfully copied to clipboard',\n            }),\n          ],\n        },\n      }}\n    />\n  );\n};\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { FormattedMessage } from 'react-intl';\nimport { Button, Tooltip } from '@databricks/design-system';\n\nexport const CopyButton = ({ copyText }) => {\n  const [showTooltip, setShowTooltip] = useState(false);\n\n  const handleClick = () => {\n    navigator.clipboard.writeText(copyText);\n    setShowTooltip(true);\n    setTimeout(() => {\n      setShowTooltip(false);\n    }, 3000);\n  };\n\n  const handleMouseLeave = () => {\n    setShowTooltip(false);\n  };\n\n  return (\n    <Tooltip\n      title={\n        <FormattedMessage\n          defaultMessage='Copied'\n          description='Tooltip text shown when copy operation completes'\n        />\n      }\n      dangerouslySetAntdProps={{\n        visible: showTooltip,\n      }}\n    >\n      <Button type='primary' onClick={handleClick} onMouseLeave={handleMouseLeave}>\n        <FormattedMessage defaultMessage='Copy' description='Button text for copy button' />\n      </Button>\n    </Tooltip>\n  );\n};\n\nCopyButton.propTypes = {\n  copyText: PropTypes.string.isRequired,\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Input } from '@databricks/design-system';\nimport { CopyButton } from './CopyButton';\n\nexport const CopyBox = ({ copyText }) => (\n  <div css={{ display: 'flex', gap: 4 }}>\n    <Input readOnly value={copyText} data-test-id='copy-box' />\n    <CopyButton copyText={copyText} />\n  </div>\n);\n\nCopyBox.propTypes = {\n  copyText: PropTypes.string.isRequired,\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { FormattedMessage } from 'react-intl';\nimport { Modal } from '@databricks/design-system';\nimport { CopyBox } from '../../../shared/building_blocks/CopyBox';\n\nexport const GetLinkModal = ({ visible, onCancel, link }) => {\n  return (\n    <Modal\n      title={\n        <FormattedMessage defaultMessage='Get Link' description={'Title text for get-link modal'} />\n      }\n      visible={visible}\n      onCancel={onCancel}\n    >\n      <CopyBox copyText={link} />\n    </Modal>\n  );\n};\n\nGetLinkModal.propTypes = {\n  visible: PropTypes.bool.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  link: PropTypes.string.isRequired,\n};\n","import { Button } from '@databricks/design-system';\nimport { useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { GetLinkModal } from '../../../modals/GetLinkModal';\n\n/**\n * Experiment page header part responsible for displaying button\n * that displays modal for sharing the link\n */\nexport const ExperimentViewHeaderShareButton = () => {\n  const [showGetLinkModal, setShowGetLinkModal] = useState(false);\n\n  return (\n    <>\n      <GetLinkModal\n        link={window.top?.location.href || window.location.href}\n        visible={showGetLinkModal}\n        onCancel={() => setShowGetLinkModal(false)}\n      />\n      {/* TODO: ensure that E2E tests are working after refactor is complete */}\n      <Button type='primary' onClick={() => setShowGetLinkModal(true)} data-test-id='share-button'>\n        <FormattedMessage\n          defaultMessage='Share'\n          description='Text for share button on experiment view page header'\n        />\n      </Button>\n    </>\n  );\n};\n","import React, { useMemo } from 'react';\nimport { PageHeader } from '../../../../../shared/building_blocks/PageHeader';\nimport { ExperimentViewCopyTitle } from './ExperimentViewCopyTitle';\nimport { ExperimentViewHeaderShareButton } from './ExperimentViewHeaderShareButton';\nimport { ExperimentEntity } from '../../../../types';\n\n/**\n * Header for a single experiment page. Displays title, breadcrumbs and provides\n * controls for renaming, deleting and editing permissions.\n */\nexport const ExperimentViewHeader = React.memo(\n  ({ experiment }: { experiment: ExperimentEntity }) => {\n    // eslint-disable-next-line prefer-const\n    let breadcrumbs: React.ReactNode[] = [];\n\n    /**\n     * Extract the last part of the experiment name\n     */\n    const normalizedExperimentName = useMemo(\n      () => experiment.name.split('/').pop(),\n      [experiment.name],\n    );\n\n    /* eslint-disable prettier/prettier */\n    return (\n      <PageHeader\n        title={\n          <>\n            {normalizedExperimentName} <ExperimentViewCopyTitle experiment={experiment} />\n          </>\n        }\n        breadcrumbs={breadcrumbs}\n      >\n          <ExperimentViewHeaderShareButton />\n      </PageHeader>\n    );\n    /* eslint-enable prettier/prettier */\n  },\n);\n","import React, { useMemo } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { PageHeader } from '../../../../../shared/building_blocks/PageHeader';\nimport { ExperimentViewHeaderShareButton } from './ExperimentViewHeaderShareButton';\nimport { ExperimentEntity } from '../../../../types';\n\n/**\n * Header for experiment compare page. Displays title and breadcrumbs.\n */\nexport const ExperimentViewHeaderCompare = React.memo(\n  ({ experiments }: { experiments: ExperimentEntity[] }) => {\n    const pageTitle = useMemo(\n      () => (\n        <FormattedMessage\n          defaultMessage='Displaying Runs from {numExperiments} Experiments'\n          description='Message shown when displaying runs from multiple experiments'\n          values={{\n            numExperiments: experiments.length,\n          }}\n        />\n      ),\n      [experiments.length],\n    );\n\n    // eslint-disable-next-line prefer-const\n    let breadcrumbs: React.ReactNode[] = [];\n\n    /* eslint-disable prettier/prettier */\n    return (\n      <PageHeader title={pageTitle} breadcrumbs={breadcrumbs}>\n        <ExperimentViewHeaderShareButton />\n      </PageHeader>\n    );\n    /* eslint-enable prettier/prettier */\n  },\n);\n","/**\n * Type definitions for models used in experiment tracking.\n * See 'src/experiment-tracking/sdk/MlflowMessages.js' for reference\n *\n * Note: this could be automatically generated in the future.\n */\n\nimport { SearchExperimentRunsFacetsState } from './components/experiment-page/models/SearchExperimentRunsFacetsState';\nimport { SearchExperimentRunsViewState } from './components/experiment-page/models/SearchExperimentRunsViewState';\n\n/**\n * Simple key/value model enhanced with immutable.js\n * getter methods\n */\nexport interface KeyValueEntity {\n  key: string;\n  value: string;\n\n  getKey(): string;\n  getValue(): string;\n}\n\n/**\n * An entity defining a single model entity\n */\nexport interface ModelInfoEntity {\n  name: string;\n  version: string;\n  creation_timestamp: number;\n  last_updated_timestamp: number;\n  user_id: string;\n  current_stage: string;\n  source: string;\n  run_id: string;\n  status: string;\n  permission_level: string;\n  email_subscription_status: string;\n}\n\nexport interface RunInfoEntity {\n  artifact_uri: string;\n  end_time: number;\n  experiment_id: string;\n  lifecycle_stage: string;\n  run_uuid: string;\n  run_name: string;\n  start_time: number;\n  status: string;\n\n  getArtifactUri(): string;\n  getEndTime(): string;\n  getExperimentId(): string;\n  getLifecycleStage(): string;\n  getRunUuid(): string;\n  getStartTime(): string;\n  getStatus(): string;\n}\n\nexport interface MetricEntity {\n  key: string;\n  step: number;\n  timestamp: number;\n  value: string | number;\n\n  getKey(): string;\n  getStep(): string;\n  getTimestamp(): string;\n  getValue(): string | number;\n}\n\nexport type MetricEntitiesByName = Record<string, MetricEntity>;\n\nexport interface ExperimentEntity {\n  allowed_actions: string[];\n  artifact_location: string;\n  creation_time: number;\n  experiment_id: string;\n  last_update_time: number;\n  lifecycle_stage: string;\n  name: string;\n  tags: KeyValueEntity[];\n\n  getAllowedActions(): string[];\n  getArtifactLocation(): string;\n  getCreationTime(): number;\n  getExperimentId(): string;\n  getLastUpdateTime(): number;\n  getLifecycleStage(): string;\n  getName(): string;\n  getTags(): KeyValueEntity[];\n}\n\nexport interface ExperimentStoreEntities {\n  /**\n   * Dictionary with experiment ID as key and entity object as a value\n   */\n  experimentsById: Record<string, ExperimentEntity>;\n\n  /**\n   * Dictionary with run UUID as key and run info object as a value\n   */\n  runInfosByUuid: Record<string, RunInfoEntity>;\n\n  /**\n   * Dictionary with run UUID as key and metric sub-dictionary as a value.\n   * Represents all metrics.\n   */\n  metricsByRunUuid: Record<string, MetricEntitiesByName>;\n\n  /**\n   * Dictionary with run UUID as key and metric sub-dictionary as a value\n   * Represents latest metrics (e.g. fetched along run history).\n   */\n  latestMetricsByRunUuid: Record<string, MetricEntitiesByName>;\n\n  /**\n   * Dictionary with run UUID as key and metric sub-dictionary as a value\n   * Represents metrics with min value.\n   */\n  minMetricsByRunUuid: Record<string, MetricEntitiesByName>;\n\n  /**\n   * Dictionary with run UUID as key and metric sub-dictionary as a value\n   * Represents metrics with max value.\n   */\n  maxMetricsByRunUuid: Record<string, MetricEntitiesByName>;\n\n  /**\n   * Dictionary of parameters for runs. Run UUID is a first key,\n   * param name is the second one.\n   */\n  paramsByRunUuid: Record<string, Record<string, KeyValueEntity>>;\n\n  /**\n   * Dictionary of tags for runs. Run UUID serves is a first key,\n   * tag name is the second one.\n   */\n  tagsByRunUuid: Record<string, Record<string, KeyValueEntity>>;\n\n  /**\n   * Dictionary of tags for experiments. Experiment ID serves is a first key,\n   * tag name is the second one.\n   */\n  experimentTagsByExperimentId: Record<string, Record<string, KeyValueEntity>>;\n\n  /**\n   * Dictionary of models. Model name is the first key, model version is the second one.\n   * Model entity object is the value.\n   */\n  modelVersionsByModel: Record<string, Record<string, ModelInfoEntity>>;\n\n  /**\n   * Dictionary of models for runs. Run UUID is the key, used model entity object is the value.\n   */\n  modelVersionsByRunUuid: Record<string, ModelInfoEntity[]>;\n\n  /**\n   * List of all runs that match recently used filter. Runs that were fetched because they are\n   * pinned (not because they fit the filter) are excluded from this list.\n   */\n  runUuidsMatchingFilter: string[];\n}\n\nexport enum LIFECYCLE_FILTER {\n  ACTIVE = 'Active',\n  DELETED = 'Deleted',\n}\n\nexport enum MODEL_VERSION_FILTER {\n  WITH_MODEL_VERSIONS = 'With Model Versions',\n  WTIHOUT_MODEL_VERSIONS = 'Without Model Versions',\n  ALL_RUNS = 'All Runs',\n}\n\nexport type ExperimentCategorizedUncheckedKeys = {\n  attributes: string[];\n  metrics: string[];\n  params: string[];\n  tags: string[];\n};\n\n/**\n * Function used to update the filter set and fetch new set of runs.\n * First parameter is the subset of fields that the current sort/filter model will be merged with.\n * If the second parameter is set to true, it will force re-fetching even if there\n * are no sufficient changes to the model.\n */\nexport type UpdateExperimentSearchFacetsFn = (\n  newFilterModel:\n    | Partial<SearchExperimentRunsFacetsState>\n    | React.SetStateAction<SearchExperimentRunsFacetsState>,\n  updateOptions?: {\n    forceRefresh?: boolean;\n    preservePristine?: boolean;\n  },\n) => void;\n\n/**\n * Function used to update the local (non-persistable) view state.\n * First parameter is the subset of fields that the current view state model will be merged with.\n */\nexport type UpdateExperimentViewStateFn = (\n  newPartialViewState: Partial<SearchExperimentRunsViewState>,\n) => void;\n\n/**\n * A type describing a single chart configured in the compare runs view.\n * TODO: finalize it with the actual field and enums\n */\nexport interface CompareRunsChartSetup {\n  type: string; // TODO: change to an enum\n  metricKey: string; // TODO: expand it to multiple axes\n  uuid: string;\n}\n","import {\n  ExperimentEntity,\n  ExperimentStoreEntities,\n  KeyValueEntity,\n  LIFECYCLE_FILTER,\n  ModelInfoEntity,\n  MODEL_VERSION_FILTER,\n  RunInfoEntity,\n} from '../../../types';\nimport { getLatestMetrics } from '../../../reducers/MetricReducer';\nimport { getExperimentTags, getParams, getRunInfo, getRunTags } from '../../../reducers/Reducers';\n\nexport type ExperimentRunsSelectorResult = {\n  /**\n   * Array of run infos\n   */\n  runInfos: RunInfoEntity[];\n\n  /**\n   * List of unique metric keys\n   */\n  runUuidsMatchingFilter: string[];\n\n  /**\n   * List of unique metric keys\n   */\n  metricKeyList: string[];\n\n  /**\n   * List of unique param keys\n   */\n  paramKeyList: string[];\n\n  /**\n   * List of metrics indexed by the respective runs.\n   * Example: metricsList[2] contains list of all\n   * metrics corresponding to the 3rd run in the run list\n   */\n  metricsList: KeyValueEntity[][];\n\n  /**\n   * List of metrics indexed by the respective runs.\n   * Example: paramsList[2] contains list of all\n   * params corresponding to the 3rd run in the run list\n   */\n  paramsList: KeyValueEntity[][];\n\n  /**\n   * List of tags indexed by the respective runs.\n   * Example: tagsList[2] contains dictionary of all\n   * tags corresponding to the 3rd run in the run list\n   */\n  tagsList: Record<string, KeyValueEntity>[];\n\n  /**\n   * Dictionary containing model information objects indexed by run uuid\n   */\n  modelVersionsByRunUuid: Record<string, ModelInfoEntity[]>;\n\n  /**\n   * Dictionary containing all tags assigned to a experiment\n   * (single experiment only)\n   */\n  experimentTags: Record<string, KeyValueEntity>;\n};\n\nexport type ExperimentRunsSelectorParams = {\n  experiments: ExperimentEntity[];\n  lifecycleFilter?: LIFECYCLE_FILTER;\n  modelVersionFilter?: MODEL_VERSION_FILTER;\n};\n\n/**\n * Extracts run infos filtered by lifecycle filter and model version filter\n */\nconst extractRunInfos = (\n  runUuids: string[],\n  state: { entities: ExperimentStoreEntities },\n  {\n    lifecycleFilter = LIFECYCLE_FILTER.ACTIVE,\n    modelVersionFilter = MODEL_VERSION_FILTER.ALL_RUNS,\n  }: ExperimentRunsSelectorParams,\n): RunInfoEntity[] => {\n  const { modelVersionsByRunUuid } = state.entities;\n\n  return (\n    runUuids\n      // Get the basic run info\n      .map((run_id) => getRunInfo(run_id, state))\n      // Filter out runs by given lifecycle filter\n      .filter((rInfo) => {\n        if (lifecycleFilter === LIFECYCLE_FILTER.ACTIVE) {\n          return rInfo.lifecycle_stage === 'active';\n        } else {\n          return rInfo.lifecycle_stage === 'deleted';\n        }\n      })\n      // Filter out runs by given model version filter\n      .filter((rInfo) => {\n        if (modelVersionFilter === MODEL_VERSION_FILTER.ALL_RUNS) {\n          return true;\n        } else if (modelVersionFilter === MODEL_VERSION_FILTER.WITH_MODEL_VERSIONS) {\n          return rInfo.run_uuid in modelVersionsByRunUuid;\n        } else if (modelVersionFilter === MODEL_VERSION_FILTER.WTIHOUT_MODEL_VERSIONS) {\n          return !(rInfo.run_uuid in modelVersionsByRunUuid);\n        } else {\n          console.warn('Invalid input to model version filter - defaulting to showing all runs.');\n          return true;\n        }\n      })\n  );\n};\n\nexport const experimentRunsSelector = (\n  state: { entities: ExperimentStoreEntities },\n  params: ExperimentRunsSelectorParams,\n): ExperimentRunsSelectorResult => {\n  const { experiments } = params;\n  const experimentIds = experiments.map((e) => e.experiment_id);\n  const comparingExperiments = experimentIds.length > 1;\n\n  /**\n   * Extract run UUIDs relevant to selected experiments\n   */\n  const runUuids = Object.values(state.entities.runInfosByUuid)\n    .filter(({ experiment_id }) => experimentIds.includes(experiment_id))\n    .map(({ run_uuid }) => run_uuid);\n\n  /**\n   * Extract model version and runs matching filter directly from the store\n   */\n  const { modelVersionsByRunUuid, runUuidsMatchingFilter } = state.entities;\n\n  /**\n   * Extract run infos\n   */\n  const runInfos = extractRunInfos(runUuids, state, params);\n\n  /**\n   * Set of unique metric keys\n   */\n  const metricKeysSet = new Set<string>();\n\n  /**\n   * Set of unique param keys\n   */\n  const paramKeysSet = new Set<string>();\n\n  /**\n   * Extracting lists of metrics by run index\n   */\n  const metricsList = runInfos.map((runInfo) => {\n    const metricsByRunUuid = getLatestMetrics(runInfo.run_uuid, state);\n    const metrics = Object.values(metricsByRunUuid || {}) as any[];\n    metrics.forEach((metric) => {\n      metricKeysSet.add(metric.key);\n    });\n    return metrics;\n  }) as KeyValueEntity[][];\n\n  /**\n   * Extracting lists of params by run index\n   */\n  const paramsList = runInfos.map((runInfo) => {\n    const paramValues = Object.values(getParams(runInfo.run_uuid, state)) as any[];\n    paramValues.forEach((param) => {\n      paramKeysSet.add(param.key);\n    });\n    return paramValues;\n  }) as KeyValueEntity[][];\n\n  /**\n   * Extracting dictionaries of tags by run index\n   */\n  const tagsList = runInfos.map((runInfo) => getRunTags(runInfo.run_uuid, state)) as Record<\n    string,\n    KeyValueEntity\n  >[];\n\n  const firstExperimentId = experimentIds[0];\n\n  /**\n   * If there is only one experiment, extract experiment tags as well\n   */\n  const experimentTags = (\n    comparingExperiments ? {} : getExperimentTags(firstExperimentId, state)\n  ) as Record<string, KeyValueEntity>;\n\n  return {\n    modelVersionsByRunUuid,\n    experimentTags,\n    runInfos,\n    paramsList,\n    tagsList,\n    metricsList,\n    runUuidsMatchingFilter,\n    metricKeyList: Array.from(metricKeysSet.values()).sort(),\n    paramKeyList: Array.from(paramKeysSet.values()).sort(),\n  };\n};\n","import { SortAscendingIcon, SortDescendingIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React from 'react';\n\nexport interface ColumnHeaderCellProps {\n  enableSorting: boolean;\n  displayName: string;\n  canonicalSortKey: string;\n  orderByAsc: boolean;\n  orderByKey: string;\n  onSortBy: (sortKey: string, newOrder: boolean) => void;\n  getClassName: (sortKey: string) => string;\n}\n\nexport class ColumnHeaderCell extends React.Component<ColumnHeaderCellProps> {\n  handleSortBy() {\n    const { canonicalSortKey, orderByAsc, orderByKey } = this.props;\n    let newOrderByAsc = !orderByAsc;\n\n    // If the new sortKey is not equal to the previous sortKey, reset the orderByAsc\n    if (canonicalSortKey !== orderByKey) {\n      newOrderByAsc = false;\n    }\n\n    this.props.onSortBy(canonicalSortKey, newOrderByAsc);\n  }\n\n  render() {\n    const {\n      enableSorting,\n      canonicalSortKey,\n      displayName,\n      getClassName = () => '',\n      orderByKey,\n      orderByAsc,\n    } = this.props;\n\n    return (\n      // eslint-disable-next-line jsx-a11y/click-events-have-key-events, jsx-a11y/interactive-supports-focus\n      <div\n        role='columnheader'\n        css={styles.headerLabelWrapper(enableSorting)}\n        className={getClassName(canonicalSortKey)}\n        onClick={enableSorting ? () => this.handleSortBy() : undefined}\n      >\n        <span data-test-id={`sort-header-${displayName}`}>{displayName}</span>\n        {enableSorting && canonicalSortKey === orderByKey ? (\n          orderByAsc ? (\n            <SortAscendingIcon />\n          ) : (\n            <SortDescendingIcon />\n          )\n        ) : null}\n      </div>\n    );\n  }\n}\n\nconst styles = {\n  headerLabelWrapper: (sortable: boolean) => (theme: Theme) => ({\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: '0 12px',\n    svg: {\n      color: theme.colors.textSecondary,\n    },\n    '&:hover': {\n      color: sortable ? theme.colors.actionTertiaryTextHover : 'unset',\n      svg: {\n        color: theme.colors.actionTertiaryTextHover,\n      },\n    },\n  }),\n\n  headerSortIcon: {\n    marginRight: 4,\n  },\n};\n","import { CheckCircleBorderIcon, ClockIcon, XCircleBorderIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React from 'react';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowDateAndNestInfo } from '../../../utils/experimentPage.row-types';\n\nconst ErrorIcon = () => (\n  <XCircleBorderIcon css={(theme) => ({ color: theme.colors.textValidationDanger })} />\n);\n\nconst FinishedIcon = () => (\n  <CheckCircleBorderIcon css={(theme) => ({ color: theme.colors.textValidationSuccess })} />\n);\n\nconst getRunStatusIcon = (status: string) => {\n  switch (status) {\n    case 'FAILED':\n    case 'KILLED':\n      return <ErrorIcon />;\n    case 'FINISHED':\n      return <FinishedIcon />;\n    case 'SCHEDULED':\n      return <ClockIcon />; // This one is the same color as the link\n    default:\n      return null;\n  }\n};\n\nexport interface DateCellRendererProps {\n  value: RunRowDateAndNestInfo;\n}\n\nexport const DateCellRenderer = React.memo(\n  ({ value: { startTime, referenceTime, runStatus } }: DateCellRendererProps) => {\n    return (\n      <span css={styles.cellWrapper} title={Utils.formatTimestamp(startTime)}>\n        {getRunStatusIcon(runStatus)}\n        {Utils.timeSinceStr(startTime, referenceTime)}\n      </span>\n    );\n  },\n);\n\nconst styles = {\n  cellWrapper: (theme: Theme) => ({\n    display: 'flex',\n    alignItems: 'center',\n    gap: theme.spacing.sm,\n    svg: {\n      width: 14,\n      height: 14,\n    },\n  }),\n};\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport Routes from '../../../../../routes';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\n\nexport interface ExperimentNameCellRendererProps {\n  value: {\n    name: string;\n    basename: string;\n  };\n  data: RunRowType;\n}\n\nexport const ExperimentNameCellRenderer = React.memo(\n  ({ data, value }: ExperimentNameCellRendererProps) => (\n    <Link to={Routes.getExperimentPageRoute(data.experimentId)} title={value.name}>\n      {value.basename}\n    </Link>\n  ),\n);\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button } from '@databricks/design-system';\n\nexport const TrimmedText = ({ text, maxSize, className, allowShowMore = false }) => {\n  if (text.length <= maxSize) {\n    return <span className={className}>{text}</span>;\n  }\n  const trimmedText = `${text.substr(0, maxSize)}...`;\n  // Reported during ESLint upgrade\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const [showMore, setShowMore] = useState(false);\n  return (\n    <span className={className}>\n      {showMore ? text : trimmedText}\n      {allowShowMore && (\n        <Button\n          type='link'\n          onClick={() => setShowMore(!showMore)}\n          size='small'\n          css={styles.expandButton}\n          data-test-id='trimmed-text-button'\n        >\n          {showMore ? 'collapse' : 'expand'}\n        </Button>\n      )}\n    </span>\n  );\n};\n\nconst styles = {\n  expandButton: {\n    display: 'inline-block',\n  },\n};\n\nTrimmedText.propTypes = {\n  text: PropTypes.string.isRequired,\n  maxSize: PropTypes.number.isRequired,\n  className: PropTypes.string.isRequired,\n  allowShowMore: PropTypes.bool,\n};\n","var _path;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgLoggedModel(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 12,\n    height: 14,\n    viewBox: \"0 0 12 14\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M7.7265 0.726585C7.47317 0.473252 7.13317 0.333252 6.77984 0.333252H1.99984C1.2665 0.333252 0.666504 0.933252 0.666504 1.66659V12.3333C0.666504 13.0666 1.25984 13.6666 1.99317 13.6666H9.99984C10.7332 13.6666 11.3332 13.0666 11.3332 12.3333V4.88658C11.3332 4.53325 11.1932 4.19325 10.9398 3.94659L7.7265 0.726585ZM6.66648 4.33333V1.33333L10.3331 5H7.33315C6.96648 5 6.66648 4.7 6.66648 4.33333ZM5.99982 6.33333C5.99982 6.64213 5.92984 6.93457 5.80487 7.19568L7.13747 8.52828C7.39858 8.40331 7.69103 8.33333 7.99982 8.33333C9.10439 8.33333 9.99982 9.22876 9.99982 10.3333C9.99982 11.4379 9.10439 12.3333 7.99982 12.3333C6.89525 12.3333 5.99982 11.4379 5.99982 10.3333C5.99982 10.0246 6.06977 9.7322 6.1947 9.47113L4.86202 8.13845C4.60095 8.26338 4.30855 8.33333 3.99982 8.33333C2.89525 8.33333 1.99982 7.4379 1.99982 6.33333C1.99982 5.22876 2.89525 4.33333 3.99982 4.33333C5.10439 4.33333 5.99982 5.22876 5.99982 6.33333ZM3.99982 7.00008C4.36801 7.00008 4.66648 6.7016 4.66648 6.33342C4.66648 5.96523 4.36801 5.66675 3.99982 5.66675C3.63163 5.66675 3.33315 5.96523 3.33315 6.33342C3.33315 6.7016 3.63163 7.00008 3.99982 7.00008ZM8.66648 10.3334C8.66648 10.7016 8.36801 11.0001 7.99982 11.0001C7.63163 11.0001 7.33315 10.7016 7.33315 10.3334C7.33315 9.96522 7.63163 9.66675 7.99982 9.66675C8.36801 9.66675 8.66648 9.96522 8.66648 10.3334Z\",\n    fill: \"#6B6B6B\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgLoggedModel);\nexport default __webpack_public_path__ + \"static/media/logged-model.dd9b21ff4fb07f3cadeada8046a2693b.svg\";\nexport { ForwardRef as ReactComponent };","var _circle, _circle2, _circle3, _circle4, _line, _line2, _line3, _line4, _line5;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgRegisteredModel(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 14,\n    height: 14,\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _circle || (_circle = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 9,\n    cy: 20,\n    r: 2,\n    stroke: \"#2374bb\",\n    strokeWidth: 2\n  })), _circle2 || (_circle2 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 4,\n    cy: 7,\n    r: 2,\n    stroke: \"#2374bb\",\n    strokeWidth: 2\n  })), _circle3 || (_circle3 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 20,\n    cy: 4,\n    r: 2,\n    stroke: \"#2374bb\",\n    strokeWidth: 2\n  })), _circle4 || (_circle4 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 19,\n    cy: 15,\n    r: 2,\n    stroke: \"#2374bb\",\n    strokeWidth: 2\n  })), _line || (_line = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 8.05132,\n    y1: 18.3162,\n    x2: 5.05132,\n    y2: 9.31623,\n    stroke: \"#2374bb\",\n    strokeWidth: 2\n  })), _line2 || (_line2 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 5.77514,\n    y1: 7.02561,\n    x2: 18.7751,\n    y2: 4.02561,\n    stroke: \"#2374bb\",\n    strokeWidth: 2\n  })), _line3 || (_line3 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 19.0101,\n    y1: 12.8586,\n    x2: 20.01,\n    y2: 5.85858,\n    stroke: \"#2374bb\",\n    strokeWidth: 2\n  })), _line4 || (_line4 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 11.5528,\n    y1: 19.1056,\n    x2: 17.5528,\n    y2: 16.1056,\n    stroke: \"#2374bb\",\n    strokeWidth: 2\n  })), _line5 || (_line5 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 17.5528,\n    y1: 13.8944,\n    x2: 5.55279,\n    y2: 7.89443,\n    stroke: \"#2374bb\",\n    strokeWidth: 2\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgRegisteredModel);\nexport default __webpack_public_path__ + \"static/media/registered-model.24429a4f6158e57b01b3928e2605aa25.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\nimport { TrimmedText } from '../../../../../../common/components/TrimmedText';\nimport loggedModelSvg from '../../../../../../common/static/logged-model.svg';\nimport registeredModelSvg from '../../../../../../common/static/registered-model.svg';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { getModelVersionPageRoute } from '../../../../../../model-registry/routes';\nimport Routes from '../../../../../routes';\nimport { RunRowModelsInfo } from '../../../utils/experimentPage.row-types';\n\nconst EMPTY_CELL_PLACEHOLDER = '-';\n\nexport interface ModelsCellRendererProps {\n  value: RunRowModelsInfo;\n}\n\nexport const ModelsCellRenderer = React.memo((props: ModelsCellRendererProps) => {\n  const { registeredModels, loggedModels, experimentId, runUuid } = props.value;\n  const models = Utils.mergeLoggedAndRegisteredModels(loggedModels, registeredModels);\n\n  if (models && models.length) {\n    const modelToRender = models[0];\n    let modelDiv;\n    if (modelToRender.registeredModelName) {\n      const { registeredModelName, registeredModelVersion } = modelToRender;\n      modelDiv = (\n        <>\n          <img\n            data-test-id='registered-model-icon'\n            alt=''\n            title='Registered Model'\n            src={registeredModelSvg}\n          />\n          <a\n            href={Utils.getIframeCorrectedRoute(\n              getModelVersionPageRoute(registeredModelName, registeredModelVersion),\n            )}\n            className='registered-model-link'\n            target='_blank'\n            rel='noreferrer'\n          >\n            <TrimmedText text={registeredModelName} maxSize={10} className={'model-name'} />\n            {`/${registeredModelVersion}`}\n          </a>\n        </>\n      );\n    } else if (modelToRender.flavors) {\n      const loggedModelFlavorText = modelToRender.flavors ? modelToRender.flavors[0] : 'Model';\n      const loggedModelLink = Utils.getIframeCorrectedRoute(\n        `${Routes.getRunPageRoute(experimentId, runUuid)}/artifactPath/${\n          modelToRender.artifactPath\n        }`,\n      );\n      modelDiv = (\n        <>\n          <img data-test-id='logged-model-icon' alt='' title='Logged Model' src={loggedModelSvg} />\n          {/* Reported during ESLint upgrade */}\n          {/* eslint-disable-next-line react/jsx-no-target-blank */}\n          <a href={loggedModelLink} target='_blank' className='logged-model-link'>\n            {loggedModelFlavorText}\n          </a>\n        </>\n      );\n    }\n\n    return (\n      <div className='logged-model-cell' css={styles.imageWrapper}>\n        {modelDiv}\n        {loggedModels.length > 1 ? `, ${loggedModels.length - 1} more` : ''}\n      </div>\n    );\n  }\n  return <>{EMPTY_CELL_PLACEHOLDER}</>;\n});\n\nconst styles = {\n  imageWrapper: {\n    img: {\n      height: '15px',\n      position: 'relative' as const,\n      marginRight: '4px',\n    },\n  },\n};\n","import React from 'react';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\n\nexport const SourceCellRenderer = React.memo(({ value }: { value: RunRowType['tags'] }) => {\n  const sourceType = Utils.renderSource(value, undefined, undefined);\n  return sourceType ? (\n    <>\n      {Utils.renderSourceTypeIcon(value)}\n      {sourceType}\n    </>\n  ) : (\n    <>-</>\n  );\n});\n","import React from 'react';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowVersionInfo } from '../../../utils/experimentPage.row-types';\n\nexport const VersionCellRenderer = React.memo(\n  ({\n    value: {\n      // Run row version object parameters\n      version,\n      name,\n      type,\n    },\n  }: {\n    value: RunRowVersionInfo;\n  }) =>\n    Utils.renderSourceVersion(\n      // Using function from utils to render the source link\n      version,\n      name,\n      type,\n    ) || <>-</>,\n);\n","import Utils from '../../common/utils/Utils';\nimport { KeyValueEntity, RunInfoEntity } from '../types';\n\nconst { formatTimestamp, getDuration, getRunNameFromTags, getSourceType, getSourceName, getUser } =\n  Utils;\n\n/**\n * Turn a list of params/metrics to a map of metric key to metric.\n */\nconst toMap = (params: KeyValueEntity[]) =>\n  params.reduce(\n    (result, entity) => ({ ...result, [entity.key]: entity }),\n    {} as Record<string, KeyValueEntity>,\n  );\n\n/**\n * Format a string for insertion into a CSV file.\n */\nconst csvEscape = (str: string) => {\n  if (str === undefined) {\n    return '';\n  }\n  if (/[,\"\\r\\n]/.test(str)) {\n    return '\"' + str.replace(/\"/g, '\"\"') + '\"';\n  }\n  return str;\n};\n\n/**\n * Convert a table to a CSV string.\n *\n * @param columns Names of columns\n * @param data Array of rows, each of which are an array of field values\n */\nconst tableToCsv = (columns: any /* TODO */, data: any /* TODO */) => {\n  let csv = '';\n  let i;\n\n  for (i = 0; i < columns.length; i++) {\n    csv += csvEscape(columns[i]);\n    if (i < columns.length - 1) {\n      csv += ',';\n    }\n  }\n  csv += '\\n';\n\n  for (i = 0; i < data.length; i++) {\n    for (let j = 0; j < data[i].length; j++) {\n      csv += csvEscape(data[i][j]);\n      if (j < data[i].length - 1) {\n        csv += ',';\n      }\n    }\n    csv += '\\n';\n  }\n\n  return csv;\n};\n\n/**\n * Convert an array of run infos to a CSV string, extracting the params and metrics in the\n * provided lists.\n */\nexport const runInfosToCsv = (params: {\n  runInfos: RunInfoEntity[];\n  paramKeyList: string[];\n  metricKeyList: string[];\n  tagKeyList: string[];\n  paramsList: KeyValueEntity[][];\n  metricsList: KeyValueEntity[][];\n  tagsList: Record<string, KeyValueEntity>[];\n}) => {\n  const { runInfos, paramKeyList, metricKeyList, tagKeyList, paramsList, metricsList, tagsList } =\n    params;\n\n  const columns = [\n    'Start Time',\n    'Duration',\n    'Run ID',\n    'Name',\n    'Source Type',\n    'Source Name',\n    'User',\n    'Status',\n    ...paramKeyList,\n    ...metricKeyList,\n    ...tagKeyList,\n  ];\n\n  const data = runInfos.map((runInfo, index) => {\n    const row = [\n      formatTimestamp(runInfo.start_time),\n      getDuration(runInfo.start_time, runInfo.end_time) || '',\n      runInfo.run_uuid,\n      runInfo.run_name || getRunNameFromTags(tagsList[index]), // add run name to csv export row\n      getSourceType(tagsList[index]),\n      getSourceName(tagsList[index]),\n      getUser(runInfo, tagsList[index]),\n      runInfo.status,\n    ];\n    const paramsMap = toMap(paramsList[index]);\n    const metricsMap = toMap(metricsList[index]);\n    const tagsMap = tagsList[index];\n\n    paramKeyList.forEach((paramKey) => {\n      if (paramsMap[paramKey]) {\n        row.push(paramsMap[paramKey].value);\n      } else {\n        row.push('');\n      }\n    });\n    metricKeyList.forEach((metricKey) => {\n      if (metricsMap[metricKey]) {\n        row.push(metricsMap[metricKey].value);\n      } else {\n        row.push('');\n      }\n    });\n    tagKeyList.forEach((tagKey) => {\n      if (tagsMap[tagKey]) {\n        row.push(tagsMap[tagKey].value);\n      } else {\n        row.push('');\n      }\n    });\n    return row;\n  });\n\n  return tableToCsv(columns, data);\n};\n","import { IntlShape } from 'react-intl';\nimport { saveAs } from 'file-saver';\nimport { ExperimentEntity } from '../../../types';\nimport { ExperimentRunsSelectorResult } from './experimentRuns.selector';\nimport { runInfosToCsv } from '../../../utils/CsvUtils';\n\nexport const EXPERIMENT_FIELD_PREFIX_PARAM = '$$$param$$$';\nexport const EXPERIMENT_FIELD_PREFIX_METRIC = '$$$metric$$$';\nexport const EXPERIMENT_FIELD_PREFIX_TAG = '$$$tag$$$';\nexport const EXPERIMENT_PARENT_ID_TAG = 'mlflow.parentRunId';\nexport const EXPERIMENT_LOG_MODEL_HISTORY_TAG = 'mlflow.log-model.history';\n\nconst MLFLOW_NOTEBOOK_TYPE = 'NOTEBOOK';\nconst MLFLOW_EXPERIMENT_TYPE = 'MLFLOW_EXPERIMENT';\n\nconst EXPERIMENT_TYPE_TAG = 'mlflow.experimentType';\n\n/**\n * Function that gets the experiment type for a given experiment object\n */\nexport const getExperimentType = (experiment: ExperimentEntity) => {\n  const experimentType = experiment.tags.find((tag) => tag.key === EXPERIMENT_TYPE_TAG);\n  if (experimentType) {\n    return experimentType.value;\n  }\n  return null;\n};\n\nconst hasExperimentType = (experiment: ExperimentEntity, type: string) =>\n  getExperimentType(experiment) === type;\n\n/**\n * Function returns true if the experiment is of default (\"MLFLOW_EXPERIMENT\") type\n */\nexport const isExperimentTypeDefault = (experiment: ExperimentEntity) =>\n  hasExperimentType(experiment, MLFLOW_EXPERIMENT_TYPE);\n\n/**\n * Function returns true if the experiment is of notebook type\n */\nexport const isExperimentTypeNotebook = (experiment: ExperimentEntity) =>\n  hasExperimentType(experiment, MLFLOW_NOTEBOOK_TYPE);\n\n/**\n * Function that checks if experiment's allowed actions include\n * modification. TODO: fix typo in the const name.\n */\nexport const canModifyExperiment = (experiment: ExperimentEntity) =>\n  experiment.allowed_actions.includes('MODIFIY_PERMISSION');\n\n/**\n * Function used for downloading run data in CSV form.\n */\nexport const downloadRunsCsv = (\n  runsData: ExperimentRunsSelectorResult,\n  filteredTagKeys: string[],\n  filteredParamKeys: string[],\n  filteredMetricKeys: string[],\n) => {\n  const { runInfos, paramsList, metricsList, tagsList } = runsData;\n\n  const csv = runInfosToCsv({\n    runInfos,\n    paramKeyList: filteredParamKeys,\n    metricKeyList: filteredMetricKeys,\n    tagKeyList: filteredTagKeys,\n    paramsList,\n    metricsList,\n    tagsList,\n  });\n  const blob = new Blob([csv], { type: 'application/csv;charset=utf-8' });\n  saveAs(blob, 'runs.csv');\n};\n\n/**\n * Function used for preparing values for \"created\" (start time) runs filter.\n */\nexport const getStartTimeColumnDisplayName = (intl: IntlShape) => ({\n  ALL: intl.formatMessage({\n    defaultMessage: 'All time',\n    description: 'Option for the start select dropdown to render all runs',\n  }),\n  LAST_HOUR: intl.formatMessage({\n    defaultMessage: 'Last hour',\n    description: 'Option for the start select dropdown to filter runs from the last hour',\n  }),\n  LAST_24_HOURS: intl.formatMessage({\n    defaultMessage: 'Last 24 hours',\n    description: 'Option for the start select dropdown to filter runs from the last 24 hours',\n  }),\n  LAST_7_DAYS: intl.formatMessage({\n    defaultMessage: 'Last 7 days',\n    description: 'Option for the start select dropdown to filter runs from the last 7 days',\n  }),\n  LAST_30_DAYS: intl.formatMessage({\n    defaultMessage: 'Last 30 days',\n    description: 'Option for the start select dropdown to filter runs from the last 30 days',\n  }),\n  LAST_YEAR: intl.formatMessage({\n    defaultMessage: 'Last year',\n    description: 'Option for the start select dropdown to filter runs since the last 1 year',\n  }),\n});\n","import { PinBorderIcon, PinFillIcon, Tooltip } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\n\nexport const PinRowCellRenderer = React.memo(\n  (props: { data: RunRowType; value: boolean; onTogglePin: any }) => {\n    if (!props.data.pinnable) {\n      return null;\n    }\n    return (\n      <Tooltip\n        placement='right'\n        title={\n          props.value ? (\n            <FormattedMessage\n              defaultMessage='Unpin run'\n              description='A tooltip for the pin icon button in the runs table next to the pinned run'\n            />\n          ) : (\n            <FormattedMessage\n              defaultMessage='Click to pin the run'\n              description='A tooltip for the pin icon button in the runs table next to the not pinned run'\n            />\n          )\n        }\n      >\n        <label css={styles.pinWrapper}>\n          <input\n            type='checkbox'\n            checked={props.value}\n            onChange={() => {\n              props.onTogglePin(props.data.runUuid);\n            }}\n          />\n          {props.value ? <PinFillIcon /> : <PinBorderIcon />}\n        </label>\n      </Tooltip>\n    );\n  },\n);\n\nconst styles = {\n  pinWrapper: (theme: Theme) => ({\n    input: { width: 0, appearance: 'none' as const },\n    cursor: 'pointer',\n    display: 'flex',\n    svg: {\n      width: 14,\n      height: 14,\n      cursor: 'pointer',\n      color: 'transparent',\n    },\n    // Two selectors below need to be separate - emotion doesn't\n    // allow nested \"&\" in selectors joined by a comma\n    '.ag-row-hover & svg': {\n      color: theme.colors.grey600,\n    },\n    'input:checked + span svg': {\n      color: theme.colors.grey600,\n    },\n  }),\n};\n","import { ICellRendererParams } from '@ag-grid-community/core';\nimport { Button, MinusBoxIcon, PlusSquareIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport Routes from '../../../../../routes';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\n\nexport interface RunNameCellRendererProps extends ICellRendererParams {\n  data: RunRowType;\n  onExpand: (runUuid: string, childrenIds?: string[]) => void;\n}\n\nexport const RunNameCellRenderer = React.memo(\n  ({\n    onExpand,\n    data: { runName, experimentId, runUuid, runDateAndNestInfo },\n  }: RunNameCellRendererProps) => {\n    const { hasExpander, expanderOpen, childrenIds, level } = runDateAndNestInfo || {};\n\n    const renderingAsParent = !isNaN(level) && hasExpander;\n\n    return (\n      <div css={styles.cellWrapper}>\n        <div css={styles.expanderWrapper}>\n          <div css={styles.nestLevel(level)}>\n            {renderingAsParent && (\n              <Button\n                css={styles.expanderButton}\n                size='small'\n                onClick={() => {\n                  onExpand(runUuid, childrenIds);\n                }}\n                key={'Expander-' + runUuid}\n                type='link'\n                icon={expanderOpen ? <MinusBoxIcon /> : <PlusSquareIcon />}\n              />\n            )}\n          </div>\n        </div>\n        <Link to={Routes.getRunPageRoute(experimentId, runUuid)}>{runName}</Link>\n      </div>\n    );\n  },\n);\n\nconst styles = {\n  link: (theme: Theme) => ({\n    display: 'inline-block',\n    minWidth: theme.typography.fontSizeBase,\n    minHeight: theme.typography.fontSizeBase,\n  }),\n  cellWrapper: {\n    display: 'flex',\n  },\n  expanderButton: {\n    svg: {\n      width: 12,\n      height: 12,\n    },\n  },\n  expanderWrapper: {\n    display: 'none',\n    '.ag-grid-expanders-visible &': {\n      display: 'block',\n    },\n  },\n\n  nestLevel: (level: number) => (theme: Theme) => ({\n    display: 'flex',\n    justifyContent: 'flex-end',\n    width: (level + 1) * theme.spacing.lg,\n    height: theme.general.heightSm,\n  }),\n};\n","import { ColDef, ColumnApi } from '@ag-grid-community/core';\nimport { Spinner } from '@databricks/design-system';\nimport { useEffect, useMemo, useRef } from 'react';\nimport { isEqual } from 'lodash';\nimport Utils from '../../../../common/utils/Utils';\nimport {\n  ATTRIBUTE_COLUMN_LABELS,\n  ATTRIBUTE_COLUMN_SORT_KEY,\n  COLUMN_TYPES,\n} from '../../../constants';\nimport { ColumnHeaderCell } from '../components/runs/cells/ColumnHeaderCell';\nimport { DateCellRenderer } from '../components/runs/cells/DateCellRenderer';\nimport { ExperimentNameCellRenderer } from '../components/runs/cells/ExperimentNameCellRenderer';\nimport { ModelsCellRenderer } from '../components/runs/cells/ModelsCellRenderer';\nimport { SourceCellRenderer } from '../components/runs/cells/SourceCellRenderer';\nimport { VersionCellRenderer } from '../components/runs/cells/VersionCellRenderer';\nimport type { SearchExperimentRunsFacetsState } from '../models/SearchExperimentRunsFacetsState';\nimport {\n  EXPERIMENT_FIELD_PREFIX_METRIC,\n  EXPERIMENT_FIELD_PREFIX_PARAM,\n  EXPERIMENT_FIELD_PREFIX_TAG,\n} from './experimentPage.common-utils';\nimport { RunRowType } from './experimentPage.row-types';\nimport { PinRowCellRenderer } from '../components/runs/cells/PinRowCellRenderer';\nimport { RunNameCellRenderer } from '../components/runs/cells/RunNameCellRenderer';\n\n/**\n * Creates canonical sort key name for metrics and params in form\n * of \"keyType.`keyName`\", e.g. \"params.`paramName`\"\n */\nexport const makeCanonicalSortKey = (keyType: string, keyName: string) =>\n  keyType + '.`' + keyName + '`';\n\n/**\n * Creates canonical sort key name for metrics and params\n */\nexport const isCanonicalSortKeyOfType = (canonicalKey: string, keyType: string) =>\n  canonicalKey.startsWith(keyType);\n\n/**\n * Extracts param/metric/tag name from the canonical key\n */\nexport const extractCanonicalSortKey = (canonicalKey: string, keyType: string) =>\n  canonicalKey.substring(keyType.length + 2).slice(0, -1);\n\n/*\n * Functions used to generate grid field names for params, metrics and prefixes\n */\nconst createParamFieldName = (key: string) => `${EXPERIMENT_FIELD_PREFIX_PARAM}-${key}`;\nconst createMetricFieldName = (key: string) => `${EXPERIMENT_FIELD_PREFIX_METRIC}-${key}`;\nconst createTagFieldName = (key: string) => `${EXPERIMENT_FIELD_PREFIX_TAG}-${key}`;\n\n/**\n * Functions returns all framework components to be used by agGrid\n */\nexport const getFrameworkComponents = () => ({\n  agColumnHeader: ColumnHeaderCell,\n  loadingOverlayComponent: Spinner,\n\n  /**\n   * We're saving cell renderer component references, otherwise\n   * agGrid will unnecessarily flash cells' content (e.g. when changing sort order)\n   */\n  SourceCellRenderer,\n  ModelsCellRenderer,\n  VersionCellRenderer,\n  DateCellRenderer,\n  ExperimentNameCellRenderer,\n  PinRowCellRenderer,\n  RunNameCellRenderer,\n});\n\n/**\n * Certain columns are described as run attributes (opposed to metrics, params etc.), however\n * they actually source their data from the run tags. This objects maps tag names to column identifiers.\n */\nexport const TAGS_TO_COLUMNS_MAP = {\n  [ATTRIBUTE_COLUMN_SORT_KEY.USER]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'User'),\n  [ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'Run Name'),\n  [ATTRIBUTE_COLUMN_SORT_KEY.SOURCE]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'Source'),\n  [ATTRIBUTE_COLUMN_SORT_KEY.VERSION]: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, 'Version'),\n};\n\n/**\n * Function returns unique row ID to be used in runs table\n */\nexport const getRowId = ({ data }: { data: RunRowType }) => data.runUuid;\n\n/**\n * Parameters used by `useRunsColumnDefinitions()` hook\n */\nexport interface UseRunsColumnDefinitionsParams {\n  searchFacetsState: SearchExperimentRunsFacetsState;\n  onSortBy: (newOrderByKey: string, newOrderByAsc: boolean) => void;\n  onExpand: (parentUuid: string, childrenIds: string[]) => void;\n  onTogglePin: (runUuid: string) => void;\n  compareExperiments: boolean;\n  metricKeyList: string[];\n  paramKeyList: string[];\n  tagKeyList: string[];\n  columnApi?: ColumnApi;\n  isComparingRuns?: boolean;\n}\n\n/**\n * List of all attribute columns that can be shown/hidden by user\n * - when displaying a single experiment (ADJUSTABLE_ATTRIBUTE_COLUMNS_SINGLE_EXPERIMENT)\n * - when comparing experiments (ADJUSTABLE_ATTRIBUTE_COLUMNS)\n */\nexport const ADJUSTABLE_ATTRIBUTE_COLUMNS_SINGLE_EXPERIMENT = [\n  ATTRIBUTE_COLUMN_LABELS.USER,\n  ATTRIBUTE_COLUMN_LABELS.SOURCE,\n  ATTRIBUTE_COLUMN_LABELS.VERSION,\n  ATTRIBUTE_COLUMN_LABELS.MODELS,\n];\nexport const ADJUSTABLE_ATTRIBUTE_COLUMNS = [\n  ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME,\n  ...ADJUSTABLE_ATTRIBUTE_COLUMNS_SINGLE_EXPERIMENT,\n];\n\n/**\n * This internal hook passes through the list of all metric/param/tag keys.\n * The lists are memoized internally so if somehow a particular param/metric/tag key is not present\n * in the new runs set (e.g. due to reverse sorting), the relevant column will be still displayed.\n * This prevents weirdly disappearing columns on exotic run sets.\n */\nconst useCumulativeColumnKeys = ({\n  paramKeyList,\n  metricKeyList,\n  tagKeyList,\n}: Pick<UseRunsColumnDefinitionsParams, 'tagKeyList' | 'metricKeyList' | 'paramKeyList'>) => {\n  const cachedMetricKeys = useRef<Set<string>>(new Set());\n  const cachedParamKeys = useRef<Set<string>>(new Set());\n  const cachedTagKeys = useRef<Set<string>>(new Set());\n\n  const paramKeys = useMemo(() => {\n    paramKeyList.forEach((key) => cachedParamKeys.current.add(key));\n    return Array.from(cachedParamKeys.current);\n  }, [paramKeyList]);\n\n  const metricKeys = useMemo(() => {\n    metricKeyList.forEach((key) => cachedMetricKeys.current.add(key));\n    return Array.from(cachedMetricKeys.current);\n  }, [metricKeyList]);\n\n  const tagKeys = useMemo(() => {\n    tagKeyList.forEach((key) => cachedTagKeys.current.add(key));\n    return Array.from(cachedTagKeys.current);\n  }, [tagKeyList]);\n\n  const cumulativeColumns = useMemo(\n    () => ({\n      paramKeys,\n      metricKeys,\n      tagKeys,\n    }),\n    [metricKeys, paramKeys, tagKeys],\n  );\n\n  return cumulativeColumns;\n};\n\n/**\n * This hook creates a agGrid-compatible column set definition basing on currently\n * used sort-filter model and provided list of metrics, params and tags.\n *\n * Internally, it reacts to changes to `selectedColumns` and hides/shows relevant columns\n * if necessary.\n *\n * @param params see UseRunsColumnDefinitionsParams\n */\nexport const useRunsColumnDefinitions = ({\n  searchFacetsState,\n  onSortBy,\n  compareExperiments,\n  onTogglePin,\n  onExpand,\n  paramKeyList,\n  metricKeyList,\n  tagKeyList,\n  columnApi,\n  isComparingRuns,\n}: UseRunsColumnDefinitionsParams) => {\n  const { orderByAsc, orderByKey, selectedColumns } = searchFacetsState;\n\n  const cumulativeColumns = useCumulativeColumnKeys({\n    metricKeyList,\n    tagKeyList,\n    paramKeyList,\n  });\n\n  const columnSet = useMemo(() => {\n    const commonSortOrderProps = { orderByKey, orderByAsc, onSortBy };\n\n    const getOrderedByClassName = (key: string) =>\n      key === orderByKey ? 'is-ordered-by' : undefined;\n\n    const getHeaderClassName = (key: string) => getOrderedByClassName(key);\n    const getCellClassName = ({ colDef }: { colDef: ColDef }) =>\n      getOrderedByClassName(colDef.headerComponentParams.canonicalSortKey);\n\n    const columns: ColDefWithChildren[] = [];\n\n    // Checkbox selection column\n    columns.push({\n      field: 'pinned',\n      checkboxSelection: true,\n      headerName: '',\n      headerCheckboxSelection: true,\n      cellClass: 'is-checkbox-cell',\n      cellRenderer: 'PinRowCellRenderer',\n      cellRendererParams: { onTogglePin },\n      pinned: 'left',\n      minWidth: 70,\n      width: 70,\n      maxWidth: 70,\n      resizable: false,\n    });\n\n    // Run name column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.RUN_NAME,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME],\n      headerTooltip: ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME,\n      pinned: 'left',\n      sortable: true,\n      field: 'runDateAndNestInfo',\n      cellRenderer: 'RunNameCellRenderer',\n      cellRendererParams: { onExpand },\n      equals: (dateInfo1, dateInfo2) => isEqual(dateInfo1, dateInfo2),\n      headerComponentParams: {\n        ...commonSortOrderProps,\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.RUN_NAME,\n        getClassName: getHeaderClassName,\n      },\n      cellClass: getCellClassName,\n      initialWidth: 260,\n      resizable: !isComparingRuns,\n    });\n\n    // If we are only comparing runs, that's it - we cut off the list after the run name column.\n    // This behavior might be revisited and changed later.\n    if (isComparingRuns) {\n      return columns;\n    }\n\n    // Date and expander selection column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.DATE,\n      headerTooltip: ATTRIBUTE_COLUMN_SORT_KEY.DATE,\n      pinned: 'left',\n      sortable: true,\n      field: 'runDateAndNestInfo',\n      cellRenderer: 'DateCellRenderer',\n      cellRendererParams: { onExpand },\n      equals: (dateInfo1, dateInfo2) => isEqual(dateInfo1, dateInfo2),\n      headerComponentParams: {\n        ...commonSortOrderProps,\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.DATE,\n        getClassName: getHeaderClassName,\n      },\n      cellClass: getCellClassName,\n      initialWidth: 150,\n    });\n\n    // Duration column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.DURATION,\n      field: 'duration',\n      initialWidth: 80,\n      cellClass: getCellClassName,\n    });\n\n    // Experiment name column\n    if (compareExperiments) {\n      columns.push({\n        headerName: ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME,\n        colId: makeCanonicalSortKey(\n          COLUMN_TYPES.ATTRIBUTES,\n          ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME,\n        ),\n        field: 'experimentName',\n        cellRenderer: 'ExperimentNameCellRenderer',\n        equals: (experimentName1, experimentName2) => isEqual(experimentName1, experimentName2),\n        initialWidth: 140,\n        cellClass: getCellClassName,\n        initialHide: true,\n      });\n    }\n\n    // User column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.USER,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.USER],\n      headerTooltip: ATTRIBUTE_COLUMN_SORT_KEY.USER,\n      field: 'user',\n      sortable: true,\n      headerComponentParams: {\n        ...commonSortOrderProps,\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.USER,\n        getClassName: getHeaderClassName,\n      },\n      cellClass: getCellClassName,\n      initialHide: true,\n    });\n\n    // Source column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.SOURCE,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.SOURCE],\n      field: 'tags',\n      cellRenderer: 'SourceCellRenderer',\n      equals: (tags1, tags2) => Utils.getSourceName(tags1) === Utils.getSourceName(tags2),\n      sortable: true,\n      headerComponentParams: {\n        ...commonSortOrderProps,\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.SOURCE,\n        getClassName: getHeaderClassName,\n      },\n      cellClass: getCellClassName,\n      initialHide: true,\n    });\n\n    // Version column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.VERSION,\n      colId: TAGS_TO_COLUMNS_MAP[ATTRIBUTE_COLUMN_SORT_KEY.VERSION],\n      field: 'version',\n      cellRenderer: 'VersionCellRenderer',\n      equals: (version1, version2) => isEqual(version1, version2),\n      sortable: true,\n      headerComponentParams: {\n        ...commonSortOrderProps,\n        canonicalSortKey: ATTRIBUTE_COLUMN_SORT_KEY.VERSION,\n        getClassName: getHeaderClassName,\n      },\n      cellClass: getCellClassName,\n      initialHide: true,\n    });\n\n    // Models column\n    columns.push({\n      headerName: ATTRIBUTE_COLUMN_LABELS.MODELS,\n      colId: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.MODELS),\n      field: 'models',\n      cellRenderer: 'ModelsCellRenderer',\n      initialWidth: 200,\n      equals: (models1, models2) => isEqual(models1, models2),\n      initialHide: true,\n    });\n\n    const { metricKeys, paramKeys, tagKeys } = cumulativeColumns;\n\n    // Metrics columns\n    if (metricKeys.length) {\n      columns.push({\n        headerName: 'Metrics',\n        colId: COLUMN_TYPES.METRICS,\n        children: metricKeys.map((metricKey) => {\n          const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.METRICS, metricKey);\n          return {\n            headerName: metricKey,\n            colId: canonicalSortKey,\n            headerTooltip: canonicalSortKey,\n            field: createMetricFieldName(metricKey),\n            tooltipField: createMetricFieldName(metricKey),\n            initialWidth: 100,\n            initialHide: true,\n            sortable: true,\n            headerComponentParams: {\n              ...commonSortOrderProps,\n              canonicalSortKey,\n              getClassName: getHeaderClassName,\n            },\n            cellClass: getCellClassName,\n          };\n        }),\n      });\n    }\n\n    // Parameter columns\n    if (paramKeys.length) {\n      columns.push({\n        headerName: 'Parameters',\n        colId: COLUMN_TYPES.PARAMS,\n        children: paramKeys.map((paramKey) => {\n          const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.PARAMS, paramKey);\n          return {\n            colId: canonicalSortKey,\n            headerName: paramKey,\n            headerTooltip: canonicalSortKey,\n            field: createParamFieldName(paramKey),\n            tooltipField: createParamFieldName(paramKey),\n            initialHide: true,\n            initialWidth: 100,\n            sortable: true,\n            headerComponentParams: {\n              ...commonSortOrderProps,\n              canonicalSortKey,\n              getClassName: getHeaderClassName,\n            },\n            cellClass: getCellClassName,\n          };\n        }),\n      });\n    }\n\n    // Tags columns\n    if (tagKeys.length) {\n      columns.push({\n        headerName: 'Tags',\n        colId: COLUMN_TYPES.TAGS,\n        children: tagKeys.map((tagKey) => {\n          const canonicalSortKey = makeCanonicalSortKey(COLUMN_TYPES.TAGS, tagKey);\n          return {\n            colId: canonicalSortKey,\n            headerName: tagKey,\n            initialHide: true,\n            initialWidth: 100,\n            headerTooltip: canonicalSortKey,\n            field: createTagFieldName(tagKey),\n            tooltipField: createTagFieldName(tagKey),\n          };\n        }),\n      });\n    }\n\n    return columns;\n  }, [\n    orderByKey,\n    orderByAsc,\n    onSortBy,\n    onTogglePin,\n    onExpand,\n    compareExperiments,\n    cumulativeColumns,\n    isComparingRuns,\n  ]);\n\n  const canonicalSortKeys = useMemo(\n    () => [\n      ...ADJUSTABLE_ATTRIBUTE_COLUMNS.map((key) =>\n        makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, key),\n      ),\n      ...cumulativeColumns.paramKeys.map((key) => makeCanonicalSortKey(COLUMN_TYPES.PARAMS, key)),\n      ...cumulativeColumns.metricKeys.map((key) => makeCanonicalSortKey(COLUMN_TYPES.METRICS, key)),\n      ...cumulativeColumns.tagKeys.map((key) => makeCanonicalSortKey(COLUMN_TYPES.TAGS, key)),\n    ],\n    [cumulativeColumns],\n  );\n\n  useEffect(() => {\n    if (!columnApi || isComparingRuns) {\n      return;\n    }\n    for (const canonicalKey of canonicalSortKeys) {\n      const visible = selectedColumns.includes(canonicalKey);\n      columnApi.setColumnVisible(canonicalKey, visible);\n    }\n  }, [selectedColumns, columnApi, canonicalSortKeys, isComparingRuns]);\n\n  return columnSet;\n};\n\ntype ColDefWithChildren = ColDef & {\n  children?: ColDef[];\n};\n\nexport const EXPERIMENTS_DEFAULT_COLUMN_SETUP = {\n  initialWidth: 100,\n  autoSizePadding: 0,\n  headerComponentParams: { menuIcon: 'fa-bars' },\n  resizable: true,\n  filter: true,\n  suppressMenu: true,\n  suppressMovable: true,\n};\n","import React, { Component } from 'react';\nimport { ConfirmModal } from './ConfirmModal';\nimport PropTypes from 'prop-types';\nimport { deleteRunApi, openErrorModal } from '../../actions';\nimport { connect } from 'react-redux';\nimport Utils from '../../../common/utils/Utils';\n\nexport class DeleteRunModalImpl extends Component {\n  constructor(props) {\n    super(props);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  static propTypes = {\n    isOpen: PropTypes.bool.isRequired,\n    onClose: PropTypes.func.isRequired,\n    selectedRunIds: PropTypes.arrayOf(PropTypes.string).isRequired,\n    openErrorModal: PropTypes.func.isRequired,\n    deleteRunApi: PropTypes.func.isRequired,\n  };\n\n  handleSubmit() {\n    const deletePromises = [];\n    this.props.selectedRunIds.forEach((runId) => {\n      deletePromises.push(this.props.deleteRunApi(runId));\n    });\n    return Promise.all(deletePromises).catch(() => {\n      this.props.openErrorModal('While deleting an experiment run, an error occurred.');\n    });\n  }\n\n  render() {\n    const number = this.props.selectedRunIds.length;\n    return (\n      <ConfirmModal\n        isOpen={this.props.isOpen}\n        onClose={this.props.onClose}\n        handleSubmit={this.handleSubmit}\n        title={`Delete Experiment ${Utils.pluralize('Run', number)}`}\n        helpText={\n          <div>\n            <p>\n              <b>\n                {number} experiment {Utils.pluralize('run', number)} will be deleted.\n              </b>\n            </p>\n            {process.env.SHOW_GDPR_PURGING_MESSAGES === 'true' ? (\n              <p>\n                Deleted runs are restorable for 30 days, after which they are purged along with\n                associated metrics, params, tags, and artifacts.\n              </p>\n            ) : (\n              ''\n            )}\n          </div>\n        }\n        confirmButtonText={'Delete'}\n      />\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  deleteRunApi,\n  openErrorModal,\n};\n\nexport default connect(null, mapDispatchToProps)(DeleteRunModalImpl);\n","import React, { Component } from 'react';\nimport { ConfirmModal } from './ConfirmModal';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { openErrorModal, restoreRunApi } from '../../actions';\nimport Utils from '../../../common/utils/Utils';\n\nexport class RestoreRunModalImpl extends Component {\n  constructor(props) {\n    super(props);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  static propTypes = {\n    isOpen: PropTypes.bool.isRequired,\n    onClose: PropTypes.func.isRequired,\n    selectedRunIds: PropTypes.arrayOf(PropTypes.string).isRequired,\n    openErrorModal: PropTypes.func.isRequired,\n    restoreRunApi: PropTypes.func.isRequired,\n  };\n\n  handleSubmit() {\n    const restorePromises = [];\n    this.props.selectedRunIds.forEach((runId) => {\n      restorePromises.push(this.props.restoreRunApi(runId));\n    });\n    return Promise.all(restorePromises).catch((e) => {\n      const errorMessage = 'While restoring an experiment run, an error occurred.';\n      this.props.openErrorModal(errorMessage);\n    });\n  }\n\n  render() {\n    const number = this.props.selectedRunIds.length;\n    return (\n      <ConfirmModal\n        isOpen={this.props.isOpen}\n        onClose={this.props.onClose}\n        handleSubmit={this.handleSubmit}\n        title={`Restore Experiment ${Utils.pluralize('Run', number)}`}\n        helpText={`${number} experiment ${Utils.pluralize('run', number)} will be restored.`}\n        confirmButtonText={'Restore'}\n      />\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  restoreRunApi,\n  openErrorModal,\n};\n\nexport default connect(null, mapDispatchToProps)(RestoreRunModalImpl);\n","import qs from 'qs';\nimport { useMemo } from 'react';\nimport { useLocation, useRouteMatch } from 'react-router';\nimport Utils from '../../../../common/utils/Utils';\n\nexport type UseExperimentIdsResult = string[];\n\n/**\n * Hook that returns requested experiment IDs basing on the URL.\n * It extracts ids basing on either route match (in case of a single experiment)\n * or query params (in case of comparing experiments.).\n *\n * @returns array of strings with experiment IDs\n */\n\nexport const useExperimentIds = (): UseExperimentIdsResult => {\n  const match = useRouteMatch<{ experimentId?: string }>();\n  const location = useLocation();\n\n  const normalizedLocationSearch = useMemo(\n    () => decodeURIComponent(location.search),\n    [location.search],\n  );\n\n  /**\n   * Memoized string containing experiment IDs for comparison (\"?experiments=...\")\n   */\n  const compareExperimentIdsQueryParam = useMemo(() => {\n    const queryParams = qs.parse(normalizedLocationSearch.substring(1));\n    if (queryParams['experiments']) {\n      const experimentIdsRaw = queryParams['experiments'];\n      return experimentIdsRaw?.toString() || '';\n    }\n\n    return '';\n  }, [normalizedLocationSearch]);\n\n  return useMemo(() => {\n    // Case #1: single experiment\n    if (match.params?.experimentId) {\n      return [match.params?.experimentId];\n    }\n\n    // Case #2: multiple (compare) experiments\n    if (compareExperimentIdsQueryParam) {\n      try {\n        return JSON.parse(compareExperimentIdsQueryParam);\n      } catch {\n        // Apparently URL is malformed\n        Utils.logErrorAndNotifyUser(\n          `Could not parse experiment query parameter ${compareExperimentIdsQueryParam}`,\n        );\n        return '';\n      }\n    }\n\n    return [];\n  }, [compareExperimentIdsQueryParam, match.params?.experimentId]);\n};\n","import { chunk, isEqual } from 'lodash';\nimport { AnyAction } from 'redux';\nimport { searchModelVersionsApi } from '../../../../model-registry/actions';\nimport { MAX_RUNS_IN_SEARCH_MODEL_VERSIONS_FILTER } from '../../../../model-registry/constants';\nimport { ATTRIBUTE_COLUMN_SORT_KEY } from '../../../constants';\nimport { ViewType } from '../../../sdk/MlflowEnums';\nimport { KeyValueEntity, LIFECYCLE_FILTER } from '../../../types';\nimport { SearchExperimentRunsFacetsState } from '../models/SearchExperimentRunsFacetsState';\nimport { EXPERIMENT_LOG_MODEL_HISTORY_TAG } from './experimentPage.common-utils';\n\nconst START_TIME_COLUMN_OFFSET = {\n  ALL: null,\n  LAST_HOUR: 1 * 60 * 60 * 1000,\n  LAST_24_HOURS: 24 * 60 * 60 * 1000,\n  LAST_7_DAYS: 7 * 24 * 60 * 60 * 1000,\n  LAST_30_DAYS: 30 * 24 * 60 * 60 * 1000,\n  LAST_YEAR: 12 * 30 * 24 * 60 * 60 * 1000,\n};\n\n/**\n * This function checks if the sort+model state update has\n * been updated enough and if the change should invoke re-fetching\n * the runs from the back-end. This enables differentiation between\n * front-end and back-end filtering.\n */\nexport const shouldRefetchRuns = (\n  currentSearchFacetsState: SearchExperimentRunsFacetsState,\n  newSearchFacetsState: SearchExperimentRunsFacetsState,\n) =>\n  !isEqual(currentSearchFacetsState.searchFilter, newSearchFacetsState.searchFilter) ||\n  !isEqual(currentSearchFacetsState.orderByAsc, newSearchFacetsState.orderByAsc) ||\n  !isEqual(currentSearchFacetsState.orderByKey, newSearchFacetsState.orderByKey) ||\n  !isEqual(currentSearchFacetsState.lifecycleFilter, newSearchFacetsState.lifecycleFilter) ||\n  !isEqual(currentSearchFacetsState.startTime, newSearchFacetsState.startTime);\n\n/**\n * Creates \"order by\" SQL expression\n */\nconst createOrderByExpression = ({ orderByKey, orderByAsc }: SearchExperimentRunsFacetsState) => {\n  if (orderByKey) {\n    return orderByAsc ? [orderByKey + ' ASC'] : [orderByKey + ' DESC'];\n  }\n  return [];\n};\n\n/**\n * Creates SQL expression for filtering by run start time\n */\nconst createStartTimeExpression = (\n  { startTime }: SearchExperimentRunsFacetsState,\n  referenceTime: number,\n) => {\n  const offset = START_TIME_COLUMN_OFFSET[startTime as keyof typeof START_TIME_COLUMN_OFFSET];\n  if (!startTime || !offset || startTime === 'ALL') {\n    return null;\n  }\n  const startTimeOffset = referenceTime - offset;\n\n  return `attributes.start_time >= ${startTimeOffset}`;\n};\n\n/**\n * Combines search filter and start time SQL expressions\n */\nconst createFilterExpression = (\n  { searchFilter }: SearchExperimentRunsFacetsState,\n  startTimeExpression: string | null,\n) => {\n  if (searchFilter && startTimeExpression) {\n    return `${searchFilter} and ${startTimeExpression}`;\n  } else if (!searchFilter && startTimeExpression) {\n    return startTimeExpression;\n  } else {\n    return searchFilter || undefined;\n  }\n};\n\n/**\n * If this function returns true, the ExperimentView should nest children underneath their parents\n * and fetch all root level parents of visible runs. If this function returns false, the views will\n * not nest children or fetch any additional parents. Will always return true if the orderByKey is\n * 'attributes.start_time'\n */\nconst shouldNestChildrenAndFetchParents = ({\n  orderByKey,\n  searchFilter,\n}: SearchExperimentRunsFacetsState) =>\n  (!orderByKey && !searchFilter) || orderByKey === ATTRIBUTE_COLUMN_SORT_KEY.DATE;\n\n/**\n *\n * Function creates API-compatible query object basing on the given criteria.\n * @param experimentIds IDs of experiments to be queries for runs\n * @param searchFacetsState the sort/filter model to use\n * @param referenceTime reference time to calculate startTime filter\n * @param pageToken next page token if fetching the next page\n */\nexport const createSearchRunsParams = (\n  experimentIds: (number | string)[],\n  searchFacetsState: SearchExperimentRunsFacetsState,\n  referenceTime: number,\n  pageToken?: string,\n) => {\n  const runViewType =\n    searchFacetsState.lifecycleFilter === LIFECYCLE_FILTER.ACTIVE\n      ? ViewType.ACTIVE_ONLY\n      : ViewType.DELETED_ONLY;\n\n  const { runsPinned = undefined } = searchFacetsState;\n\n  const orderBy = createOrderByExpression(searchFacetsState);\n  const startTimeExpression = createStartTimeExpression(searchFacetsState, referenceTime);\n  const filter = createFilterExpression(searchFacetsState, startTimeExpression);\n  const shouldFetchParents = shouldNestChildrenAndFetchParents(searchFacetsState);\n\n  return {\n    // Experiment IDs\n    experimentIds,\n\n    // Filters and sort options\n    filter,\n    runViewType,\n    orderBy,\n    shouldFetchParents,\n\n    // Next page token for loading more runs\n    pageToken,\n    runsPinned,\n  };\n};\n\n/**\n * Function checks if given runs set contain info about log model history and if true,\n * fetches model versions for them\n *\n * @param runsPayload runs payload returned from the searchRuns API\n * @param actionCreator redux-thunk action creator that for search model versions action\n * @param dispatch redux-compatible dispatch function\n */\nexport const fetchModelVersionsForRuns = (\n  runsPayload: {\n    info: {\n      run_id: string;\n    };\n    data: {\n      tags: KeyValueEntity[];\n    };\n  }[],\n  actionCreator: typeof searchModelVersionsApi,\n  dispatch: (action: AnyAction) => Promise<AnyAction>,\n) => {\n  const runsWithLogModelHistory = runsPayload.filter((run) =>\n    run.data.tags.some((t) => t.key === EXPERIMENT_LOG_MODEL_HISTORY_TAG),\n  );\n\n  chunk(runsWithLogModelHistory, MAX_RUNS_IN_SEARCH_MODEL_VERSIONS_FILTER).forEach((runsChunk) => {\n    const action = actionCreator({ run_id: runsChunk.map((run) => run.info.run_id) });\n    dispatch(action);\n  });\n};\n","import {\n  ATTRIBUTE_COLUMN_LABELS,\n  COLUMN_TYPES,\n  DEFAULT_LIFECYCLE_FILTER,\n  DEFAULT_MODEL_VERSION_FILTER,\n  DEFAULT_ORDER_BY_ASC,\n  DEFAULT_ORDER_BY_KEY,\n  DEFAULT_START_TIME,\n} from '../../../constants';\nimport { CompareRunsChartSetup } from '../../../types';\nimport { makeCanonicalSortKey } from '../utils/experimentPage.column-utils';\n\nconst DEFAULT_SELECTED_COLUMNS = [\n  // \"Source\" and \"Model\" columns are visible by default\n  makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.SOURCE),\n  makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, ATTRIBUTE_COLUMN_LABELS.MODELS),\n];\n\n/**\n * Defines persistable model respresenting sort and filter values\n * used by runs table and controls\n */\nexport class SearchExperimentRunsFacetsState {\n  /**\n   * SQL-like query string used to filter runs, e.g. \"params.alpha = '0.5'\"\n   */\n  searchFilter = '';\n\n  /**\n   * Canonical order_by key like \"params.`alpha`\". May be null to indicate the table\n   * should use the natural row ordering provided by the server.\n   */\n  orderByKey = DEFAULT_ORDER_BY_KEY;\n\n  /**\n   * Whether the order imposed by orderByKey should be ascending or descending.\n   */\n  orderByAsc = DEFAULT_ORDER_BY_ASC;\n\n  /**\n   * Filter key to show results based on start time\n   */\n  startTime = DEFAULT_START_TIME;\n\n  /**\n   * Lifecycle filter of runs to display\n   */\n  lifecycleFilter = DEFAULT_LIFECYCLE_FILTER;\n\n  /**\n   * Filter of model versions to display\n   */\n  modelVersionFilter = DEFAULT_MODEL_VERSION_FILTER;\n\n  /**\n   * Currently selected columns\n   */\n  selectedColumns: string[] = [...DEFAULT_SELECTED_COLUMNS];\n\n  /**\n   * Object mapping run UUIDs (strings) to booleans, where a boolean value of true indicates that\n   * a run has been expanded (its child runs are visible).\n   */\n  runsExpanded: Record<string, boolean> = {};\n\n  /**\n   * List of pinned row UUIDs\n   */\n  runsPinned: string[] = [];\n\n  /**\n   * Is in compare runs mode\n   */\n  isComparingRuns = false;\n\n  /**\n   * Currently configured charts for comparing runs\n   */\n  compareRunCharts: CompareRunsChartSetup[] = [];\n}\n","import { SearchExperimentRunsFacetsState } from '../models/SearchExperimentRunsFacetsState';\n\ntype PersistSearchSerializeFunctions<Serialized = any, Unserialized = any> = {\n  serializeLocalStorage?(input: Unserialized): Serialized;\n  serializeQueryString?(input: Unserialized): Serialized;\n  deserializeLocalStorage?(input: Serialized): Unserialized;\n  deserializeQueryString?(input: Serialized): Unserialized;\n};\n\n/**\n * All known field serialization and deserialization mechanisms used in search facets state persisting mechanism.\n */\nconst persistSearchStateFieldSerializers: Record<string, PersistSearchSerializeFunctions> = {\n  /**\n   * Array of visible configured charts are serialized into base64-encoded JSON when put into query string\n   */\n  compareRunCharts: {\n    serializeQueryString(input: SearchExperimentRunsFacetsState['compareRunCharts']) {\n      return btoa(JSON.stringify(input));\n    },\n    deserializeQueryString(input: string): SearchExperimentRunsFacetsState['compareRunCharts'] {\n      try {\n        return JSON.parse(atob(input));\n      } catch {\n        return [];\n      }\n    },\n  },\n  /**\n   * For \"isComparingRuns\", we will always save \"false\" value to local storage so users will\n   * get back to default view after visiting the view once more\n   */\n  isComparingRuns: {\n    serializeLocalStorage() {\n      return false;\n    },\n  },\n};\n\ntype StateKey = keyof Partial<SearchExperimentRunsFacetsState>;\n\n/**\n * Consumes an object with persistable search facets and transforms relevant fields\n * with the registered serialization functions specific to query string.\n * Example scenario: serializing an array of visible configured charts into base64-encoded JSON.\n */\nexport const serializeFieldsToQueryString = (input: Partial<SearchExperimentRunsFacetsState>) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const serializeFn = persistSearchStateFieldSerializers[field]?.serializeQueryString;\n    if (serializeFn) {\n      resultObject[field] = serializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n\n/**\n * Consumes an object with search facets extracted from query string and transforms relevant fields\n * with the registered deserialization functions. Example scenario: deserializing an array of\n * visible configured charts from base64-encoded JSON.\n */\nexport const deserializeFieldsFromQueryString = (\n  input: Partial<SearchExperimentRunsFacetsState> | Record<string, any>,\n) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const deserializeFn = persistSearchStateFieldSerializers[field]?.deserializeQueryString;\n    if (deserializeFn) {\n      resultObject[field] = deserializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n\n/**\n * Consumes an object with persistable search facets and transforms relevant fields\n * with the registered serialization functions specific to local storage.\n * Example scenario: serializing an array of visible configured charts into base64-encoded JSON.\n */\nexport const serializeFieldsToLocalStorage = (input: Partial<SearchExperimentRunsFacetsState>) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const serializeFn = persistSearchStateFieldSerializers[field]?.serializeLocalStorage;\n    if (serializeFn) {\n      resultObject[field] = serializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n\n/**\n * Consumes an object with search facets extracted from local storage and transforms relevant fields\n * with the registered deserialization functions. Example scenario: deserializing an array of\n * visible configured charts from base64-encoded JSON.\n */\nexport const deserializeFieldsFromLocalStorage = (\n  input: Partial<SearchExperimentRunsFacetsState> | Record<string, any>,\n) => {\n  const resultObject: Partial<Record<StateKey, any>> = { ...input };\n  for (const field of Object.keys(resultObject) as StateKey[]) {\n    const deserializeFn = persistSearchStateFieldSerializers[field]?.deserializeLocalStorage;\n    if (deserializeFn) {\n      resultObject[field] = deserializeFn(resultObject[field]);\n    }\n  }\n  return resultObject;\n};\n","import { isArray, isObject } from 'lodash';\nimport QueryString, { IParseOptions } from 'qs';\nimport { shouldUseNextRunsComparisonUI } from '../../../../common/utils/FeatureUtils';\nimport LocalStorageUtils from '../../../../common/utils/LocalStorageUtils';\nimport Utils from '../../../../common/utils/Utils';\n\nimport { SearchExperimentRunsFacetsState } from '../models/SearchExperimentRunsFacetsState';\nimport {\n  deserializeFieldsFromLocalStorage,\n  deserializeFieldsFromQueryString,\n  serializeFieldsToLocalStorage,\n  serializeFieldsToQueryString,\n} from './persistSearchFacets.serializers';\n\n// Let's enable serialization/deserialization mechanism basing on the same feature flag\n// as next-gen runs comparison UI since the features are related\nconst shouldUseStateSerializer = () => shouldUseNextRunsComparisonUI();\n\nconst KNOWN_STATE_KEYS = Object.keys(new SearchExperimentRunsFacetsState());\n\n/**\n * Function used by QueryString.parse(), implements better handling of booleans and undefined values\n */\nconst urlParserDecoder: IParseOptions['decoder'] = (str, defaultDecoder, _, type) => {\n  if (type === 'value') {\n    if (str === 'true') {\n      return true;\n    } else if (str === 'false') {\n      return false;\n    } else if (str === undefined) {\n      return '';\n    }\n  }\n  return defaultDecoder(str);\n};\n\n/**\n * Function used for merging two facets search states.\n */\nconst mergeFacetsStates = (\n  base: SearchExperimentRunsFacetsState,\n  object: Partial<SearchExperimentRunsFacetsState>,\n): SearchExperimentRunsFacetsState =>\n  Object.assign(new SearchExperimentRunsFacetsState(), {\n    ...base,\n    ...object,\n  });\n\n/**\n * Performs basic checks on partial facets state model. Returns false if\n * fields expected to be objects or arrays are not what they are supposed to be.\n */\nfunction validateFacetsState(model: Partial<SearchExperimentRunsFacetsState>) {\n  if (model.runsExpanded && !isObject(model.runsExpanded)) {\n    return false;\n  }\n\n  if (model.selectedColumns && !isArray(model.selectedColumns)) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Persists current facets state in local storage.\n */\nfunction persistLocalStorage(data: Partial<SearchExperimentRunsFacetsState>, idKey: string) {\n  // TODO: decide if we want to use LocalStorageUtils store or fall back to direct use of localStorage\n  const localStorageInstance = LocalStorageUtils.getStoreForComponent('ExperimentPage', idKey);\n  const sortFilterModelToSave = shouldUseStateSerializer()\n    ? serializeFieldsToLocalStorage(data)\n    : data;\n  localStorageInstance.saveComponentState(sortFilterModelToSave);\n}\n\n/**\n * Creates the URL query string representing the current search facets state.\n */\nfunction createPersistedQueryString(\n  sortFilterModelToSave: Partial<SearchExperimentRunsFacetsState> & { experiments?: any },\n) {\n  const serializedSortFilterModelToSave = shouldUseStateSerializer()\n    ? serializeFieldsToQueryString(sortFilterModelToSave)\n    : sortFilterModelToSave;\n\n  return QueryString.stringify(serializedSortFilterModelToSave, {\n    addQueryPrefix: true,\n    arrayFormat: 'comma',\n    encodeValuesOnly: true,\n  });\n}\n\n/**\n * Consumes object containing all fields parsed from search query and\n * separates those relevant to the search state from the rest.\n */\nfunction extractExperimentSearchFacetsState<\n  // Template for partial state type\n  PartialState extends Partial<SearchExperimentRunsFacetsState>,\n  // Template for partial state + the rest type\n  URLObject extends PartialState,\n>(rawURLSearchData: URLObject) {\n  const stateData: PartialState = {} as PartialState;\n  const restData: Omit<URLObject, keyof PartialState> = {} as Omit<URLObject, keyof PartialState>;\n\n  for (const field in rawURLSearchData) {\n    if (rawURLSearchData.hasOwnProperty(field)) {\n      const isKnownField = KNOWN_STATE_KEYS.includes(field);\n      Object.assign(isKnownField ? stateData : restData, { [field]: rawURLSearchData[field] });\n    }\n  }\n  return { stateData, restData };\n}\n\n/**\n * Persists current facets state in local storage and returns query string to be persisted in the URL.\n */\nexport function persistExperimentSearchFacetsState(\n  sortFilterModelToSave: SearchExperimentRunsFacetsState,\n  idKey: string,\n  currentLocationSearch = '',\n) {\n  const currentParameters = QueryString.parse(currentLocationSearch, {\n    ignoreQueryPrefix: true,\n    comma: true,\n    arrayLimit: 500,\n    decoder: urlParserDecoder,\n  });\n  // Extract current query params and re-persist relevant ones.\n  // In this case, it's only \"experiments\" field used for comparison.\n  const { experiments } = currentParameters;\n  persistLocalStorage(sortFilterModelToSave, idKey);\n  return createPersistedQueryString({ experiments, ...sortFilterModelToSave });\n}\n\n/**\n * Restores facets state from local storage and URL query string.\n *\n * @param location extracted e.g. from useLocation\n * @param idKey unique key for the storage\n * @param persistCombinedToLocalStorage if true, the combined state will be re-persisted to local storage\n */\nexport function restoreExperimentSearchFacetsState(locationSearch: string, idKey: string) {\n  // Step 1: prepare base value\n  let baseState = new SearchExperimentRunsFacetsState();\n\n  // Step 2: extract current state from local storage\n  try {\n    // TODO: decide if we want to use LocalStorageUtils store or fall back to direct use of localStorage\n    const localStorageInstance = LocalStorageUtils.getStoreForComponent('ExperimentPage', idKey);\n    const rawLocalStorageValue = localStorageInstance.loadComponentState();\n    if (validateFacetsState(rawLocalStorageValue)) {\n      const localStorageValue = shouldUseStateSerializer()\n        ? deserializeFieldsFromLocalStorage(rawLocalStorageValue)\n        : rawLocalStorageValue;\n      // Merge it with the base state only if it's valid\n      baseState = mergeFacetsStates(baseState, localStorageValue);\n    }\n  } catch {\n    Utils.logErrorAndNotifyUser(\n      `Error: malformed persisted search state for experiment(s) ${idKey}`,\n    );\n  }\n\n  // Preliminarily decode the search query, despite QueryString.parse doing the same.\n  // In certain scenarios the search values can arrive double-encoded\n  // (e.g. after being redirected from the login page) so by doing this, we ensure\n  // that the values will be properly decoded at the end.\n  const normalizedLocationSearch = decodeURIComponent(locationSearch);\n\n  // Step 3: extract data from URL...\n  const rawUrlData = QueryString.parse(normalizedLocationSearch, {\n    ignoreQueryPrefix: true,\n    comma: true,\n    arrayLimit: 500,\n    decoder: urlParserDecoder,\n  });\n  const { restData, stateData } = extractExperimentSearchFacetsState(rawUrlData);\n\n  const transformedStateData = shouldUseStateSerializer()\n    ? deserializeFieldsFromQueryString(stateData)\n    : stateData;\n\n  // If the is at least one relevant query params in URL, take URL into consideration.\n  const isURLStateEmpty = Object.keys(transformedStateData).length < 1;\n  if (!isURLStateEmpty) {\n    // We need merge specified fields from the URL query to the empty state.\n    // In certain scenarios, parts of the state (e.g. empty arrays) are not being persisted in the URL\n    // and we need to regenerate them.\n    const urlState = Object.assign(new SearchExperimentRunsFacetsState(), transformedStateData);\n    baseState = mergeFacetsStates(baseState, urlState);\n  }\n\n  // Step 4: persist combined state again\n  persistLocalStorage(baseState, idKey);\n\n  // Make it impossible to use comparing runs mode if flag is disabled\n  if (!shouldUseNextRunsComparisonUI()) {\n    baseState.isComparingRuns = false;\n  }\n\n  return {\n    state: baseState,\n    queryString: createPersistedQueryString({ ...restData, ...baseState }),\n  };\n}\n","import { isFunction } from 'lodash';\nimport React, { createContext, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport RequestStateWrapper from '../../../../common/components/RequestStateWrapper';\nimport { loadMoreRunsApi, searchRunsApi, searchRunsPayload } from '../../../actions';\nimport { useExperimentIds } from '../hooks/useExperimentIds';\nimport { SearchExperimentRunsFacetsState } from '../models/SearchExperimentRunsFacetsState';\nimport Utils from '../../../../common/utils/Utils';\nimport { searchModelVersionsApi } from '../../../../model-registry/actions';\nimport { UpdateExperimentSearchFacetsFn } from '../../../types';\nimport { useAsyncDispatch } from '../hooks/useAsyncDispatch';\nimport {\n  createSearchRunsParams,\n  fetchModelVersionsForRuns,\n  shouldRefetchRuns,\n} from '../utils/experimentPage.fetch-utils';\nimport {\n  persistExperimentSearchFacetsState,\n  restoreExperimentSearchFacetsState,\n} from '../utils/persistSearchFacets';\n\nexport interface GetExperimentRunsContextActions {\n  searchRunsApi: typeof searchRunsApi;\n  loadMoreRunsApi: typeof loadMoreRunsApi;\n  searchRunsPayload: typeof searchRunsPayload;\n  searchModelVersionsApi: typeof searchModelVersionsApi;\n}\n\nexport interface GetExperimentRunsContextType {\n  /**\n   * Represents the currently used filter/sort model\n   */\n  searchFacetsState: SearchExperimentRunsFacetsState;\n\n  /**\n   * Indicates if runs are being loaded at the moment\n   */\n  isLoadingRuns: boolean;\n\n  /**\n   * Function used to (re)fetch runs with the currently used filter set.\n   * Use scenarios: initial fetch, refreshing the list.\n   */\n  fetchExperimentRuns: () => void;\n\n  /**\n   * Function used to update the filter set and fetch new set of runs.\n   * First parameter is the subset of fields that the current sort/filter model will be merged with.\n   * If the second parameter is set to true, it will force re-fetching even if there\n   * are no sufficient changes to the model.\n   */\n  updateSearchFacets: UpdateExperimentSearchFacetsFn;\n\n  /**\n   * Function used to load more runs (if available) using currently used filters\n   */\n  loadMoreRuns: () => void;\n\n  /**\n   * Contains error descriptor if fetching runs failed\n   */\n  requestError: any;\n\n  /**\n   * All run-related actions creators\n   */\n  actions: GetExperimentRunsContextActions;\n\n  /**\n   * True if there are more paginated runs available\n   */\n  moreRunsAvailable: boolean;\n\n  /**\n   * Returns true if user has not changed sort/filter model and is using the default one\n   */\n  isPristine: () => boolean;\n}\n\n/**\n * Wrapper context that serves two purposes:\n * - aggregates concrete redux actions necessary to perform experiments run search\n * - holds currently used state with sort and filter options, also is responsible for persisting it\n */\nexport const GetExperimentRunsContext = createContext<GetExperimentRunsContextType | null>(null);\n\n/**\n * Provider component for SearchExperimentRunsContext.\n * Accepts concrete redux actions for searching runs.\n */\nexport const GetExperimentRunsContextProvider = ({\n  children,\n  actions,\n}: React.PropsWithChildren<{\n  actions: GetExperimentRunsContextActions;\n}>) => {\n  const history = useHistory();\n  const experimentIds = useExperimentIds();\n  const dispatch = useAsyncDispatch();\n\n  const [searchRunsRequestId, setSearchRunsRequestId] = useState<string>('');\n  const [isLoadingRuns, setIsLoadingRuns] = useState(false);\n  const [moreRunsAvailable, setMoreRunsAvailable] = useState(false);\n  const [requestError, setRequestError] = useState<any>(null);\n\n  const experimentIdsHash = useMemo(() => JSON.stringify(experimentIds.sort()), [experimentIds]);\n\n  const [searchFacetsState, setSearchFacetsState] = useState<SearchExperimentRunsFacetsState>(\n    () => {\n      // useState() initialization function that restores current search facets state\n      const { queryString, state } = restoreExperimentSearchFacetsState(\n        history.location.search,\n        experimentIdsHash,\n      );\n\n      // If resulting query string differs from the current one, replace it.\n      if (history.location.search !== queryString) {\n        history.replace(`${history.location.pathname}${queryString}`);\n      }\n      return state;\n    },\n  );\n\n  // Next page token is not a stateful field and can be mutable.\n  const nextPageToken = useRef<string>('');\n\n  // Indicates reference time for fetching subsuquent pages which\n  // requires us to keep the same startTime parameter value.\n  // Not a stateful field.\n  const referenceTime = useRef<string>('');\n\n  // Indicates if user has explicitly changed the sort/filter state\n  const isPristineFlag = useRef(true);\n  // Immutable method that returns value from the mutable flag\n  const isPristine = useCallback(() => isPristineFlag.current, []);\n\n  const internalFetchExperimentRuns = useCallback(\n    (\n      requestSearchFacetsState: SearchExperimentRunsFacetsState,\n      requestExperimentIds: string[],\n      requestReferenceTime = Date.now(),\n      requestNextPageToken?: string,\n    ) => {\n      const loadMore = Boolean(requestNextPageToken);\n      if (!loadMore) {\n        referenceTime.current = requestReferenceTime;\n      }\n\n      const actionToUse = loadMore ? actions.loadMoreRunsApi : actions.searchRunsApi;\n\n      const action = actionToUse(\n        createSearchRunsParams(\n          requestExperimentIds,\n          requestSearchFacetsState,\n          requestReferenceTime,\n          requestNextPageToken || undefined,\n        ),\n      );\n\n      // Immediately set loading runs flag, don't wait for RequestStateWrapper\n      // otherwise it will result in the unnecessary rerender\n      setIsLoadingRuns(true);\n      dispatch(action)\n        .then(({ value }) => {\n          nextPageToken.current = value.next_page_token;\n          setMoreRunsAvailable(Boolean(value.next_page_token));\n          fetchModelVersionsForRuns(value.runs || [], actions.searchModelVersionsApi, dispatch);\n        })\n        .catch((e) => {\n          Utils.logErrorAndNotifyUser(e);\n        });\n\n      setSearchRunsRequestId(action.meta.id);\n    },\n    [dispatch, actions],\n  );\n\n  const loadMoreRuns = useCallback(() => {\n    internalFetchExperimentRuns(\n      searchFacetsState,\n      experimentIds,\n      referenceTime.current || undefined,\n      nextPageToken.current || undefined,\n    );\n  }, [internalFetchExperimentRuns, searchFacetsState, experimentIds]);\n\n  /**\n   * Fetches fresh batch of runs using current sort model\n   */\n  const fetchExperimentRuns = useCallback(() => {\n    internalFetchExperimentRuns(searchFacetsState, experimentIds);\n  }, [experimentIds, internalFetchExperimentRuns, searchFacetsState]);\n\n  const persistState = useCallback(\n    (sortFilterModelToSave: SearchExperimentRunsFacetsState) => {\n      const newQueryString = persistExperimentSearchFacetsState(\n        sortFilterModelToSave,\n        experimentIdsHash,\n        history.location.search,\n      );\n      if (history.location.search !== newQueryString) {\n        history.push(`${history.location.pathname}${newQueryString}`);\n      }\n    },\n    [history, experimentIdsHash],\n  );\n\n  /**\n   * Updates current search facets model and invokes re-fetching runs if necessary.\n   * Persists new search state in storage and URL.\n   *\n   * @param newFilterModel A search facets model to replace the current one. It can\n   *                       be provided in the form of the partial object that will be merged\n   *                       with the current one or the setter function having the current model\n   *                       provided as a parameter and returning the merged model, similarly to the\n   *                       React's `setState()` pattern.\n   * @param updateOptions  Additional update options provided:\n   *                       - `forceRefresh` - if set to `true`, will force re-fetching runs\n   *                         regardless of the resulting search facets model.\n   *                       - `preservePristine` - if set to `true`, will not change internal \"pristine\"\n   *                         flag used to detect if user have tampered with the search model.\n   *\n   * @examples\n   * ```\n   * // Simple use, updates search filter\n   * updateSearchFacets({\n   *   searchFilter: 'attributes.start_time > 1000',\n   * });\n   *\n   * // Setter function variant, updates selected columns\n   * updateSearchFacets((currentModel) => ({\n   *   ...currentModel,\n   *   selectedColumns: [...currentModel.selectedColumns, 'someColumn'],\n   * }));\n   *\n   * // Using function to force re-fetch while retaining pristine flag\n   * const forceRefreshModel = updateSearchFacets({}, {\n   *   forceRefresh: true,\n   *   preservePristine: true,\n   * });\n   * ```\n   */\n  const updateSearchFacets = useCallback<UpdateExperimentSearchFacetsFn>(\n    (newFilterModel, updateOptions = {}) => {\n      const { forceRefresh = false, preservePristine = false } = updateOptions;\n      // While dispatching new state, append new filter model\n      // and fetch new runs using it\n      setSearchFacetsState((oldModel) => {\n        const newModel = isFunction(newFilterModel)\n          ? newFilterModel(oldModel)\n          : { ...oldModel, ...newFilterModel };\n        if (forceRefresh || shouldRefetchRuns(oldModel, newModel)) {\n          internalFetchExperimentRuns(newModel, experimentIds);\n        }\n        persistState(newModel);\n        return newModel;\n      });\n      // Update the flag which indicates that the user have performed\n      // a search with changed sort/filter model\n      if (!preservePristine) {\n        isPristineFlag.current = false;\n      }\n    },\n    [experimentIds, internalFetchExperimentRuns, persistState],\n  );\n\n  /**\n   * Dynamically restore searchFacets state on history navigation.\n   * Note: MLFlow running in iFrame won't get proper history pop updates\n   * from overrarching router, meaning that history.listen() won't work at all. In this case,\n   * the page will get reloaded and useState()'s initialization function will restore the state instead.\n   */\n  useEffect(() => {\n    return history.listen((location, action) => {\n      if (action === 'POP') {\n        const { state } = restoreExperimentSearchFacetsState(location.search, experimentIdsHash);\n        updateSearchFacets(state);\n      }\n    });\n  }, [history, experimentIdsHash, updateSearchFacets]);\n\n  const contextValue = useMemo(\n    () => ({\n      actions,\n      searchFacetsState,\n      fetchExperimentRuns,\n      updateSearchFacets,\n      loadMoreRuns,\n      requestError,\n      isLoadingRuns,\n      moreRunsAvailable,\n      isPristine,\n    }),\n    [\n      actions,\n      searchFacetsState,\n      fetchExperimentRuns,\n      loadMoreRuns,\n      requestError,\n      isLoadingRuns,\n      updateSearchFacets,\n      moreRunsAvailable,\n      isPristine,\n    ],\n  );\n\n  const renderFn = (_isLoading: false, _renderError: any, requests: any[]) => {\n    /**\n     * TODO:\n     * Defer setting this state because currently it might happen inside\n     * RequestStateWrapper's render function which causes React to act up.\n     * Either rebuild RequestStateWrapper or introduce some workaround.\n     */\n    setIsLoadingRuns(requests.some((r) => r.id === searchRunsRequestId && r.active));\n\n    requests.forEach((request) => {\n      if (request.error) {\n        setRequestError(request.error);\n      }\n    });\n    return children;\n  };\n\n  return (\n    <GetExperimentRunsContext.Provider value={contextValue}>\n      <RequestStateWrapper\n        shouldOptimisticallyRender\n        // eslint-disable-next-line no-trailing-spaces\n        requestIds={searchRunsRequestId ? [searchRunsRequestId] : []}\n      >\n        {renderFn}\n      </RequestStateWrapper>\n    </GetExperimentRunsContext.Provider>\n  );\n};\n","import { useContext } from 'react';\n\nimport { GetExperimentRunsContext } from '../contexts/GetExperimentRunsContext';\n\nexport const useFetchExperimentRuns = () => {\n  const getExperimentRunsContextValue = useContext(GetExperimentRunsContext);\n\n  if (!getExperimentRunsContextValue) {\n    throw new Error('Trying to use SearchExperimentRunsContext actions outside of the context!');\n  }\n\n  return getExperimentRunsContextValue;\n};\n","import { useCallback } from 'react';\nimport DeleteRunModal from '../../../modals/DeleteRunModal';\nimport { RenameRunModal } from '../../../modals/RenameRunModal';\nimport RestoreRunModal from '../../../modals/RestoreRunModal';\nimport { useFetchExperimentRuns } from '../../hooks/useFetchExperimentRuns';\n\nexport interface ExperimentViewModalsProps {\n  showDeleteRunModal: boolean;\n  showRestoreRunModal: boolean;\n  showRenameRunModal: boolean;\n  runsSelected: Record<string, boolean>;\n  onCloseDeleteRunModal: () => void;\n  onCloseRestoreRunModal: () => void;\n  onCloseRenameRunModal: () => void;\n  renamedRunName: string;\n}\n\n/**\n * A component that contains modals required for the run\n * management, i.e. delete and restore actions.\n */\nexport const ExperimentViewRunModals = ({\n  showDeleteRunModal,\n  showRestoreRunModal,\n  showRenameRunModal,\n  runsSelected,\n  onCloseDeleteRunModal,\n  onCloseRestoreRunModal,\n  onCloseRenameRunModal,\n  renamedRunName,\n}: ExperimentViewModalsProps) => {\n  const { updateSearchFacets } = useFetchExperimentRuns();\n\n  const selectedRunIds = Object.entries(runsSelected)\n    .filter(([, selected]) => selected)\n    .map(([key]) => key);\n\n  /**\n   * Function used to refresh the list after renaming the run\n   */\n  const refreshRuns = useCallback(\n    () =>\n      updateSearchFacets(\n        {},\n        {\n          forceRefresh: true,\n          preservePristine: true,\n        },\n      ),\n    [updateSearchFacets],\n  );\n\n  return (\n    <>\n      <DeleteRunModal\n        isOpen={showDeleteRunModal}\n        onClose={onCloseDeleteRunModal}\n        selectedRunIds={selectedRunIds}\n      />\n      <RestoreRunModal\n        isOpen={showRestoreRunModal}\n        onClose={onCloseRestoreRunModal}\n        selectedRunIds={selectedRunIds}\n      />\n      <RenameRunModal\n        runUuid={selectedRunIds[0]}\n        onClose={onCloseRenameRunModal}\n        runName={renamedRunName}\n        isOpen={showRenameRunModal}\n        onSuccess={() => refreshRuns()}\n      />\n    </>\n  );\n};\n","import { Button, Option, Select } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useHistory } from 'react-router-dom';\nimport { LIFECYCLE_FILTER } from '../../../../constants';\nimport Routes from '../../../../routes';\nimport { UpdateExperimentSearchFacetsFn } from '../../../../types';\nimport { SearchExperimentRunsFacetsState } from '../../models/SearchExperimentRunsFacetsState';\nimport { SearchExperimentRunsViewState } from '../../models/SearchExperimentRunsViewState';\nimport { getStartTimeColumnDisplayName } from '../../utils/experimentPage.common-utils';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { ExperimentViewRunModals } from './ExperimentViewRunModals';\n\nexport type ExperimentViewRunsControlsActionsProps = {\n  viewState: SearchExperimentRunsViewState;\n\n  searchFacetsState: SearchExperimentRunsFacetsState;\n  updateSearchFacets: UpdateExperimentSearchFacetsFn;\n  runsData: ExperimentRunsSelectorResult;\n\n  visibleRowsCount: number;\n};\n\nexport const ExperimentViewRunsControlsActions = React.memo(\n  ({\n    viewState,\n    runsData,\n    searchFacetsState,\n    updateSearchFacets,\n    visibleRowsCount,\n  }: ExperimentViewRunsControlsActionsProps) => {\n    const { runsSelected } = viewState;\n    const { runInfos } = runsData;\n    const { lifecycleFilter, startTime } = searchFacetsState;\n\n    const history = useHistory();\n    const intl = useIntl();\n\n    // List of labels for \"start time\" filter\n    const startTimeColumnLabels = useMemo(() => getStartTimeColumnDisplayName(intl), [intl]);\n\n    const [showDeleteRunModal, setShowDeleteRunModal] = useState(false);\n    const [showRestoreRunModal, setShowRestoreRunModal] = useState(false);\n    const [showRenameRunModal, setShowRenameRunModal] = useState(false);\n    const [renamedRunName, setRenamedRunName] = useState('');\n\n    const renameButtonClicked = useCallback(() => {\n      const runsSelectedList = Object.keys(runsSelected);\n      const selectedRun = runInfos.find((info) => info.run_uuid === runsSelectedList[0]);\n      if (selectedRun) {\n        setRenamedRunName(selectedRun.run_name);\n        setShowRenameRunModal(true);\n      }\n    }, [runInfos, runsSelected]);\n\n    const compareButtonClicked = useCallback(() => {\n      const runsSelectedList = Object.keys(runsSelected);\n      const experimentIds = runInfos\n        .filter(({ run_uuid }: any) => runsSelectedList.includes(run_uuid))\n        .map(({ experiment_id }: any) => experiment_id);\n      history.push(\n        Routes.getCompareRunPageRoute(runsSelectedList, [...new Set(experimentIds)].sort()),\n      );\n    }, [history, runInfos, runsSelected]);\n\n    const onDeleteRun = useCallback(() => setShowDeleteRunModal(true), []);\n    const onRestoreRun = useCallback(() => setShowRestoreRunModal(true), []);\n    const onCloseDeleteRunModal = useCallback(() => setShowDeleteRunModal(false), []);\n    const onCloseRestoreRunModal = useCallback(() => setShowRestoreRunModal(false), []);\n    const onCloseRenameRunModal = useCallback(() => setShowRenameRunModal(false), []);\n\n    const selectedRunsCount = Object.values(viewState.runsSelected).filter(Boolean).length;\n    const canRestoreRuns = selectedRunsCount > 0;\n    const canRenameRuns = selectedRunsCount === 1;\n    const canCompareRuns = selectedRunsCount > 1;\n    const showActionButtons = canCompareRuns || canRenameRuns || canRestoreRuns;\n\n    const currentLifecycleFilterLabel = (\n      <>\n        <FormattedMessage\n          defaultMessage='State:'\n          description='Filtering label to filter experiments based on state of active or deleted'\n        />{' '}\n        {lifecycleFilter}\n      </>\n    );\n\n    const currentStartTimeFilterLabel = (\n      <>\n        <FormattedMessage\n          defaultMessage='Time created'\n          description='Label for the start time select dropdown for experiment runs view'\n        />\n        : {startTimeColumnLabels[startTime as keyof typeof startTimeColumnLabels]}\n      </>\n    );\n\n    return (\n      <div css={styles.controlBar}>\n        <ExperimentViewRunModals\n          runsSelected={runsSelected}\n          onCloseRenameRunModal={onCloseRenameRunModal}\n          onCloseDeleteRunModal={onCloseDeleteRunModal}\n          onCloseRestoreRunModal={onCloseRestoreRunModal}\n          showDeleteRunModal={showDeleteRunModal}\n          showRestoreRunModal={showRestoreRunModal}\n          showRenameRunModal={showRenameRunModal}\n          renamedRunName={renamedRunName}\n        />\n\n        {!showActionButtons && (\n          <>\n            <Select\n              className='start-time-select'\n              value={{ value: startTime, label: currentStartTimeFilterLabel }}\n              labelInValue\n              onChange={({ value: newStartTime }) => {\n                updateSearchFacets({ startTime: newStartTime });\n              }}\n              data-test-id='start-time-select-dropdown'\n              // Temporarily we're disabling virtualized list to maintain\n              // backwards compatiblity. Functional unit tests rely heavily\n              // on non-virtualized values.\n              dangerouslySetAntdProps={{ virtual: false } as any}\n            >\n              {Object.keys(startTimeColumnLabels).map((startTimeKey) => (\n                <Option\n                  key={startTimeKey}\n                  title={startTimeColumnLabels[startTimeKey as keyof typeof startTimeColumnLabels]}\n                  data-test-id={`start-time-select-${startTimeKey}`}\n                  value={startTimeKey}\n                >\n                  {startTimeColumnLabels[startTimeKey as keyof typeof startTimeColumnLabels]}\n                </Option>\n              ))}\n            </Select>\n\n            <Select\n              value={{ value: lifecycleFilter, label: currentLifecycleFilterLabel }}\n              labelInValue\n              data-testid='lifecycle-filter'\n              onChange={({ value }) => updateSearchFacets({ lifecycleFilter: value })}\n            >\n              <Select.Option data-testid='active-runs-menu-item' value={LIFECYCLE_FILTER.ACTIVE}>\n                <FormattedMessage\n                  defaultMessage='Active'\n                  description='Linked model dropdown option to show active experiment runs'\n                />\n              </Select.Option>\n              <Select.Option data-testid='deleted-runs-menu-item' value={LIFECYCLE_FILTER.DELETED}>\n                <FormattedMessage\n                  defaultMessage='Deleted'\n                  description='Linked model dropdown option to show deleted experiment runs'\n                />\n              </Select.Option>\n            </Select>\n          </>\n        )}\n\n        {showActionButtons && (\n          <>\n            <Button\n              data-testid='runs-compare-button'\n              disabled={!canCompareRuns}\n              onClick={compareButtonClicked}\n            >\n              <FormattedMessage\n                defaultMessage='Compare'\n                // eslint-disable-next-line max-len\n                description='String for the compare button to compare experiment runs to find an ideal model'\n              />\n            </Button>\n            <Button\n              data-testid='run-rename-button'\n              onClick={renameButtonClicked}\n              disabled={!canRenameRuns}\n            >\n              <FormattedMessage\n                defaultMessage='Rename'\n                description='Label for the rename run button above the experiment runs table'\n              />\n            </Button>\n            {lifecycleFilter === LIFECYCLE_FILTER.ACTIVE ? (\n              <Button\n                data-testid='runs-delete-button'\n                disabled={!canRestoreRuns}\n                onClick={onDeleteRun}\n                danger\n              >\n                <FormattedMessage\n                  defaultMessage='Delete'\n                  // eslint-disable-next-line max-len\n                  description='String for the delete button to delete a particular experiment run'\n                />\n              </Button>\n            ) : null}\n            {lifecycleFilter === LIFECYCLE_FILTER.DELETED ? (\n              <Button\n                data-testid='runs-restore-button'\n                disabled={!canRestoreRuns}\n                onClick={onRestoreRun}\n              >\n                <FormattedMessage\n                  defaultMessage='Restore'\n                  // eslint-disable-next-line max-len\n                  description='String for the restore button to undo the experiments that were deleted'\n                />\n              </Button>\n            ) : null}\n          </>\n        )}\n        <div css={styles.groupSeparator} />\n        <div>\n          <FormattedMessage\n            // eslint-disable-next-line max-len\n            defaultMessage='Showing {length} matching {length, plural, =0 {runs} =1 {run} other {runs}}'\n            // eslint-disable-next-line max-len\n            description='Message for displaying how many runs match search criteria on experiment page'\n            values={{ length: visibleRowsCount }}\n          />\n        </div>\n      </div>\n    );\n  },\n);\n\nconst styles = {\n  groupSeparator: () => ({ flex: 1 }),\n  controlBar: (theme: Theme) => ({\n    display: 'flex',\n    gap: theme.spacing.sm,\n    alignItems: 'center',\n    paddingTop: theme.spacing.sm,\n    borderTop: `1px solid ${theme.colors.border}`,\n  }),\n};\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport * as React from 'react';\nimport classNames from 'classnames';\n\nfunction UnitNumber(_ref) {\n  var prefixCls = _ref.prefixCls,\n      value = _ref.value,\n      current = _ref.current,\n      _ref$offset = _ref.offset,\n      offset = _ref$offset === void 0 ? 0 : _ref$offset;\n  var style;\n\n  if (offset) {\n    style = {\n      position: 'absolute',\n      top: \"\".concat(offset, \"00%\"),\n      left: 0\n    };\n  }\n\n  return /*#__PURE__*/React.createElement(\"span\", {\n    style: style,\n    className: classNames(\"\".concat(prefixCls, \"-only-unit\"), {\n      current: current\n    })\n  }, value);\n}\n\nfunction getOffset(start, end, unit) {\n  var index = start;\n  var offset = 0;\n\n  while ((index + 10) % 10 !== end) {\n    index += unit;\n    offset += unit;\n  }\n\n  return offset;\n}\n\nexport default function SingleNumber(props) {\n  var prefixCls = props.prefixCls,\n      originCount = props.count,\n      originValue = props.value;\n  var value = Number(originValue);\n  var count = Math.abs(originCount);\n\n  var _React$useState = React.useState(value),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      prevValue = _React$useState2[0],\n      setPrevValue = _React$useState2[1];\n\n  var _React$useState3 = React.useState(count),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      prevCount = _React$useState4[0],\n      setPrevCount = _React$useState4[1]; // ============================= Events =============================\n\n\n  var onTransitionEnd = function onTransitionEnd() {\n    setPrevValue(value);\n    setPrevCount(count);\n  }; // Fallback if transition event not support\n\n\n  React.useEffect(function () {\n    var timeout = setTimeout(function () {\n      onTransitionEnd();\n    }, 1000);\n    return function () {\n      clearTimeout(timeout);\n    };\n  }, [value]); // ============================= Render =============================\n  // Render unit list\n\n  var unitNodes;\n  var offsetStyle;\n\n  if (prevValue === value || Number.isNaN(value) || Number.isNaN(prevValue)) {\n    // Nothing to change\n    unitNodes = [/*#__PURE__*/React.createElement(UnitNumber, _extends({}, props, {\n      key: value,\n      current: true\n    }))];\n    offsetStyle = {\n      transition: 'none'\n    };\n  } else {\n    unitNodes = []; // Fill basic number units\n\n    var end = value + 10;\n    var unitNumberList = [];\n\n    for (var index = value; index <= end; index += 1) {\n      unitNumberList.push(index);\n    } // Fill with number unit nodes\n\n\n    var prevIndex = unitNumberList.findIndex(function (n) {\n      return n % 10 === prevValue;\n    });\n    unitNodes = unitNumberList.map(function (n, index) {\n      var singleUnit = n % 10;\n      return /*#__PURE__*/React.createElement(UnitNumber, _extends({}, props, {\n        key: n,\n        value: singleUnit,\n        offset: index - prevIndex,\n        current: index === prevIndex\n      }));\n    }); // Calculate container offset value\n\n    var unit = prevCount < count ? 1 : -1;\n    offsetStyle = {\n      transform: \"translateY(\".concat(-getOffset(prevValue, value, unit), \"00%)\")\n    };\n  }\n\n  return /*#__PURE__*/React.createElement(\"span\", {\n    className: \"\".concat(prefixCls, \"-only\"),\n    style: offsetStyle,\n    onTransitionEnd: onTransitionEnd\n  }, unitNodes);\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport { ConfigContext } from '../config-provider';\nimport { cloneElement } from '../_util/reactNode';\nimport SingleNumber from './SingleNumber';\n\nvar ScrollNumber = function ScrollNumber(_a) {\n  var customizePrefixCls = _a.prefixCls,\n      count = _a.count,\n      className = _a.className,\n      motionClassName = _a.motionClassName,\n      style = _a.style,\n      title = _a.title,\n      show = _a.show,\n      _a$component = _a.component,\n      component = _a$component === void 0 ? 'sup' : _a$component,\n      children = _a.children,\n      restProps = __rest(_a, [\"prefixCls\", \"count\", \"className\", \"motionClassName\", \"style\", \"title\", \"show\", \"component\", \"children\"]);\n\n  var _React$useContext = React.useContext(ConfigContext),\n      getPrefixCls = _React$useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('scroll-number', customizePrefixCls); // ============================ Render ============================\n\n  var newProps = _extends(_extends({}, restProps), {\n    'data-show': show,\n    style: style,\n    className: classNames(prefixCls, className, motionClassName),\n    title: title\n  }); // Only integer need motion\n\n\n  var numberNodes = count;\n\n  if (count && Number(count) % 1 === 0) {\n    var numberList = String(count).split('');\n    numberNodes = numberList.map(function (num, i) {\n      return /*#__PURE__*/React.createElement(SingleNumber, {\n        prefixCls: prefixCls,\n        count: Number(count),\n        value: num // eslint-disable-next-line react/no-array-index-key\n        ,\n        key: numberList.length - i\n      });\n    });\n  } // allow specify the border\n  // mock border-color by box-shadow for compatible with old usage:\n  // <Badge count={4} style={{ backgroundColor: '#fff', color: '#999', borderColor: '#d9d9d9' }} />\n\n\n  if (style && style.borderColor) {\n    newProps.style = _extends(_extends({}, style), {\n      boxShadow: \"0 0 0 1px \".concat(style.borderColor, \" inset\")\n    });\n  }\n\n  if (children) {\n    return cloneElement(children, function (oriProps) {\n      return {\n        className: classNames(\"\".concat(prefixCls, \"-custom-component\"), oriProps === null || oriProps === void 0 ? void 0 : oriProps.className, motionClassName)\n      };\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(component, newProps, numberNodes);\n};\n\nexport default ScrollNumber;","import { PresetColorTypes } from '../_util/colors'; // eslint-disable-next-line import/prefer-default-export\n\nexport function isPresetColor(color) {\n  return PresetColorTypes.indexOf(color) !== -1;\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport { ConfigContext } from '../config-provider';\nimport { isPresetColor } from './utils';\n\nvar Ribbon = function Ribbon(_ref) {\n  var _classNames;\n\n  var className = _ref.className,\n      customizePrefixCls = _ref.prefixCls,\n      style = _ref.style,\n      color = _ref.color,\n      children = _ref.children,\n      text = _ref.text,\n      _ref$placement = _ref.placement,\n      placement = _ref$placement === void 0 ? 'end' : _ref$placement;\n\n  var _React$useContext = React.useContext(ConfigContext),\n      getPrefixCls = _React$useContext.getPrefixCls,\n      direction = _React$useContext.direction;\n\n  var prefixCls = getPrefixCls('ribbon', customizePrefixCls);\n  var colorInPreset = isPresetColor(color);\n  var ribbonCls = classNames(prefixCls, \"\".concat(prefixCls, \"-placement-\").concat(placement), (_classNames = {}, _defineProperty(_classNames, \"\".concat(prefixCls, \"-rtl\"), direction === 'rtl'), _defineProperty(_classNames, \"\".concat(prefixCls, \"-color-\").concat(color), colorInPreset), _classNames), className);\n  var colorStyle = {};\n  var cornerColorStyle = {};\n\n  if (color && !colorInPreset) {\n    colorStyle.background = color;\n    cornerColorStyle.color = color;\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-wrapper\")\n  }, children, /*#__PURE__*/React.createElement(\"div\", {\n    className: ribbonCls,\n    style: _extends(_extends({}, colorStyle), style)\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"\".concat(prefixCls, \"-text\")\n  }, text), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-corner\"),\n    style: cornerColorStyle\n  })));\n};\n\nexport default Ribbon;","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport * as React from 'react';\nimport { useMemo, useRef } from 'react';\nimport CSSMotion from 'rc-motion';\nimport classNames from 'classnames';\nimport ScrollNumber from './ScrollNumber';\nimport Ribbon from './Ribbon';\nimport { ConfigContext } from '../config-provider';\nimport { cloneElement } from '../_util/reactNode';\nimport { isPresetColor } from './utils';\n\nvar Badge = function Badge(_a) {\n  var _classNames, _classNames2;\n\n  var customizePrefixCls = _a.prefixCls,\n      customizeScrollNumberPrefixCls = _a.scrollNumberPrefixCls,\n      children = _a.children,\n      status = _a.status,\n      text = _a.text,\n      color = _a.color,\n      _a$count = _a.count,\n      count = _a$count === void 0 ? null : _a$count,\n      _a$overflowCount = _a.overflowCount,\n      overflowCount = _a$overflowCount === void 0 ? 99 : _a$overflowCount,\n      _a$dot = _a.dot,\n      dot = _a$dot === void 0 ? false : _a$dot,\n      _a$size = _a.size,\n      size = _a$size === void 0 ? 'default' : _a$size,\n      title = _a.title,\n      offset = _a.offset,\n      style = _a.style,\n      className = _a.className,\n      _a$showZero = _a.showZero,\n      showZero = _a$showZero === void 0 ? false : _a$showZero,\n      restProps = __rest(_a, [\"prefixCls\", \"scrollNumberPrefixCls\", \"children\", \"status\", \"text\", \"color\", \"count\", \"overflowCount\", \"dot\", \"size\", \"title\", \"offset\", \"style\", \"className\", \"showZero\"]);\n\n  var _React$useContext = React.useContext(ConfigContext),\n      getPrefixCls = _React$useContext.getPrefixCls,\n      direction = _React$useContext.direction;\n\n  var prefixCls = getPrefixCls('badge', customizePrefixCls); // ================================ Misc ================================\n\n  var numberedDisplayCount = count > overflowCount ? \"\".concat(overflowCount, \"+\") : count;\n  var hasStatus = status !== null && status !== undefined || color !== null && color !== undefined;\n  var isZero = numberedDisplayCount === '0' || numberedDisplayCount === 0;\n  var showAsDot = dot && !isZero || hasStatus;\n  var mergedCount = showAsDot ? '' : numberedDisplayCount;\n  var isHidden = useMemo(function () {\n    var isEmpty = mergedCount === null || mergedCount === undefined || mergedCount === '';\n    return (isEmpty || isZero && !showZero) && !showAsDot;\n  }, [mergedCount, isZero, showZero, showAsDot]); // Count should be cache in case hidden change it\n\n  var countRef = useRef(count);\n\n  if (!isHidden) {\n    countRef.current = count;\n  }\n\n  var livingCount = countRef.current; // We need cache count since remove motion should not change count display\n\n  var displayCountRef = useRef(mergedCount);\n\n  if (!isHidden) {\n    displayCountRef.current = mergedCount;\n  }\n\n  var displayCount = displayCountRef.current; // We will cache the dot status to avoid shaking on leaved motion\n\n  var isDotRef = useRef(showAsDot);\n\n  if (!isHidden) {\n    isDotRef.current = showAsDot;\n  } // =============================== Styles ===============================\n\n\n  var mergedStyle = useMemo(function () {\n    if (!offset) {\n      return _extends({}, style);\n    }\n\n    var offsetStyle = {\n      marginTop: offset[1]\n    };\n\n    if (direction === 'rtl') {\n      offsetStyle.left = parseInt(offset[0], 10);\n    } else {\n      offsetStyle.right = -parseInt(offset[0], 10);\n    }\n\n    return _extends(_extends({}, offsetStyle), style);\n  }, [direction, offset, style]); // =============================== Render ===============================\n  // >>> Title\n\n  var titleNode = title !== null && title !== void 0 ? title : typeof livingCount === 'string' || typeof livingCount === 'number' ? livingCount : undefined; // >>> Status Text\n\n  var statusTextNode = isHidden || !text ? null : /*#__PURE__*/React.createElement(\"span\", {\n    className: \"\".concat(prefixCls, \"-status-text\")\n  }, text); // >>> Display Component\n\n  var displayNode = !livingCount || _typeof(livingCount) !== 'object' ? undefined : cloneElement(livingCount, function (oriProps) {\n    return {\n      style: _extends(_extends({}, mergedStyle), oriProps.style)\n    };\n  }); // Shared styles\n\n  var statusCls = classNames((_classNames = {}, _defineProperty(_classNames, \"\".concat(prefixCls, \"-status-dot\"), hasStatus), _defineProperty(_classNames, \"\".concat(prefixCls, \"-status-\").concat(status), !!status), _defineProperty(_classNames, \"\".concat(prefixCls, \"-status-\").concat(color), isPresetColor(color)), _classNames));\n  var statusStyle = {};\n\n  if (color && !isPresetColor(color)) {\n    statusStyle.background = color;\n  }\n\n  var badgeClassName = classNames(prefixCls, (_classNames2 = {}, _defineProperty(_classNames2, \"\".concat(prefixCls, \"-status\"), hasStatus), _defineProperty(_classNames2, \"\".concat(prefixCls, \"-not-a-wrapper\"), !children), _defineProperty(_classNames2, \"\".concat(prefixCls, \"-rtl\"), direction === 'rtl'), _classNames2), className); // <Badge status=\"success\" />\n\n  if (!children && hasStatus) {\n    var statusTextColor = mergedStyle.color;\n    return /*#__PURE__*/React.createElement(\"span\", _extends({}, restProps, {\n      className: badgeClassName,\n      style: mergedStyle\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: statusCls,\n      style: statusStyle\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        color: statusTextColor\n      },\n      className: \"\".concat(prefixCls, \"-status-text\")\n    }, text));\n  } // <Badge status=\"success\" count={<Icon type=\"xxx\" />}></Badge>\n\n\n  return /*#__PURE__*/React.createElement(\"span\", _extends({}, restProps, {\n    className: badgeClassName\n  }), children, /*#__PURE__*/React.createElement(CSSMotion, {\n    visible: !isHidden,\n    motionName: \"\".concat(prefixCls, \"-zoom\"),\n    motionAppear: false\n  }, function (_ref) {\n    var _classNames3;\n\n    var motionClassName = _ref.className;\n    var scrollNumberPrefixCls = getPrefixCls('scroll-number', customizeScrollNumberPrefixCls);\n    var isDot = isDotRef.current;\n    var scrollNumberCls = classNames((_classNames3 = {}, _defineProperty(_classNames3, \"\".concat(prefixCls, \"-dot\"), isDot), _defineProperty(_classNames3, \"\".concat(prefixCls, \"-count\"), !isDot), _defineProperty(_classNames3, \"\".concat(prefixCls, \"-count-sm\"), size === 'small'), _defineProperty(_classNames3, \"\".concat(prefixCls, \"-multiple-words\"), !isDot && displayCount && displayCount.toString().length > 1), _defineProperty(_classNames3, \"\".concat(prefixCls, \"-status-\").concat(status), !!status), _defineProperty(_classNames3, \"\".concat(prefixCls, \"-status-\").concat(color), isPresetColor(color)), _classNames3));\n\n    var scrollNumberStyle = _extends({}, mergedStyle);\n\n    if (color && !isPresetColor(color)) {\n      scrollNumberStyle = scrollNumberStyle || {};\n      scrollNumberStyle.background = color;\n    }\n\n    return /*#__PURE__*/React.createElement(ScrollNumber, {\n      prefixCls: scrollNumberPrefixCls,\n      show: !isHidden,\n      motionClassName: motionClassName,\n      className: scrollNumberCls,\n      count: displayCount,\n      title: titleNode,\n      style: scrollNumberStyle,\n      key: \"scrollNumber\"\n    }, displayNode);\n  }), statusTextNode);\n};\n\nBadge.Ribbon = Ribbon;\nexport default Badge;","import { Button, SyncIcon } from '@databricks/design-system';\nimport React, { useCallback, useEffect, useState } from 'react';\n// TODO: de-antd-ify Badge as soon as it appears in the design system\nimport { Theme } from '@emotion/react';\nimport { Badge } from 'antd';\nimport { FormattedMessage } from 'react-intl';\nimport { connect } from 'react-redux';\nimport { MAX_DETECT_NEW_RUNS_RESULTS, POLL_INTERVAL } from '../../../../constants';\nimport { ExperimentStoreEntities } from '../../../../types';\nimport { useExperimentIds } from '../../hooks/useExperimentIds';\nimport { useFetchExperimentRuns } from '../../hooks/useFetchExperimentRuns';\n\nexport interface ExperimentViewRefreshButtonProps {\n  runInfos: ExperimentStoreEntities['runInfosByUuid'];\n}\n\n/**\n * A component that displays \"refresh runs\" button with the relevant number\n * of the new runs and handles the refresh action.\n */\nexport const ExperimentViewRefreshButtonImpl = React.memo(\n  ({ runInfos }: React.PropsWithChildren<ExperimentViewRefreshButtonProps>) => {\n    const {\n      actions: { searchRunsPayload },\n      updateSearchFacets,\n    } = useFetchExperimentRuns();\n\n    const experimentIds = useExperimentIds();\n\n    // Keeps the time of the last runs fetch\n    const [lastFetchTime, setLastFetchTime] = useState(0);\n\n    // Keeps the number of available new runs\n    const [newRunsCount, setNewRunsCount] = useState(0);\n\n    // Refreshes the runs\n    const refreshRuns = useCallback(\n      () =>\n        updateSearchFacets(\n          {},\n          {\n            forceRefresh: true,\n            preservePristine: true,\n          },\n        ),\n      [updateSearchFacets],\n    );\n\n    // We're resetting number of new runs and the fetch date\n    // every time when the runs payload has changed\n    useEffect(() => {\n      setNewRunsCount(0);\n      setLastFetchTime(() => Date.now());\n    }, [runInfos]);\n\n    useEffect(\n      () => {\n        if (!lastFetchTime) {\n          return undefined;\n        }\n        const interval = setInterval(() => {\n          // Let's query for new runs that have started after a certain time\n          const searchPayloadData: any = {\n            experimentIds,\n            filter: `attributes.start_time > ${lastFetchTime}`,\n            // We're not interested in more than 26 new runs\n            maxResults: MAX_DETECT_NEW_RUNS_RESULTS,\n          };\n          searchRunsPayload(searchPayloadData).then((result) => {\n            const newRuns = result.runs?.length || 0;\n            setNewRunsCount(newRuns);\n          });\n        }, POLL_INTERVAL);\n        return () => clearInterval(interval);\n      },\n      // We're resetting the interval each time the reference time or experiment IDs have changed\n      [lastFetchTime, searchRunsPayload, experimentIds],\n    );\n\n    return (\n      <Badge\n        count={newRunsCount}\n        offset={[-5, 5]}\n        css={styles.pill}\n        overflowCount={MAX_DETECT_NEW_RUNS_RESULTS - 1}\n      >\n        <Button onClick={refreshRuns} data-testid='runs-refresh-button' icon={<SyncIcon />}>\n          <FormattedMessage\n            defaultMessage='Refresh'\n            description='refresh button text to refresh the experiment runs'\n          />\n        </Button>\n      </Badge>\n    );\n  },\n);\n\nconst styles = {\n  pill: (theme: Theme) => ({ sup: { backgroundColor: theme.colors.lime, zIndex: 1 } }),\n};\n\n/**\n * The only thing that we're interested in the store is the current set of runInfos.\n * We're going to monitor it so we will know when new runs are fetched.\n */\nconst mapStateToProps = (state: { entities: ExperimentStoreEntities }) => {\n  return { runInfos: state.entities.runInfosByUuid };\n};\n\nexport const ExperimentViewRefreshButton = connect(mapStateToProps, undefined, undefined, {\n  // We're interested only in \"entities\" sub-tree so we won't\n  // re-render on other state changes (e.g. API request IDs)\n  areStatesEqual: (nextState, prevState) => nextState.entities === prevState.entities,\n})(ExperimentViewRefreshButtonImpl);\n","import {\n  Button,\n  ChevronDownIcon,\n  Dropdown,\n  Input,\n  ListIcon,\n  Search1Icon,\n  Tree,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport Utils from '../../../../../common/utils/Utils';\nimport { ATTRIBUTE_COLUMN_LABELS, COLUMN_TYPES } from '../../../../constants';\nimport { UpdateExperimentSearchFacetsFn } from '../../../../types';\nimport { useExperimentIds } from '../../hooks/useExperimentIds';\nimport { useFetchExperimentRuns } from '../../hooks/useFetchExperimentRuns';\nimport { SearchExperimentRunsFacetsState } from '../../models/SearchExperimentRunsFacetsState';\nimport {\n  extractCanonicalSortKey,\n  isCanonicalSortKeyOfType,\n  makeCanonicalSortKey,\n} from '../../utils/experimentPage.column-utils';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\n\n/**\n * We need to recreate antd's tree check callback signature since it's not importable\n */\ntype AntdTreeCheckCallback = { node: { key: string | number; checked: boolean } };\n\n/**\n * Function localizing antd tree inside a DOM element. Used to focusing by keyboard.\n */\nconst locateAntdTree = (parent: HTMLElement | null): HTMLElement | null =>\n  parent?.querySelector('[role=\"tree\"] input') || null;\n\nconst GROUP_KEY = 'GROUP';\n\nconst GROUP_KEY_ATTRIBUTES = makeCanonicalSortKey(GROUP_KEY, COLUMN_TYPES.ATTRIBUTES);\nconst GROUP_KEY_PARAMS = makeCanonicalSortKey(GROUP_KEY, COLUMN_TYPES.PARAMS);\nconst GROUP_KEY_METRICS = makeCanonicalSortKey(GROUP_KEY, COLUMN_TYPES.METRICS);\nconst GROUP_KEY_TAGS = makeCanonicalSortKey(GROUP_KEY, COLUMN_TYPES.TAGS);\n\nconst ATTRIBUTE_COLUMNS = [\n  ATTRIBUTE_COLUMN_LABELS.USER,\n  ATTRIBUTE_COLUMN_LABELS.SOURCE,\n  ATTRIBUTE_COLUMN_LABELS.VERSION,\n  ATTRIBUTE_COLUMN_LABELS.MODELS,\n];\nconst ATTRIBUTE_COLUMNS_COMPARE = [ATTRIBUTE_COLUMN_LABELS.EXPERIMENT_NAME, ...ATTRIBUTE_COLUMNS];\n\n/**\n * Function filters list of string by a given query string.\n */\nconst findMatching = (values: string[], filterQuery: string) =>\n  values.filter((v) => v.toLowerCase().includes(filterQuery.toLowerCase()));\n\n/**\n * Function dissects given string and wraps the\n * searched query with <strong>...</strong> if found. Used for highlighting search.\n */\nconst createHighlightedNode = (value: string, filterQuery: string) => {\n  if (!filterQuery) {\n    return value;\n  }\n  const index = value.toLowerCase().indexOf(filterQuery.toLowerCase());\n  const beforeStr = value.substring(0, index);\n  const matchStr = value.substring(index, index + filterQuery.length);\n  const afterStr = value.substring(index + filterQuery.length);\n\n  return index > -1 ? (\n    <span>\n      {beforeStr}\n      <strong>{matchStr}</strong>\n      {afterStr}\n    </span>\n  ) : (\n    value\n  );\n};\nexport interface ExperimentViewRunsColumnSelectorProps {\n  runsData: ExperimentRunsSelectorResult;\n  columnSelectorVisible: boolean;\n  onChangeColumnSelectorVisible: (value: boolean) => void;\n}\n\n/**\n * A component displaying the searchable column list - implementation.\n */\nexport const ExperimentViewRunsColumnSelectorImpl = React.memo(\n  ({\n    runsData,\n    columnSelectorVisible,\n    onChangeColumnSelectorVisible,\n    updateSearchFacets,\n    selectedColumns,\n  }: ExperimentViewRunsColumnSelectorProps & {\n    updateSearchFacets: UpdateExperimentSearchFacetsFn;\n    selectedColumns: SearchExperimentRunsFacetsState['selectedColumns'];\n  }) => {\n    const experimentIds = useExperimentIds();\n    const [filter, setFilter] = useState('');\n\n    const searchInputRef = useRef<any>(null);\n    const scrollableContainerRef = useRef<HTMLDivElement>(null);\n    const buttonRef = useRef<HTMLButtonElement>(null);\n\n    // Extract all attribute columns\n    const attributeColumnNames = useMemo(\n      () => (experimentIds.length > 1 ? ATTRIBUTE_COLUMNS_COMPARE : ATTRIBUTE_COLUMNS),\n      [experimentIds.length],\n    );\n\n    const setCheckedColumns = useCallback(\n      (updateFn: (existingCheckedColumns: string[]) => string[]) =>\n        updateSearchFacets((facets) => {\n          const newColumns = updateFn(facets.selectedColumns);\n          const uniqueNewColumns = Array.from(new Set(newColumns));\n          return { ...facets, selectedColumns: uniqueNewColumns };\n        }),\n      [updateSearchFacets],\n    );\n\n    // Extract unique list of tags\n    const tagsKeyList = useMemo(() => Utils.getVisibleTagKeyList(runsData.tagsList), [runsData]);\n\n    // Extract canonical key names for attributes, params, metrics and tags.\n    const canonicalKeyNames = useMemo(\n      () => ({\n        [COLUMN_TYPES.ATTRIBUTES]: attributeColumnNames.map((key) =>\n          makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, key),\n        ),\n        [COLUMN_TYPES.PARAMS]: runsData.paramKeyList.map((key) =>\n          makeCanonicalSortKey(COLUMN_TYPES.PARAMS, key),\n        ),\n        [COLUMN_TYPES.METRICS]: runsData.metricKeyList.map((key) =>\n          makeCanonicalSortKey(COLUMN_TYPES.METRICS, key),\n        ),\n        [COLUMN_TYPES.TAGS]: tagsKeyList.map((key) => makeCanonicalSortKey(COLUMN_TYPES.TAGS, key)),\n      }),\n      [runsData, attributeColumnNames, tagsKeyList],\n    );\n\n    // This memoized value holds the tree structure generated from\n    // attributes, params, metrics and tags. Displays only filtered values.\n    const treeData = useMemo(() => {\n      const result = [];\n\n      const filteredAttributes = findMatching(attributeColumnNames, filter);\n      const filteredParams = findMatching(runsData.paramKeyList, filter);\n      const filteredMetrics = findMatching(runsData.metricKeyList, filter);\n      const filteredTags = findMatching(tagsKeyList, filter);\n\n      if (filteredAttributes.length) {\n        result.push({\n          key: GROUP_KEY_ATTRIBUTES,\n          title: `Attributes`,\n          children: filteredAttributes.map((attributeKey) => ({\n            key: makeCanonicalSortKey(COLUMN_TYPES.ATTRIBUTES, attributeKey),\n            title: createHighlightedNode(attributeKey, filter),\n          })),\n        });\n      }\n      if (filteredMetrics.length) {\n        result.push({\n          key: GROUP_KEY_METRICS,\n          title: `Metrics (${filteredMetrics.length})`,\n          children: filteredMetrics.map((metricKey) => ({\n            key: makeCanonicalSortKey(COLUMN_TYPES.METRICS, metricKey),\n            title: createHighlightedNode(metricKey, filter),\n          })),\n        });\n      }\n      if (filteredParams.length) {\n        result.push({\n          key: GROUP_KEY_PARAMS,\n          title: `Parameters (${filteredParams.length})`,\n          children: filteredParams.map((paramKey) => ({\n            key: makeCanonicalSortKey(COLUMN_TYPES.PARAMS, paramKey),\n            title: createHighlightedNode(paramKey, filter),\n          })),\n        });\n      }\n      if (filteredTags.length) {\n        result.push({\n          key: GROUP_KEY_TAGS,\n          title: `Tags (${filteredTags.length})`,\n          children: filteredTags.map((tagKey) => ({\n            key: makeCanonicalSortKey(COLUMN_TYPES.TAGS, tagKey),\n            title: tagKey,\n          })),\n        });\n      }\n\n      return result;\n    }, [attributeColumnNames, filter, runsData, tagsKeyList]);\n\n    // This callback toggles entire group of keys\n    const toggleGroup = useCallback(\n      (isChecked: boolean, keyList: string[]) => {\n        if (!isChecked) {\n          setCheckedColumns((checked) => [...checked, ...keyList]);\n        } else {\n          setCheckedColumns((checked) => checked.filter((k) => !keyList.includes(k)));\n        }\n      },\n      [setCheckedColumns],\n    );\n\n    // This callback is intended to select/deselect a single key\n    const toggleSingleKey = useCallback(\n      (key: string, isChecked: boolean) => {\n        if (!isChecked) {\n          setCheckedColumns((checked) => [...checked, key]);\n        } else {\n          setCheckedColumns((checked) => checked.filter((k) => k !== key));\n        }\n      },\n      [setCheckedColumns],\n    );\n\n    useEffect(() => {\n      if (columnSelectorVisible) {\n        setFilter('');\n\n        // Let's wait for the next execution frame, then:\n        // - restore the dropdown menu scroll position\n        // - focus the search input\n        // - bring the dropdown into the viewport using scrollIntoView()\n        requestAnimationFrame(() => {\n          scrollableContainerRef?.current?.scrollTo(0, 0);\n          searchInputRef.current?.focus({ preventScroll: true });\n\n          if (buttonRef.current) {\n            buttonRef.current.scrollIntoView({ block: 'nearest', behavior: 'smooth' });\n          }\n        });\n      }\n    }, [columnSelectorVisible]);\n\n    const onCheck = useCallback(\n      // We need to recreate antd's tree check callback signature\n      (_: any, { node: { key, checked } }: AntdTreeCheckCallback) => {\n        if (isCanonicalSortKeyOfType(key.toString(), GROUP_KEY)) {\n          const columnType = extractCanonicalSortKey(key.toString(), GROUP_KEY);\n          const canonicalKeysForGroup = canonicalKeyNames[columnType];\n          if (canonicalKeysForGroup) {\n            toggleGroup(checked, findMatching(canonicalKeysForGroup, filter));\n          }\n        } else {\n          toggleSingleKey(key.toString(), checked);\n        }\n      },\n      [canonicalKeyNames, toggleGroup, toggleSingleKey, filter],\n    );\n\n    // This callback moves focus to tree element if down arrow has been pressed\n    // when inside search input area.\n    const searchInputKeyDown = useCallback<React.KeyboardEventHandler<HTMLInputElement>>((e) => {\n      if (e.key === 'ArrowDown') {\n        const treeElement = locateAntdTree(scrollableContainerRef.current);\n\n        if (treeElement) {\n          treeElement.focus();\n        }\n      }\n    }, []);\n\n    // A JSX block containing the dropdown\n    const dropdownContent = (\n      <div css={styles.dropdown}>\n        <div css={(theme) => ({ padding: theme.spacing.md })}>\n          <Input\n            value={filter}\n            prefix={<Search1Icon />}\n            placeholder='Search columns'\n            allowClear\n            ref={searchInputRef}\n            onChange={(e) => {\n              setFilter(e.target.value);\n            }}\n            onKeyDown={searchInputKeyDown}\n          />\n        </div>\n        <div ref={scrollableContainerRef} css={styles.scrollableContainer}>\n          <Tree\n            data-testid='column-selector-tree'\n            mode='checkable'\n            dangerouslySetAntdProps={{\n              checkedKeys: selectedColumns,\n              onCheck,\n            }}\n            defaultExpandedKeys={[\n              GROUP_KEY_ATTRIBUTES,\n              GROUP_KEY_PARAMS,\n              GROUP_KEY_METRICS,\n              GROUP_KEY_TAGS,\n            ]}\n            treeData={treeData}\n          />\n        </div>\n      </div>\n    );\n\n    return (\n      <Dropdown\n        overlay={dropdownContent}\n        placement='bottomRight'\n        trigger={['click']}\n        visible={columnSelectorVisible}\n        onVisibleChange={onChangeColumnSelectorVisible}\n      >\n        <Button\n          ref={buttonRef}\n          style={{ display: 'flex', alignItems: 'center' }}\n          data-testid='column-selection-dropdown'\n          icon={<ListIcon />}\n        >\n          <FormattedMessage\n            defaultMessage='Columns'\n            description='Dropdown text to display columns names that could to be rendered for the experiment runs table'\n          />{' '}\n          <ChevronDownIcon />\n        </Button>\n      </Dropdown>\n    );\n  },\n);\n\n/**\n * A component displaying the searchable column list.\n * This is a thin layer wrapping the implementation to optimize search state rerenders.\n */\nexport const ExperimentViewRunsColumnSelector = (props: ExperimentViewRunsColumnSelectorProps) => {\n  const { updateSearchFacets, searchFacetsState } = useFetchExperimentRuns();\n  return (\n    <ExperimentViewRunsColumnSelectorImpl\n      {...props}\n      selectedColumns={searchFacetsState.selectedColumns}\n      updateSearchFacets={updateSearchFacets}\n    />\n  );\n};\n\nconst styles = {\n  dropdown: (theme: Theme) => ({\n    backgroundColor: theme.colors.white,\n    width: 400,\n    border: `1px solid`,\n    borderColor: theme.colors.border,\n  }),\n  scrollableContainer: (theme: Theme) => ({\n    // Maximum height of 15 elements times 32 pixels as defined in\n    // design-system/src/design-system/Tree/Tree.tsx\n    maxHeight: 15 * 32,\n    overflowY: 'scroll' as const,\n    overflowX: 'hidden' as const,\n    paddingBottom: theme.spacing.md,\n    'span[title]': {\n      whiteSpace: 'nowrap' as const,\n      textOverflow: 'ellipsis',\n      overflow: 'hidden',\n    },\n  }),\n};\n","import {\n  ArrowDownIcon,\n  ArrowUpIcon,\n  Button,\n  CloseIcon,\n  DownloadIcon,\n  Dropdown,\n  InfoBorderIcon,\n  Input,\n  Menu,\n  Option,\n  OverflowIcon,\n  Search1Icon,\n  Select,\n  SortAscendingIcon,\n  SortDescendingIcon,\n  Tooltip,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { ExperimentSearchSyntaxDocUrl } from '../../../../../common/constants';\nimport { middleTruncateStr } from '../../../../../common/utils/StringUtils';\nimport {\n  COLUMN_SORT_BY_ASC,\n  COLUMN_SORT_BY_DESC,\n  SORT_DELIMITER_SYMBOL,\n} from '../../../../constants';\nimport { UpdateExperimentSearchFacetsFn, UpdateExperimentViewStateFn } from '../../../../types';\nimport { ExperimentRunSortOption } from '../../hooks/useRunSortOptions';\nimport { SearchExperimentRunsFacetsState } from '../../models/SearchExperimentRunsFacetsState';\nimport { SearchExperimentRunsViewState } from '../../models/SearchExperimentRunsViewState';\nimport { TAGS_TO_COLUMNS_MAP } from '../../utils/experimentPage.column-utils';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { ExperimentViewRefreshButton } from './ExperimentViewRefreshButton';\nimport { ExperimentViewRunsColumnSelector } from './ExperimentViewRunsColumnSelector';\nimport { shouldUseNextRunsComparisonUI } from '../../../../../common/utils/FeatureUtils';\nimport { ExperimentViewRunsModeSwitch } from './ExperimentViewRunsModeSwitch';\n\n// A default placeholder for the search box\nconst SEARCH_BOX_PLACEHOLDER = 'metrics.rmse < 1 and params.model = \"tree\"';\n\nexport type ExperimentViewRunsControlsFiltersProps = {\n  searchFacetsState: SearchExperimentRunsFacetsState;\n  updateSearchFacets: UpdateExperimentSearchFacetsFn;\n  viewState: SearchExperimentRunsViewState;\n  updateViewState: UpdateExperimentViewStateFn;\n  sortOptions: ExperimentRunSortOption[];\n  runsData: ExperimentRunsSelectorResult;\n  onDownloadCsv: () => void;\n};\n\nexport const ExperimentViewRunsControlsFilters = React.memo(\n  ({\n    searchFacetsState,\n    updateSearchFacets,\n    runsData,\n    viewState,\n    updateViewState,\n    onDownloadCsv,\n    sortOptions,\n  }: ExperimentViewRunsControlsFiltersProps) => {\n    const { orderByKey, orderByAsc, isComparingRuns } = searchFacetsState;\n\n    const [searchFilterValue, setSearchFilterValue] = useState<string>();\n\n    // Callback fired when the sort column value changes\n    const sortKeyChanged = useCallback(\n      ({ value: compiledOrderByKey }) => {\n        const [newOrderBy, newOrderAscending] = compiledOrderByKey.split(SORT_DELIMITER_SYMBOL);\n\n        const columnToAdd = TAGS_TO_COLUMNS_MAP[newOrderBy] || newOrderBy;\n        const isOrderAscending = newOrderAscending === COLUMN_SORT_BY_ASC;\n\n        updateSearchFacets((currentFacets) => {\n          const { selectedColumns } = currentFacets;\n          if (!selectedColumns.includes(columnToAdd)) {\n            selectedColumns.push(columnToAdd);\n          }\n          return {\n            ...currentFacets,\n            selectedColumns,\n            orderByKey: newOrderBy,\n            orderByAsc: isOrderAscending,\n          };\n        });\n      },\n      [updateSearchFacets],\n    );\n\n    // Callback fired when search filter is being used\n    const triggerSearch: React.KeyboardEventHandler<HTMLInputElement> = (e) => {\n      if (e.key === 'Enter') {\n        updateSearchFacets({ searchFilter: searchFilterValue });\n      }\n    };\n\n    // Each time we're setting search filter externally, update it here as well\n    useEffect(() => {\n      setSearchFilterValue(searchFacetsState.searchFilter);\n    }, [searchFacetsState]);\n\n    // Callback fired when \"clear\" button is clicked\n    const clearFacetsState = useCallback(() => {\n      const cleanSearchFacetsState = new SearchExperimentRunsFacetsState();\n      const { selectedColumns, runsExpanded, runsPinned } = searchFacetsState;\n      updateSearchFacets(\n        Object.assign(cleanSearchFacetsState, {\n          runsExpanded,\n          runsPinned,\n          selectedColumns,\n        }),\n      );\n    }, [searchFacetsState, updateSearchFacets]);\n\n    // Shows or hides the column selector\n    const changeColumnSelectorVisible = useCallback(\n      (value: boolean) => updateViewState({ columnSelectorVisible: value }),\n      [updateViewState],\n    );\n\n    // Currently used canonical \"sort by\" value in form of \"COLUMN_NAME***DIRECTION\", e.g. \"metrics.`metric`***DESCENDING\"\n    const currentSortSelectValue = useMemo(\n      () =>\n        `${orderByKey}${SORT_DELIMITER_SYMBOL}${\n          orderByAsc ? COLUMN_SORT_BY_ASC : COLUMN_SORT_BY_DESC\n        }`,\n      [orderByAsc, orderByKey],\n    );\n\n    /**\n     * Calculate and memoize a label displayed in the \"sort by\" select.\n     *\n     * If full metrics and params list is populated by runs from the API, use the\n     * value corresponding to the calculated sort option list.\n     *\n     * If the sort option list is incomplete (e.g. because fetched run set is empty) while the\n     * order key is given (e.g. because URL state says so), use it to extract the key name.\n     */\n    const currentSortSelectLabel = useMemo(() => {\n      // Search through all sort options generated basing on the fetched runs\n      const sortOption = sortOptions.find((option) => option.value === currentSortSelectValue);\n\n      let sortOptionLabel = sortOption?.label;\n\n      // If the actually chosen sort value is not found in the sort option list (e.g. because the list of fetched runs is empty),\n      // use it to generate the label\n      if (!sortOptionLabel) {\n        // The following regex extracts plain sort key name from its canonical form, i.e.\n        // metrics.`metric_key_name` => metric_key_name\n        const extractedKeyName = orderByKey.match(/^.+\\.`(.+)`$/);\n        if (extractedKeyName) {\n          // eslint-disable-next-line prefer-destructuring\n          sortOptionLabel = extractedKeyName[1];\n        }\n      }\n\n      return (\n        <span css={{ display: 'flex', alignItems: 'center', gap: 4 }}>\n          {orderByAsc ? <SortAscendingIcon /> : <SortDescendingIcon />}{' '}\n          <FormattedMessage\n            defaultMessage='Sort'\n            description='Sort by default option for sort by select dropdown for experiment runs'\n          />\n          : {sortOptionLabel}\n        </span>\n      );\n    }, [currentSortSelectValue, orderByAsc, orderByKey, sortOptions]);\n\n    return (\n      <>\n        <div css={styles.groupBar}>\n          <div css={styles.controlBar}>\n            {shouldUseNextRunsComparisonUI() && (\n              <ExperimentViewRunsModeSwitch\n                isComparingRuns={isComparingRuns}\n                setIsComparingRuns={(newIsComparingRuns) =>\n                  updateSearchFacets({ isComparingRuns: newIsComparingRuns })\n                }\n              />\n            )}\n            <div css={styles.searchBox}>\n              <Input\n                value={searchFilterValue}\n                prefix={<Search1Icon css={styles.searchBarIcon} />}\n                onKeyDown={triggerSearch}\n                onChange={(e) => setSearchFilterValue(e.target.value)}\n                placeholder={SEARCH_BOX_PLACEHOLDER}\n                data-test-id='search-box'\n                suffix={\n                  <div css={styles.searchInputSuffix}>\n                    {searchFilterValue && (\n                      <Button onClick={clearFacetsState} type='link' data-test-id='clear-button'>\n                        <CloseIcon />\n                      </Button>\n                    )}\n                    <Tooltip\n                      title={\n                        <div className='search-input-tooltip-content'>\n                          <FormattedMessage\n                            defaultMessage='Search runs using a simplified version of the SQL {whereBold} clause.'\n                            description='Tooltip string to explain how to search runs from the experiments table'\n                            values={{ whereBold: <b>WHERE</b> }}\n                          />{' '}\n                          <FormattedMessage\n                            defaultMessage='<link>Learn more</link>'\n                            description='Learn more tooltip link to learn more on how to search in an experiments run table'\n                            values={{\n                              link: (chunks: any) => (\n                                <a\n                                  href={ExperimentSearchSyntaxDocUrl}\n                                  target='_blank'\n                                  rel='noopener noreferrer'\n                                >\n                                  {chunks}\n                                </a>\n                              ),\n                            }}\n                          />\n                          <br />\n                          <FormattedMessage\n                            defaultMessage='Examples:'\n                            description='Text header for examples of mlflow search syntax'\n                          />\n                          <br />\n                          {'• metrics.rmse >= 0.8'}\n                          <br />\n                          {'• metrics.`f1 score` < 1'}\n                          <br />\n                          {\"• params.model = 'tree'\"}\n                          <br />\n                          {\"• attributes.run_name = 'my run'\"}\n                          <br />\n                          {\"• tags.`mlflow.user` = 'myUser'\"}\n                          <br />\n                          {\"• metric.f1_score > 0.9 AND params.model = 'tree'\"}\n                          <br />\n                          {\"• attributes.run_id IN ('a1b2c3d4', 'e5f6g7h8')\"}\n                          <br />\n                          {\"• tags.model_class LIKE 'sklearn.linear_model%'\"}\n                        </div>\n                      }\n                      placement='right'\n                      dangerouslySetAntdProps={{ overlayInnerStyle: { width: '150%' } }}\n                    >\n                      <InfoBorderIcon css={styles.searchBarIcon} />\n                    </Tooltip>\n                  </div>\n                }\n              />\n            </div>\n            <Select\n              className='sort-select'\n              css={styles.sortSelectControl}\n              value={{\n                value: currentSortSelectValue,\n                label: currentSortSelectLabel,\n              }}\n              labelInValue\n              // Temporarily we're disabling virtualized list to maintain\n              // backwards compatiblity. Functional unit tests rely heavily\n              // on non-virtualized values.\n              dangerouslySetAntdProps={\n                { virtual: false, dropdownStyle: styles.sortSelectDropdown } as any\n              }\n              onChange={sortKeyChanged}\n              data-test-id='sort-select-dropdown'\n            >\n              {sortOptions.map((sortOption) => (\n                <Option\n                  key={sortOption.value}\n                  title={sortOption.label}\n                  data-test-id={`sort-select-${sortOption.label}-${sortOption.order}`}\n                  value={sortOption.value}\n                >\n                  <span css={styles.sortMenuArrowWrapper}>\n                    {sortOption.order === COLUMN_SORT_BY_ASC ? <ArrowUpIcon /> : <ArrowDownIcon />}\n                  </span>{' '}\n                  {middleTruncateStr(sortOption.label, 50)}\n                </Option>\n              ))}\n            </Select>\n\n            {!isComparingRuns && (\n              <ExperimentViewRunsColumnSelector\n                columnSelectorVisible={viewState.columnSelectorVisible}\n                onChangeColumnSelectorVisible={changeColumnSelectorVisible}\n                runsData={runsData}\n              />\n            )}\n          </div>\n          <div css={styles.groupSeparator} />\n          <div css={styles.controlBar}>\n            <Dropdown\n              trigger={['click']}\n              placement='bottomRight'\n              overlay={\n                <Menu>\n                  <Menu.Item className='csv-button' onClick={onDownloadCsv}>\n                    <DownloadIcon />{' '}\n                    <FormattedMessage\n                      defaultMessage='Download CSV'\n                      description='String for the download csv button to download experiments offline in a CSV format'\n                    />\n                  </Menu.Item>\n                </Menu>\n              }\n            >\n              <Button type='tertiary' icon={<OverflowIcon />} />\n            </Dropdown>\n            <ExperimentViewRefreshButton />\n          </div>\n        </div>\n      </>\n    );\n  },\n);\n\nconst styles = {\n  groupBar: { display: 'grid', gridTemplateColumns: 'auto 1fr auto' },\n  controlBar: (theme: Theme) => ({\n    display: 'flex',\n    gap: theme.spacing.sm,\n    alignItems: 'center',\n    flexWrap: 'wrap' as const,\n  }),\n  searchBarIcon: (theme: Theme) => ({\n    svg: { width: 16, height: 16, color: theme.colors.textSecondary },\n  }),\n  groupSeparator: (theme: Theme) => ({ minWidth: theme.spacing.sm }),\n  searchInputSuffix: { display: 'flex', gap: 4, alignItems: 'center' },\n  columnSwitch: { margin: '5px' },\n  searchBox: (theme: Theme) => ({ display: 'flex', gap: theme.spacing.sm, width: 560 }),\n  sortSelectControl: { minWidth: 140, maxWidth: 360 },\n\n  lifecycleFilters: (theme: Theme) => ({\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n    marginTop: theme.spacing.sm,\n    marginBottom: theme.spacing.sm,\n    marginLeft: theme.spacing.lg * 2,\n  }),\n  sortSelectDropdown: { minWidth: 360 },\n  sortMenuArrowWrapper: { svg: { width: 12, height: 12 } },\n};\n","/**\n * This file aggregates utility functions for enabling features configured by flags.\n * In the OSS version, you can override them in local development by manually changing the return values.\n */\n/**\n * UI feature preview: new (\"next\") version of runs comparison view within experiment runs table.\n */\nexport const shouldUseNextRunsComparisonUI = () => false;\n","import { Theme } from '@emotion/react';\nimport React, { useCallback } from 'react';\nimport Utils from '../../../../../common/utils/Utils';\nimport { UpdateExperimentSearchFacetsFn, UpdateExperimentViewStateFn } from '../../../../types';\nimport { useRunSortOptions } from '../../hooks/useRunSortOptions';\nimport { SearchExperimentRunsFacetsState } from '../../models/SearchExperimentRunsFacetsState';\nimport { SearchExperimentRunsViewState } from '../../models/SearchExperimentRunsViewState';\nimport { downloadRunsCsv } from '../../utils/experimentPage.common-utils';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { ExperimentViewRunsControlsActions } from './ExperimentViewRunsControlsActions';\nimport { ExperimentViewRunsControlsFilters } from './ExperimentViewRunsControlsFilters';\n\ntype ExperimentViewRunsControlsProps = {\n  viewState: SearchExperimentRunsViewState;\n  updateViewState: UpdateExperimentViewStateFn;\n\n  searchFacetsState: SearchExperimentRunsFacetsState;\n  updateSearchFacets: UpdateExperimentSearchFacetsFn;\n\n  runsData: ExperimentRunsSelectorResult;\n\n  visibleRowsCount: number;\n};\n\n/**\n * This component houses all controls related to searching runs: sort controls,\n * filters and run related actions (delete, restore, download CSV).\n */\nexport const ExperimentViewRunsControls = React.memo(\n  ({\n    runsData,\n    viewState,\n    updateViewState,\n    updateSearchFacets,\n    searchFacetsState,\n    visibleRowsCount,\n  }: ExperimentViewRunsControlsProps) => {\n    const { paramKeyList, metricKeyList, tagsList } = runsData;\n\n    const filteredParamKeys = paramKeyList;\n    const filteredMetricKeys = metricKeyList;\n    const filteredTagKeys = Utils.getVisibleTagKeyList(tagsList);\n\n    const onDownloadCsv = useCallback(\n      () => downloadRunsCsv(runsData, filteredTagKeys, filteredParamKeys, filteredMetricKeys),\n      [filteredMetricKeys, filteredParamKeys, filteredTagKeys, runsData],\n    );\n\n    const sortOptions = useRunSortOptions(filteredMetricKeys, filteredParamKeys);\n\n    return (\n      <div css={styles.wrapper}>\n        <ExperimentViewRunsControlsFilters\n          onDownloadCsv={onDownloadCsv}\n          updateSearchFacets={updateSearchFacets}\n          searchFacetsState={searchFacetsState}\n          viewState={viewState}\n          updateViewState={updateViewState}\n          sortOptions={sortOptions}\n          runsData={runsData}\n        />\n        <ExperimentViewRunsControlsActions\n          runsData={runsData}\n          updateSearchFacets={updateSearchFacets}\n          searchFacetsState={searchFacetsState}\n          viewState={viewState}\n          visibleRowsCount={visibleRowsCount}\n        />\n      </div>\n    );\n  },\n);\n\nconst styles = {\n  wrapper: (theme: Theme) => ({\n    display: 'flex',\n    gap: theme.spacing.sm,\n    flexDirection: 'column' as const,\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.sm,\n  }),\n};\n","import { useMemo } from 'react';\nimport {\n  ATTRIBUTE_COLUMN_SORT_KEY,\n  ATTRIBUTE_COLUMN_SORT_LABEL,\n  COLUMN_SORT_BY_ASC,\n  COLUMN_SORT_BY_DESC,\n  COLUMN_TYPES,\n  SORT_DELIMITER_SYMBOL,\n} from '../../../constants';\nimport { makeCanonicalSortKey } from '../utils/experimentPage.column-utils';\n\nexport type ExperimentRunSortOption = {\n  label: string;\n  order: string;\n  value: string;\n};\n\ntype SORT_KEY_TYPE = keyof (typeof ATTRIBUTE_COLUMN_SORT_KEY & typeof ATTRIBUTE_COLUMN_SORT_LABEL);\n\n/**\n * This hook creates a set of run+sort options basing on currently selected\n * columns and the list of all metrics and keys.\n */\nexport const useRunSortOptions = (\n  filteredMetricKeys: string[],\n  filteredParamKeys: string[],\n): ExperimentRunSortOption[] =>\n  useMemo(() => {\n    let sortOptions = [];\n    const ColumnSortByOrder = [COLUMN_SORT_BY_ASC, COLUMN_SORT_BY_DESC];\n    const attributesSortBy = Object.keys(ATTRIBUTE_COLUMN_SORT_LABEL).reduce<any[]>(\n      (options, sortLabelKey) => {\n        const sortLabel = ATTRIBUTE_COLUMN_SORT_LABEL[sortLabelKey as SORT_KEY_TYPE];\n\n        ColumnSortByOrder.forEach((order) => {\n          options.push({\n            label: sortLabel,\n            value:\n              ATTRIBUTE_COLUMN_SORT_KEY[sortLabelKey as SORT_KEY_TYPE] +\n              SORT_DELIMITER_SYMBOL +\n              order,\n            order,\n          });\n        });\n\n        return options;\n      },\n      [],\n    );\n    const metricsSortBy = filteredMetricKeys.reduce<any[]>((options, sortLabelKey) => {\n      ColumnSortByOrder.forEach((order) => {\n        options.push({\n          label: sortLabelKey,\n          value: `${makeCanonicalSortKey(\n            COLUMN_TYPES.METRICS,\n            sortLabelKey,\n          )}${SORT_DELIMITER_SYMBOL}${order}`,\n          order,\n        });\n      });\n\n      return options;\n    }, []);\n    const paramsSortBy = filteredParamKeys.reduce<any[]>((options, sortLabelKey) => {\n      ColumnSortByOrder.forEach((order) => {\n        options.push({\n          label: sortLabelKey,\n          value: `${makeCanonicalSortKey(\n            COLUMN_TYPES.PARAMS,\n            sortLabelKey,\n          )}${SORT_DELIMITER_SYMBOL}${order}`,\n          order,\n        });\n      });\n\n      return options;\n    }, []);\n    sortOptions = [...attributesSortBy, ...metricsSortBy, ...paramsSortBy];\n\n    return sortOptions;\n  }, [filteredMetricKeys, filteredParamKeys]);\n","import type { AgGridReactProps, AgReactUiProps } from '@ag-grid-community/react';\nimport { Spinner } from '@databricks/design-system';\nimport React from 'react';\n\nconst MLFlowAgGridImpl = React.lazy(() => import('./AgGrid'));\n\n/**\n * A simple loader that will lazily load MLFlow's ag grid implementation.\n * Extracted to a separate module for testing purposes.\n */\nexport const MLFlowAgGridLoader = (props: AgGridReactProps | AgReactUiProps) => (\n  <React.Suspense\n    fallback={\n      <div\n        css={(cssTheme) => ({\n          display: 'flex',\n          justifyContent: 'center',\n          margin: cssTheme.spacing.md,\n        })}\n      >\n        <Spinner />\n      </div>\n    }\n  >\n    <MLFlowAgGridImpl {...props} />\n  </React.Suspense>\n);\n","import React, { Component } from 'react';\nimport { LoggingRunsDocUrl } from '../constants';\nimport { FormattedMessage } from 'react-intl';\n\n/**\n * Display a helper overlay to on board new users on MLflow when the experiments runs table is\n * empty.\n */\nexport class ExperimentRunsTableEmptyOverlay extends Component {\n  getLearnMoreLinkUrl = () => LoggingRunsDocUrl;\n\n  render() {\n    const learnMoreLinkUrl = this.getLearnMoreLinkUrl();\n    return (\n      <div className='experiment-runs-table-empty-overlay' css={classNames.wrapper}>\n        <span>\n          <FormattedMessage\n            // eslint-disable-next-line max-len\n            defaultMessage='No runs yet. <link>Learn more</link> about how to create ML model training {newLine} runs in this experiment.'\n            // eslint-disable-next-line max-len\n            description='Empty state text for experiment runs page'\n            values={{\n              link: (chunks) => (\n                // Reported during ESLint upgrade\n                // eslint-disable-next-line react/jsx-no-target-blank\n                <a target='_blank' href={learnMoreLinkUrl}>\n                  {chunks}\n                </a>\n              ),\n              newLine: <br />,\n            }}\n          />\n        </span>\n      </div>\n    );\n  }\n}\n\nconst classNames = {\n  wrapper: {\n    position: 'relative',\n    top: '10px',\n    fontSize: '13px',\n    padding: '30px',\n    width: '100 %',\n    pointerEvents: 'all',\n  },\n};\n","import { Button, PlusCircleBorderIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { useCallback, useEffect, useRef } from 'react';\nimport { FormattedMessage } from 'react-intl';\n\n/**\n * Width of the CTA column\n */\nconst COLUMN_CTA_WIDTH = 180;\n\n/**\n * CSS classes used internally\n */\nconst CLASS_OUT_OF_VIEWPORT = 'is-out-of-viewport';\nconst CLASS_IS_HIDDEN = 'is-hidden';\nconst CLASS_IS_MINIMIZED = 'is-minimized';\n\n/**\n * List all necessary agGrid sub-element classes\n */\nconst AG_GRID_CLS = {\n  ROOT: '.ag-root',\n  LEFT_COLS_CONTAINER: '.ag-pinned-left-cols-container',\n  COLS_CONTAINER: '.ag-center-cols-container',\n  HEADER: '.ag-header',\n};\n\ninterface ExperimentViewRunsTableAddColumnCTAProps {\n  onClick: () => void;\n  gridContainerElement: HTMLElement | null;\n  isInitialized: boolean;\n  visible?: boolean;\n  moreAvailableParamsAndMetricsColumnCount?: number;\n}\n\n/**\n * Component displaying dynamic table column with \"add metrics and parameters\" CTA.\n *\n * Sample usage:\n *\n * const [gridInitialized, setGridInitialized] = useState(false);\n *\n * return (\n *   <div ref={containerElement}>\n *     <AgGrid onGridReady={() => setGridInitialized(true)} {...} />\n *     <ExperimentViewRunsTableAddColumnCTA\n *       gridContainerElement={containerElement.current}\n *       isInitialized={gridInitialized}\n *       onAddColumnClicked={onAddColumnClicked}\n *       visible={!isLoading}\n *       moreAvailableParamsAndMetricsColumnCount={3}\n *     />\n *   </div>\n * );\n */\nexport const ExperimentViewRunsTableAddColumnCTA = ({\n  onClick,\n  gridContainerElement,\n  isInitialized,\n  visible,\n  moreAvailableParamsAndMetricsColumnCount = 0,\n}: ExperimentViewRunsTableAddColumnCTAProps) => {\n  const ctaRef = useRef<HTMLDivElement>(null);\n\n  const savedContainerRef = useRef<HTMLElement>();\n\n  const initialize = useCallback((containerElement: HTMLElement) => {\n    if (!ctaRef.current || !window.ResizeObserver || !containerElement) {\n      return undefined;\n    }\n\n    const targetElement = ctaRef.current;\n\n    /**\n     * On initialization, first gather all the agGrid sub-elements\n     */\n    const rootElement = containerElement.querySelector(AG_GRID_CLS.ROOT);\n    const refLeftElem = containerElement.querySelector(AG_GRID_CLS.LEFT_COLS_CONTAINER);\n    const refCenterElem = containerElement.querySelector(AG_GRID_CLS.COLS_CONTAINER);\n    const refHeaderElem = containerElement.querySelector(AG_GRID_CLS.HEADER);\n\n    /**\n     * Initialize variables used for position calculation\n     */\n    let gridAreaWidth = 0;\n    let leftColContainerWidth = 0;\n    let centerColContainerWidth = 0;\n    let colContainerHeight = 0;\n    let headerHeight = 0;\n\n    /**\n     * Execute only if all elements are in place\n     */\n    if (refLeftElem && refCenterElem && refHeaderElem && rootElement) {\n      /**\n       * Hook up an resize observer\n       */\n      const resizeObserver = new ResizeObserver((entries) => {\n        /**\n         * For every changed element, gather the exact dimensions\n         */\n        for (const entry of entries) {\n          if (entry.target === rootElement) {\n            gridAreaWidth = entry.contentRect.width;\n          }\n          if (entry.target === refLeftElem) {\n            leftColContainerWidth = entry.contentRect.width;\n            colContainerHeight = entry.contentRect.height;\n          }\n          if (entry.target === refHeaderElem) {\n            headerHeight = entry.contentRect.height;\n          }\n          if (entry.target === refCenterElem) {\n            centerColContainerWidth = entry.contentRect.width;\n          }\n        }\n\n        /**\n         * Our \"left\" position will be offset by column container widths\n         */\n        const calculatedLeft = leftColContainerWidth + centerColContainerWidth;\n\n        /**\n         * Our \"top\"  position will be offset by the header height\n         */\n        const calculatedTop = headerHeight;\n\n        /**\n         * If the column is out of viewport (expanding out of the root element),\n         * add proper CSS class to hide it\n         */\n        const isOutOfViewport = calculatedLeft + COLUMN_CTA_WIDTH >= gridAreaWidth;\n        isOutOfViewport\n          ? savedContainerRef.current?.classList.add(CLASS_OUT_OF_VIEWPORT)\n          : savedContainerRef.current?.classList.remove(CLASS_OUT_OF_VIEWPORT);\n\n        /**\n         * If the available height is too low, add a class that indicates\n         * that we should display minimized version\n         */\n        const shouldBeMinimized = colContainerHeight < 100;\n        shouldBeMinimized\n          ? savedContainerRef.current?.classList.add(CLASS_IS_MINIMIZED)\n          : savedContainerRef.current?.classList.remove(CLASS_IS_MINIMIZED);\n\n        /**\n         * Finally, set proper values as CSS transform property. Use 3d transform\n         * to ensure hardware acceleration.\n         */\n        targetElement.style.transform = `translate3d(${calculatedLeft}px, ${calculatedTop}px, 0)`;\n\n        /**\n         * Set target height and add 1px to accomodate the border.\n         */\n        targetElement.style.height = `${colContainerHeight + 1}px`;\n      });\n\n      /**\n       * Setup observer with all the necessary elements.\n       */\n      resizeObserver.observe(refLeftElem);\n      resizeObserver.observe(refCenterElem);\n      resizeObserver.observe(refHeaderElem);\n      resizeObserver.observe(rootElement);\n\n      /**\n       * After cleanup, disconnect the observer.\n       */\n      return () => resizeObserver.disconnect();\n    }\n    return undefined;\n  }, []);\n\n  useEffect(() => {\n    if (isInitialized && gridContainerElement) {\n      savedContainerRef.current = gridContainerElement;\n      initialize(gridContainerElement);\n    }\n  }, [initialize, isInitialized, gridContainerElement]);\n\n  /**\n   * This component works only if ResizeObserver is supported by the browser.\n   * If it's not supported, return nothing.\n   */\n  if (!window.ResizeObserver) {\n    return null;\n  }\n\n  return (\n    <div ref={ctaRef} css={styles.columnContainer} className={visible ? '' : CLASS_IS_HIDDEN}>\n      {visible && (\n        <div css={styles.buttonContainer}>\n          <Button css={styles.button} type='link' onClick={onClick}>\n            <PlusCircleBorderIcon css={styles.buttonIcon} />\n            <div css={styles.caption}>\n              <FormattedMessage\n                defaultMessage='Show more metrics and parameters'\n                description='Label for a CTA button in experiment runs table which invokes column management dropdown'\n              />{' '}\n              {moreAvailableParamsAndMetricsColumnCount ? (\n                <>({moreAvailableParamsAndMetricsColumnCount})</>\n              ) : null}\n            </div>\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst styles = {\n  columnContainer: (theme: Theme) => ({\n    width: COLUMN_CTA_WIDTH,\n    height: 0,\n    position: 'absolute' as const,\n    border: `1px solid ${theme.colors.grey200}`,\n    borderLeft: 0,\n    borderTop: 0,\n    top: 0,\n    left: 0,\n    // Slightly expanded icon to conform to the designs\n    svg: {\n      height: 16,\n      width: 16,\n    },\n    willChange: 'transform' as const,\n    transform: 'translate3d(0, 0, 0)',\n    [`.${CLASS_IS_MINIMIZED} &`]: {\n      display: 'flex',\n      alignItems: 'center' as const,\n    },\n    [`&.${CLASS_IS_HIDDEN}, .${CLASS_OUT_OF_VIEWPORT} &`]: {\n      display: 'none',\n    },\n  }),\n  buttonContainer: (theme: Theme) => ({\n    position: 'sticky' as const,\n    top: 0,\n    paddingLeft: theme.spacing.lg,\n    paddingRight: theme.spacing.lg,\n    paddingTop: theme.spacing.lg,\n    width: '100%',\n    [`.${CLASS_IS_MINIMIZED} &`]: {\n      paddingTop: theme.spacing.xs,\n    },\n  }),\n  button: { whiteSpace: 'pre-wrap' as const, width: '100%' },\n  buttonIcon: (theme: Theme) => ({ color: theme.colors.textSecondary }),\n  caption: (theme: Theme) => ({\n    color: theme.colors.textSecondary,\n    [`.${CLASS_IS_MINIMIZED} &`]: {\n      display: 'none',\n    },\n  }),\n};\n","import {\n  ColumnApi,\n  GridApi,\n  GridReadyEvent,\n  RowSelectedEvent,\n  SelectionChangedEvent,\n} from '@ag-grid-community/core';\nimport { Interpolation, Theme } from '@emotion/react';\nimport cx from 'classnames';\nimport React, { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { MLFlowAgGridLoader } from '../../../../../common/components/ag-grid/AgGridLoader';\nimport { ExperimentRunsTableEmptyOverlay } from '../../../../../common/components/ExperimentRunsTableEmptyOverlay';\nimport Utils from '../../../../../common/utils/Utils';\nimport { COLUMN_TYPES } from '../../../../constants';\nimport {\n  ExperimentEntity,\n  UpdateExperimentSearchFacetsFn,\n  UpdateExperimentViewStateFn,\n} from '../../../../types';\n\nimport { SearchExperimentRunsFacetsState } from '../../models/SearchExperimentRunsFacetsState';\nimport { SearchExperimentRunsViewState } from '../../models/SearchExperimentRunsViewState';\nimport {\n  ADJUSTABLE_ATTRIBUTE_COLUMNS,\n  ADJUSTABLE_ATTRIBUTE_COLUMNS_SINGLE_EXPERIMENT,\n  EXPERIMENTS_DEFAULT_COLUMN_SETUP,\n  getFrameworkComponents,\n  getRowId,\n  isCanonicalSortKeyOfType,\n  useRunsColumnDefinitions,\n} from '../../utils/experimentPage.column-utils';\nimport { RunRowType } from '../../utils/experimentPage.row-types';\nimport { ExperimentRunsSelectorResult } from '../../utils/experimentRuns.selector';\nimport { ExperimentViewRunsTableAddColumnCTA } from './ExperimentViewRunsTableAddColumnCTA';\n\nconst ROW_HEIGHT = 32;\nexport interface ExperimentViewRunsTableProps {\n  /**\n   * Actual set of prepared row data to be rendered\n   */\n  rowsData: RunRowType[];\n\n  /**\n   * Helper data set with metric, param and tag keys\n   */\n  runsData: Pick<ExperimentRunsSelectorResult, 'metricKeyList' | 'paramKeyList' | 'tagsList'>;\n\n  experiments: ExperimentEntity[];\n  searchFacetsState: SearchExperimentRunsFacetsState;\n  viewState: SearchExperimentRunsViewState;\n  updateViewState: UpdateExperimentViewStateFn;\n  isLoading: boolean;\n  updateSearchFacets: UpdateExperimentSearchFacetsFn;\n  onAddColumnClicked: () => void;\n}\n\nexport const ExperimentViewRunsTable = React.memo(\n  ({\n    experiments,\n    searchFacetsState,\n    runsData,\n    isLoading,\n    updateSearchFacets,\n    updateViewState,\n    onAddColumnClicked,\n    rowsData,\n  }: ExperimentViewRunsTableProps) => {\n    const { isComparingRuns } = searchFacetsState;\n    const { paramKeyList, metricKeyList, tagsList } = runsData;\n\n    const [gridApi, setGridApi] = useState<GridApi>();\n    const [columnApi, setColumnApi] = useState<ColumnApi>();\n    const prevSelectRunUuids = useRef<string[]>([]);\n\n    const filteredTagKeys = useMemo(() => Utils.getVisibleTagKeyList(tagsList), [tagsList]);\n\n    const containerElement = useRef<HTMLDivElement>(null);\n\n    // Flag indicating if there are any rows that can be expanded\n    const expandersVisible = useMemo(\n      () => rowsData.some((row) => row.runDateAndNestInfo?.hasExpander),\n      [rowsData],\n    );\n\n    /**\n     * Updates selected rows in the view state\n     */\n    const onSelectionChange = useCallback(\n      ({ api }: SelectionChangedEvent) => {\n        const selectedUUIDs: string[] = api\n          .getSelectedRows()\n          .map(({ runInfo }) => runInfo.run_uuid);\n        updateViewState({\n          runsSelected: selectedUUIDs.reduce(\n            (aggregate, curr) => ({ ...aggregate, [curr]: true }),\n            {},\n          ),\n        });\n        prevSelectRunUuids.current = selectedUUIDs;\n      },\n      [updateViewState],\n    );\n\n    /**\n     * A onRowSelected event handler that runs before onSelectionChange.\n     * It checks if the currently (de)selected row contains any children\n     * and if true, (de)select them as well.\n     */\n    const handleRowSelected = useCallback((event: RowSelectedEvent) => {\n      const selectedRows = event.api.getSelectedRows();\n\n      // Let's check if the actual number of selected rows have changed\n      // to avoid empty runs\n      if (prevSelectRunUuids.current && selectedRows.length !== prevSelectRunUuids.current.length) {\n        const isSelected = Boolean(event.node.isSelected());\n\n        // We will continue only if the selected row has properly set runDateInfo\n        const { runDateAndNestInfo } = event.data as RunRowType;\n        if (!runDateAndNestInfo) {\n          return;\n        }\n        const { isParent, expanderOpen, childrenIds } = runDateAndNestInfo;\n\n        // We will continue only if the selected row is a parent containing\n        // children and is actually expanded\n        if (isParent && expanderOpen && childrenIds) {\n          const childrenIdsToSelect = childrenIds;\n\n          event.api.forEachNode((node) => {\n            const { runInfo, runDateAndNestInfo: childRunDateInfo } = node.data as RunRowType;\n\n            const childrenRunUuid = runInfo.run_uuid;\n            if (childrenIdsToSelect.includes(childrenRunUuid)) {\n              // If we found children being parents, mark their children\n              // to be selected as well.\n              if (childRunDateInfo?.childrenIds) {\n                childrenIdsToSelect.push(...childRunDateInfo.childrenIds);\n              }\n\n              node.setSelected(isSelected, false, true);\n            }\n          });\n        }\n      }\n    }, []);\n\n    const onSortBy = useCallback(\n      (newOrderByKey: string, newOrderByAsc: boolean) => {\n        updateSearchFacets({ orderByKey: newOrderByKey, orderByAsc: newOrderByAsc });\n      },\n      [updateSearchFacets],\n    );\n\n    const toggleRowExpanded = useCallback(\n      (parentId: string) =>\n        updateSearchFacets(({ runsExpanded: currentRunsExpanded, ...state }) => ({\n          ...state,\n          runsExpanded: { ...currentRunsExpanded, [parentId]: !currentRunsExpanded[parentId] },\n        })),\n      [updateSearchFacets],\n    );\n\n    const togglePinnedRow = useCallback(\n      (uuid: string) => {\n        updateSearchFacets((existingFacets) => ({\n          ...existingFacets,\n          runsPinned: !existingFacets.runsPinned.includes(uuid)\n            ? [...existingFacets.runsPinned, uuid]\n            : existingFacets.runsPinned.filter((r) => r !== uuid),\n        }));\n        // In the next frame, redraw the toggled row in to update the hover state\n        // and tooltips so they won't dangle in the previous mouse position.\n        requestAnimationFrame(() => {\n          if (!gridApi) {\n            return;\n          }\n          const rowNode = gridApi.getRowNode(uuid);\n          if (rowNode) {\n            gridApi.redrawRows({ rowNodes: [rowNode] });\n          }\n        });\n      },\n      [gridApi, updateSearchFacets],\n    );\n\n    const gridReadyHandler = useCallback((params: GridReadyEvent) => {\n      setGridApi(params.api);\n      setColumnApi(params.columnApi);\n    }, []);\n\n    const columnDefs = useRunsColumnDefinitions({\n      searchFacetsState,\n      onSortBy,\n      onExpand: toggleRowExpanded,\n      compareExperiments: experiments.length > 1,\n      onTogglePin: togglePinnedRow,\n      metricKeyList,\n      paramKeyList,\n      tagKeyList: filteredTagKeys,\n      columnApi,\n      isComparingRuns,\n    });\n\n    useEffect(() => {\n      if (!gridApi) {\n        return;\n      }\n\n      if (isLoading) {\n        gridApi.showLoadingOverlay();\n      } else {\n        gridApi.hideOverlay();\n        gridApi.setRowData(rowsData);\n      }\n    }, [gridApi, rowsData, isLoading]);\n\n    // Count all columns available for selection\n    const allAvailableColumnsCount = useMemo(() => {\n      const attributeColumnCount =\n        experiments.length > 1\n          ? ADJUSTABLE_ATTRIBUTE_COLUMNS.length\n          : ADJUSTABLE_ATTRIBUTE_COLUMNS_SINGLE_EXPERIMENT.length;\n\n      const valuesColumnCount = metricKeyList.length + paramKeyList.length + filteredTagKeys.length;\n\n      return attributeColumnCount + valuesColumnCount;\n    }, [experiments.length, filteredTagKeys.length, metricKeyList.length, paramKeyList.length]);\n\n    const hasSelectedAllColumns =\n      searchFacetsState.selectedColumns.length >= allAvailableColumnsCount;\n\n    // Count metrics and params columns that were not selected yet so it can be displayed in CTA\n    const moreAvailableParamsAndMetricsColumns = useMemo(() => {\n      const selectedMetricsAndParamsColumns = searchFacetsState.selectedColumns.filter(\n        (s) =>\n          isCanonicalSortKeyOfType(s, COLUMN_TYPES.METRICS) ||\n          isCanonicalSortKeyOfType(s, COLUMN_TYPES.PARAMS),\n      ).length;\n\n      const allMetricsAndParamsColumns = metricKeyList.length + paramKeyList.length;\n\n      return Math.max(0, allMetricsAndParamsColumns - selectedMetricsAndParamsColumns);\n    }, [metricKeyList.length, paramKeyList.length, searchFacetsState.selectedColumns]);\n\n    const displayAddColumnsCTA = !hasSelectedAllColumns && !isComparingRuns;\n\n    useLayoutEffect(() => {\n      if (!gridApi) {\n        return;\n      }\n      // Each time we switch to \"compare runs\" mode, we should\n      // maximize columns so \"run name\" column will take up all remaining space\n      if (isComparingRuns) {\n        gridApi.sizeColumnsToFit();\n      }\n    }, [gridApi, isComparingRuns]);\n\n    return (\n      <div>\n        <div\n          ref={containerElement}\n          className={cx('ag-theme-balham ag-grid-sticky', {\n            'ag-grid-expanders-visible': expandersVisible,\n          })}\n          css={styles.agGridOverrides}\n        >\n          <MLFlowAgGridLoader\n            defaultColDef={EXPERIMENTS_DEFAULT_COLUMN_SETUP}\n            columnDefs={columnDefs}\n            domLayout='autoHeight'\n            rowSelection='multiple'\n            onGridReady={gridReadyHandler}\n            onSelectionChanged={onSelectionChange}\n            rowHeight={ROW_HEIGHT}\n            headerHeight={ROW_HEIGHT}\n            onRowSelected={handleRowSelected}\n            suppressRowClickSelection\n            suppressColumnMoveAnimation\n            suppressScrollOnNewData\n            suppressFieldDotNotation\n            enableCellTextSelection\n            components={getFrameworkComponents()}\n            suppressNoRowsOverlay\n            loadingOverlayComponent='loadingOverlayComponent'\n            loadingOverlayComponentParams={{ showImmediately: true }}\n            getRowId={getRowId}\n          />\n          {displayAddColumnsCTA && (\n            <ExperimentViewRunsTableAddColumnCTA\n              gridContainerElement={containerElement.current}\n              isInitialized={Boolean(gridApi)}\n              onClick={onAddColumnClicked}\n              visible={!isLoading}\n              moreAvailableParamsAndMetricsColumnCount={moreAvailableParamsAndMetricsColumns}\n            />\n          )}\n        </div>\n        {rowsData.length < 1 && !isLoading && (\n          <div css={styles.noResultsWrapper}>\n            <ExperimentRunsTableEmptyOverlay />\n          </div>\n        )}\n      </div>\n    );\n  },\n);\n\n/**\n * Concrete named definitions for colors used in this agGrid\n */\nconst getGridColors = (theme: Theme) => ({\n  rowBackground: theme.colors.backgroundPrimary, // regular row background\n  rowBackgroundHover: `${theme.colors.grey600}0A`, // hovered row (4% opacity)\n  rowBackgroundSelected: `${theme.colors.grey600}14`, // selected row (8% opacity)\n  rowBackgroundHoverSelected: `${theme.colors.grey600}1F`, // selected and hovered row (12% opacity)\n  columnSortedBy: `${theme.colors.blue100}b3`, // selected and hovered row (12% opacity)\n  headerBackground: theme.colors.grey100,\n  headerTextColor: '#2E3840', // directly from Figma design\n  headerGroupTextColor: theme.colors.textSecondary, // directly from Figma design\n  borderColor: theme.colors.grey200, // border between header and content and scrollable areas\n  headerBorderColor: 'transparent', // borders inside the header\n  checkboxBorderColor: theme.colors.actionDefaultBorderDefault,\n  checkboxBorderColorChecked: theme.colors.backgroundPrimary,\n  checkboxBackgroundColorChecked: theme.colors.actionPrimaryBackgroundDefault,\n});\n\nconst styles = {\n  noResultsWrapper: (theme: Theme) => ({\n    marginTop: -theme.spacing.md * 4,\n    textAlign: 'center' as const,\n    backgroundColor: theme.colors.backgroundPrimary,\n    position: 'relative' as const,\n  }),\n  agGridOverrides: (theme: Theme): Interpolation<Theme> => {\n    const gridColors = getGridColors(theme);\n    return {\n      position: 'relative',\n      '&.ag-theme-balham': {\n        // Set up internal variable values\n        '--ag-border-color': gridColors.borderColor,\n        '--ag-row-border-color': gridColors.borderColor,\n        '--ag-odd-row-background-color': gridColors.rowBackground,\n        '--ag-row-hover-color': gridColors.rowBackgroundHover,\n        '--ag-selected-row-background-color': gridColors.rowBackgroundSelected,\n        '--ag-header-foreground-color': gridColors.headerTextColor,\n        '--ag-header-background-color': gridColors.headerBackground,\n\n        // Makes row header sticky\n        '&.ag-grid-sticky .ag-header': {\n          position: 'sticky',\n          top: 0,\n          zIndex: 1,\n        },\n        '&.ag-grid-sticky .ag-root': {\n          overflow: 'visible',\n        },\n        '&.ag-grid-sticky .ag-root-wrapper': {\n          border: '0',\n          borderRadius: '4px',\n          overflow: 'visible',\n        },\n\n        // Adds a static line between column group header row and column headers\n        '.ag-header::after': {\n          content: '\"\"',\n          position: 'absolute',\n          top: ROW_HEIGHT,\n          left: 0,\n          right: 0,\n          height: 1,\n          backgroundColor: gridColors.borderColor,\n        },\n\n        // Line height for cell contents is the row height minus the border\n        '.ag-cell': {\n          lineHeight: `min(var(--ag-line-height, ${ROW_HEIGHT - 2}px), ${ROW_HEIGHT - 2}px)`,\n        },\n\n        // Padding fixes for the header (we use custom component)\n        '.ag-header-cell': {\n          padding: 0,\n        },\n        '.ag-header-cell .ag-checkbox': {\n          padding: '0 7px',\n          borderLeft: '1px solid transparent', // to match it with the cell sizing\n        },\n\n        '.ag-cell.is-ordered-by, .ag-header-cell > .is-ordered-by': {\n          backgroundColor: gridColors.columnSortedBy,\n        },\n        '.ag-header-row': {\n          '--ag-border-color': gridColors.headerBorderColor,\n        },\n        '.ag-header-row.ag-header-row-column-group': {\n          '--ag-header-foreground-color': gridColors.headerGroupTextColor,\n        },\n        '.ag-row.ag-row-selected.ag-row-hover': {\n          backgroundColor: gridColors.rowBackgroundHoverSelected,\n        },\n\n        // Hides resize guidelines when header is not hovered\n        '.ag-header:not(:hover) .ag-header-cell::after, .ag-header:not(:hover) .ag-header-group-cell::after':\n          {\n            opacity: 0,\n          },\n        '.ag-pinned-left-header': {\n          borderRight: 'none',\n        },\n\n        // Fixed for loading overlay\n        '.ag-overlay-loading-wrapper': {\n          paddingTop: theme.spacing.md * 4,\n          alignItems: 'center',\n        },\n        '.ag-overlay-loading-wrapper .ag-react-container': {\n          flex: 1,\n          zIndex: 1,\n        },\n\n        // Adds border after the last column to separate contents from \"Add columns\" CTA\n        '.ag-center-cols-container': {\n          borderRight: `1px solid var(--ag-border-color)`,\n          minHeight: 0,\n        },\n\n        // Centers vertically and styles the checkbox cell\n        '.is-checkbox-cell': {\n          display: 'flex',\n          alignItems: 'center',\n          paddingLeft: 7, // will end up in 8px due to 1px of transparent border on the left\n        },\n\n        // Header checkbox cell will get the same background as header only if it's unchecked\n        '.ag-header-cell .ag-checkbox .ag-input-wrapper:not(.ag-indeterminate):not(.ag-checked)': {\n          '--ag-checkbox-background-color': gridColors.headerBackground,\n        },\n\n        // Distance from the checkbox to other icons (pin, visibility etc.)\n        '.ag-selection-checkbox': {\n          marginRight: 16,\n        },\n\n        // Header and cell checkboxes will get same colors from the palette\n        '.is-checkbox-cell, .ag-header-cell .ag-checkbox': {\n          '.ag-checkbox-input-wrapper::after': {\n            color: gridColors.checkboxBorderColor,\n          },\n          '.ag-checkbox-input-wrapper.ag-checked': {\n            '--ag-checkbox-background-color': gridColors.checkboxBackgroundColorChecked,\n            '--ag-checkbox-checked-color': gridColors.checkboxBorderColorChecked,\n            '&::after': {\n              color: gridColors.checkboxBorderColorChecked,\n            },\n          },\n        },\n      },\n    };\n  },\n};\n","/**\n * Defines non-persistable, local state that\n * controls visibility of various UI elements in the\n * runs table and controls\n */\nexport class SearchExperimentRunsViewState {\n  /**\n   * Currently selected runs\n   */\n  runsSelected: Record<string, boolean> = {};\n\n  /**\n   * Currently hidden, selected child runs\n   */\n  hiddenChildRunsSelected: Record<string, boolean> = {};\n\n  /**\n   * Display \"select columns\" dropdown\n   */\n  columnSelectorVisible = false;\n}\n","import { Button, Tooltip } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { connect } from 'react-redux';\nimport { ExperimentStoreEntities } from '../../../../types';\nimport { EXPERIMENT_PARENT_ID_TAG } from '../../utils/experimentPage.common-utils';\n\nexport interface ExperimentViewLoadMoreProps {\n  loadMoreRuns: () => void;\n  moreRunsAvailable: boolean;\n  isLoadingRuns: boolean;\n}\n\nexport interface ExperimentViewLoadMoreConnectProps {\n  containsNestedRuns: boolean;\n}\n\n// Simple JSX wrappers for tooltips\nconst noMoreRunsTooltipWrapper = (node: React.ReactNode) => (\n  <Tooltip\n    placement='bottom'\n    title={\n      <FormattedMessage\n        defaultMessage='No more runs to load.'\n        description='Tooltip text for load more button when there are no more experiment runs to load'\n      />\n    }\n  >\n    {node}\n  </Tooltip>\n);\n\nconst nestedRunsTooltipWrapper = (node: React.ReactNode) => (\n  <Tooltip\n    placement='bottom'\n    title={\n      <FormattedMessage\n        defaultMessage='Loaded child runs are nested under their parents.'\n        description='Tooltip text for load more button explaining the runs are nested under their parent experiment run'\n      />\n    }\n  >\n    {node}\n  </Tooltip>\n);\n\n/**\n * Component displaying \"Load more\" button with proper tooltips\n */\nexport const ExperimentViewLoadMoreImpl = ({\n  loadMoreRuns,\n  moreRunsAvailable,\n  isLoadingRuns,\n  containsNestedRuns,\n}: ExperimentViewLoadMoreProps & ExperimentViewLoadMoreConnectProps) => {\n  const loadMoreButton = (\n    <Button\n      type='primary'\n      onClick={loadMoreRuns}\n      disabled={!moreRunsAvailable || isLoadingRuns}\n      loading={isLoadingRuns}\n    >\n      <FormattedMessage\n        defaultMessage='Load more'\n        description='Load more button text to load more experiment runs'\n      />\n    </Button>\n  );\n\n  return (\n    <div css={styles.loadMoreButton}>\n      {!moreRunsAvailable\n        ? noMoreRunsTooltipWrapper(loadMoreButton)\n        : containsNestedRuns\n        ? nestedRunsTooltipWrapper(loadMoreButton)\n        : loadMoreButton}\n    </div>\n  );\n};\n\n/**\n * We're extracting a single boolean flag indicating if there are any runs\n * indicating a run hierarchy. If true, we'll use it to display the corresponding tooltip.\n */\nconst mapStateToProps = (state: { entities: ExperimentStoreEntities }) => {\n  const currentRunUUIDs = Object.keys(state.entities.runInfosByUuid);\n  const containsNestedRuns = Object.entries(state.entities.tagsByRunUuid).some(\n    ([key, tagList]) =>\n      currentRunUUIDs.includes(key) && Object.keys(tagList).includes(EXPERIMENT_PARENT_ID_TAG),\n  );\n  return { containsNestedRuns };\n};\n\nexport const ExperimentViewLoadMore = connect(mapStateToProps)(ExperimentViewLoadMoreImpl);\n\nconst styles = {\n  loadMoreButton: (theme: Theme) => ({\n    display: 'flex',\n    justifyContent: 'center',\n    marginTop: theme.spacing.md,\n  }),\n};\n","import { isNumber } from 'lodash';\nimport Utils from '../../../../common/utils/Utils';\nimport { ExperimentEntity, KeyValueEntity, ModelInfoEntity, RunInfoEntity } from '../../../types';\nimport {\n  RunRowDateAndNestInfo,\n  RunRowModelsInfo,\n  RunRowType,\n  RunRowVersionInfo,\n} from './experimentPage.row-types';\nimport { SearchExperimentRunsFacetsState } from '../models/SearchExperimentRunsFacetsState';\nimport { ExperimentRunsSelectorResult } from './experimentRuns.selector';\nimport {\n  EXPERIMENT_FIELD_PREFIX_METRIC,\n  EXPERIMENT_FIELD_PREFIX_PARAM,\n  EXPERIMENT_FIELD_PREFIX_TAG,\n  EXPERIMENT_PARENT_ID_TAG,\n} from './experimentPage.common-utils';\n\n/**\n * A simple tree-like interface used in nested rows calculations.\n */\ninterface SimpleTreeNode {\n  value: string;\n  parent?: SimpleTreeNode;\n}\n\n/**\n * An intermediate interface representing single row in agGrid (but not necessarily\n * a single run - these might be nested and not expanded). Is created from the data\n * originating from the store, then after enriching with metrics, params, attributed etc.\n * is being transformed to RunRowType which serves as a final agGrid compatible type.\n */\ninterface RowRenderMetadata {\n  index: number;\n  isParent?: boolean;\n  hasExpander?: boolean;\n  expanderOpen?: boolean;\n  isPinnable?: boolean;\n  runInfo: RunInfoEntity;\n  level: number;\n  childrenIds?: string[];\n  params: KeyValueEntity[];\n  metrics: KeyValueEntity[];\n  tags: Record<string, KeyValueEntity>;\n}\n\n/**\n * For a given run dataset from the store, this function prepares\n * a list of rows metadata discarding any information about the parent/child run hierarchy.\n */\nconst getFlatRowRenderMetadata = (runData: SingleRunData[]) =>\n  runData.map<RowRenderMetadata>(({ runInfo, metrics = [], params = [], tags = {} }, index) => ({\n    index,\n    runInfo,\n    level: 0, // All runs will be on \"0\" level here,\n    isPinnable: !tags[EXPERIMENT_PARENT_ID_TAG]?.value,\n    metrics: metrics,\n    params: params,\n    tags: tags,\n  }));\n\n/**\n * For a given run dataset from the store, this function prepares\n * a list of rows metadata taking the parent/child run hierarchy into consideration.\n */\nconst getNestedRowRenderMetadata = ({\n  runsExpanded,\n  runData,\n}: {\n  runsExpanded: Record<string, boolean>;\n  runData: SingleRunData[];\n}) => {\n  // First, map run IDs to their indices - will be helpful later on.\n  const runIdToIndex: Record<string, number> = {};\n  runData.forEach(({ runInfo }, index) => {\n    runIdToIndex[runInfo.run_uuid] = index;\n  });\n\n  // Create a list of tree nodes for all run infos. Each leaf's value is the run UUID.\n  const treeNodes: SimpleTreeNode[] = runData.map(({ runInfo }) => ({ value: runInfo.run_uuid }));\n\n  // We're going to check if any hierarchy is detected in the run set. If not,\n  // we will not bother with unnecessary calculations.\n  let foundHierarchy = false;\n\n  // Iterate through all the tags and assign proper parent references\n  runData.forEach(({ tags }, index) => {\n    const parentRunId = tags?.[EXPERIMENT_PARENT_ID_TAG];\n    if (parentRunId) {\n      const parentRunIndex = runIdToIndex[parentRunId.value];\n      if (parentRunIndex !== undefined) {\n        foundHierarchy = true;\n        treeNodes[index].parent = treeNodes[parentRunIndex];\n      }\n    }\n  });\n\n  // If no parent tags are found, we're not going calculate\n  // tree-related stuff and return a flat list instead.\n  if (!foundHierarchy) {\n    return getFlatRowRenderMetadata(runData);\n  }\n\n  // Iterate through the tree and convert it to a flat parent->children mapping array\n  const parentIdToChildren: Record<string, number[]> = {};\n  const rootIndexes: any[] = [];\n  treeNodes.forEach((treeNode, index) => {\n    const { parent } = treeNode;\n    if (parent !== undefined && parent.value !== treeNode.value) {\n      if (parentIdToChildren[parent.value]) {\n        parentIdToChildren[parent.value].push(index);\n      } else {\n        parentIdToChildren[parent.value] = [index];\n      }\n    } else {\n      // If a node has no parent, let's register it as a root index\n      rootIndexes.push(index);\n    }\n  });\n\n  const resultRowsMetadata: RowRenderMetadata[] = [];\n\n  // Create and invoke a simple DFS search with \"visited\" set so we won't be caught in a cycle\n  const visited = new Set();\n  const doDfs = (dfsIndex: number, currLevel: number) => {\n    if (!visited.has(dfsIndex)) {\n      const currentNodeRunInfo = runData[dfsIndex].runInfo;\n      const currentNodeRunId = currentNodeRunInfo.run_uuid;\n\n      // Only rows that are top-level parents or those being on the top level are pinnable\n      const isPinnable = Boolean(rootIndexes.includes(dfsIndex)) || currLevel === 0;\n\n      const rowMetadata: RowRenderMetadata = {\n        index: dfsIndex,\n        isParent: false,\n        hasExpander: false,\n        level: currLevel,\n        runInfo: currentNodeRunInfo,\n        params: runData[dfsIndex].params || [],\n        metrics: runData[dfsIndex].metrics || [],\n        tags: runData[dfsIndex].tags || {},\n        isPinnable,\n      };\n      if (parentIdToChildren[currentNodeRunId]) {\n        rowMetadata.isParent = true;\n        rowMetadata.hasExpander = true;\n        rowMetadata.expanderOpen = Boolean(runsExpanded[currentNodeRunId]);\n        rowMetadata.childrenIds = parentIdToChildren[currentNodeRunId].map(\n          (cIdx) => runData[cIdx].runInfo.run_uuid,\n        );\n      }\n\n      resultRowsMetadata.push(rowMetadata);\n      visited.add(dfsIndex);\n\n      const childrenIndices = parentIdToChildren[currentNodeRunId];\n      // Repeat DFS for children nodes - only if the current node is expanded\n      if (childrenIndices) {\n        if (runsExpanded[currentNodeRunId]) {\n          childrenIndices.forEach((dIdx) => {\n            doDfs(dIdx, currLevel + 1);\n          });\n        }\n      }\n    }\n  };\n\n  // Invoke the DFS for all root indexes\n  rootIndexes.forEach((rootNodeIndex) => {\n    doDfs(rootNodeIndex, 0);\n  });\n  return resultRowsMetadata;\n};\n\n/**\n * Iterates through all key/value data given for a run and\n * returns mapped dataset in a \"PREFIX-NAME\" form, e.g. '$$$param$$$-paramname\".\n * Fills '-' placeholder in all empty places.\n */\nconst createKeyValueDataForRunRow = (\n  list: { key: string; value: string }[],\n  keys: string[],\n  prefix: string,\n) => {\n  if (!list) {\n    return [];\n  }\n\n  const map: Record<string, string> = {};\n\n  // First, populate all values (cells) with default placeholder: '-'\n  for (const key of keys) {\n    map[`${prefix}-${key}`] = '-';\n  }\n\n  // Then, override with existing value if found\n  for (const { key, value } of list) {\n    if (value || isNumber(value)) {\n      map[`${prefix}-${key}`] = value;\n    }\n  }\n\n  return map;\n};\n\n/**\n * Creates ag-grid compatible row dataset for all given runs basing on\n * the data retrieved from the API and from the refux store.\n * Please refer to PrepareRunsGridDataParams type for type reference.\n */\nexport const prepareRunsGridData = ({\n  experiments,\n  modelVersionsByRunUuid,\n  runsExpanded,\n  nestChildren,\n  referenceTime,\n  paramKeyList,\n  metricKeyList,\n  tagKeyList,\n  runsPinned,\n  runData,\n  runUuidsMatchingFilter,\n}: PrepareRunsGridDataParams) => {\n  const experimentNameMap = Utils.getExperimentNameMap(\n    Utils.sortExperimentsById(experiments),\n  ) as Record<string, { name: string; basename: string }>;\n\n  // Let's start with generating intermediate row metadata - either as a nested or a flat list.\n  // We need to assemble separate hierarchies for pinned rows and unpinned rows:\n  const rowRenderMetadata: RowRenderMetadata[] = nestChildren\n    ? getNestedRowRenderMetadata({ runData, runsExpanded })\n    : getFlatRowRenderMetadata(runData);\n\n  // We will aggregate children of pinned parent rows here so we will easily pin them as well\n  const childrenToPin: string[] = [];\n\n  // Now, enrich the intermediate row metadata with attributes, metrics and params and\n  // return it as a grid-consumable \"RunRowType\" type.\n  const runs = rowRenderMetadata.map<RunRowType>((runInfoMetadata) => {\n    const {\n      runInfo,\n      isParent = false,\n      hasExpander = false,\n      level = 0,\n      expanderOpen = false,\n      isPinnable = false,\n      childrenIds = [],\n      tags,\n      params,\n      metrics,\n    } = runInfoMetadata;\n\n    const formattedMetrics = (metrics || []).map(({ key, value }) => ({\n      key,\n      value: Utils.formatMetric(value),\n    }));\n\n    // Extract necessary basic info\n    const runUuid = runInfo.run_uuid;\n    const { experiment_id: experimentId } = runInfo;\n    const experimentName = experimentNameMap[experimentId];\n    const user = Utils.getUser(runInfo, tags);\n    const duration = Utils.getDuration(runInfo.start_time, runInfo.end_time);\n    const runName = Utils.getRunName(runInfo) || runInfo.run_uuid;\n\n    // Extract visible tags (i.e. those not prefixed with \"mlflow.\")\n    const visibleTags = Utils.getVisibleTagValues(tags).map(([key, value]) => ({\n      key,\n      value,\n    }));\n\n    // Prepare a data package to be used by \"Start time\" cell\n    const runDateAndNestInfo: RunRowDateAndNestInfo = {\n      startTime: runInfo.start_time,\n      referenceTime,\n      experimentId,\n      runUuid,\n      runStatus: runInfo.status,\n      isParent,\n      hasExpander,\n      expanderOpen,\n      childrenIds,\n      level,\n    };\n\n    // Prepare a data package to be used by \"Models\" cell\n    const models: RunRowModelsInfo = {\n      registeredModels: modelVersionsByRunUuid[runInfo.run_uuid] || [], // ModelInfoEntity\n      loggedModels: Utils.getLoggedModelsFromTags(tags),\n      experimentId: runInfo.experiment_id,\n      runUuid: runInfo.run_uuid,\n    };\n\n    // Prepare a data package to be used by \"Version\" cell\n    const version: RunRowVersionInfo = {\n      version: Utils.getSourceVersion(tags),\n      name: Utils.getSourceName(tags),\n      type: Utils.getSourceType(tags),\n    };\n\n    const isCurrentRowPinned = runsPinned.includes(runUuid);\n    const isParentPinned = childrenToPin.includes(runUuid);\n\n    // If this or a parent row is pinned, pin children as well\n    if (isCurrentRowPinned || isParentPinned) {\n      childrenToPin.push(...childrenIds);\n    }\n\n    // Compile everything into a data object to be consumed by the grid component\n    return {\n      runUuid,\n      runDateAndNestInfo,\n      runInfo,\n      experimentName,\n      experimentId,\n      duration,\n      user,\n      runName,\n      tags,\n      models,\n      version,\n      pinnable: isPinnable,\n      pinned: isCurrentRowPinned || isParentPinned,\n      ...createKeyValueDataForRunRow(params, paramKeyList, EXPERIMENT_FIELD_PREFIX_PARAM),\n      ...createKeyValueDataForRunRow(\n        formattedMetrics,\n        metricKeyList,\n        EXPERIMENT_FIELD_PREFIX_METRIC,\n      ),\n      ...createKeyValueDataForRunRow(visibleTags, tagKeyList, EXPERIMENT_FIELD_PREFIX_TAG),\n    };\n  });\n\n  // If the flat structure is displayed, we can hoist pinned rows to the top\n  return [\n    // Add pinned rows to the top\n    ...runs.filter(({ pinned }) => pinned),\n\n    // Next, add all remaining rows - however, sweep out all runs that don't match the current filter. This\n    // will hide all filtered out runs that were pinned before, but were eventually un-pinned.\n    ...runs.filter(({ pinned, runUuid }) => !pinned && runUuidsMatchingFilter.includes(runUuid)),\n  ];\n};\n\ntype SingleRunData = {\n  runInfo: RunInfoEntity;\n  params: KeyValueEntity[];\n  metrics: KeyValueEntity[];\n  tags: Record<string, KeyValueEntity>;\n};\n\n/**\n * All parameters necessary to calculate run row data.\n */\ntype PrepareRunsGridDataParams = Pick<\n  ExperimentRunsSelectorResult,\n  'metricKeyList' | 'paramKeyList' | 'modelVersionsByRunUuid'\n> &\n  Pick<SearchExperimentRunsFacetsState, 'runsExpanded' | 'runsPinned'> & {\n    /**\n     * List of experiments containing the runs\n     */\n    experiments: ExperimentEntity[];\n\n    /**\n     * Registered model versions arrays per run uuid\n     */\n    modelVersionsByRunUuid: Record<string, ModelInfoEntity[]>;\n\n    /**\n     * Boolean flag indicating if hierarchical runs should be generated\n     */\n    nestChildren: boolean;\n\n    /**\n     * List of all visible tag keys\n     */\n    tagKeyList: string[];\n\n    /**\n     * A reference time necessary to calculate \"xxx minutes ago\"-like labels\n     */\n    referenceTime: Date;\n\n    /**\n     * List of simplified run objects containing all relevant data\n     */\n    runData: SingleRunData[];\n\n    /**\n     * List of all runs IDs that match the current filter\n     * (this excludes all rows that on the list just because they are pinned)\n     */\n    runUuidsMatchingFilter: string[];\n  };\n","import { Button, OverflowIcon, Typography, Spacer, DropdownMenu } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { CompareRunsChartSetup } from '../../types';\nimport { RunRowType } from '../experiment-page/utils/experimentPage.row-types';\n\nexport interface RunsCompareChartsProps {\n  comparedRuns: RunRowType[];\n  chartsConfig: CompareRunsChartSetup[];\n  onRemoveChart: (chart: CompareRunsChartSetup) => void;\n}\n\n// prettier-ignore\n// eslint-disable-next-line prettier/prettier\n/**\n * Sample SVG component for visualization purposes\n */\nconst ChartSamplePlaceholderData = () => <svg width='auto' viewBox='0 0 479 235' fill='none' xmlns='http://www.w3.org/2000/svg'>    <path d='M9.41016 233.928L60.5718 214.28L110.299 187.443L164.329 172.586L185.846 144.312L221.707 110.765L248.005 95.43L290.082 73.8645' stroke='#FF3621' strokeWidth='2' strokeLinecap='round' strokeLinejoin='round' />    <path d='M9.41016 233.928L42.3472 231.041L74.3607 227.097L105.713 223.545L122.997 220.758L191.095 214.264L301.297 209.945L454.19 206.821' stroke='#077A9D' strokeWidth='2' strokeLinecap='round' strokeLinejoin='round' />    <path d='M9.41016 233.928L25.5143 206.821L48.5201 177.777L62.3236 150.024L92.3814 123.562L142.827 88.9139L164.909 52.5656L228.733 22.231' stroke='#FCA4A1' strokeWidth='2' strokeLinecap='round' strokeLinejoin='round' />    <line x1='6.84375' y1='0.286865' x2='6.84376' y2='232.637' stroke='#BDCDDB' />    <line x1='0.208984' y1='233.428' x2='7.87761' y2='233.428' stroke='#BDCDDB' />    <line x1='0.208984' y1='207.612' x2='7.87761' y2='207.612' stroke='#BDCDDB' />    <line x1='0.208984' y1='181.795' x2='7.87761' y2='181.795' stroke='#BDCDDB' />    <line x1='0.208984' y1='155.978' x2='7.87761' y2='155.978' stroke='#BDCDDB' />    <line x1='0.208984' y1='130.161' x2='7.87761' y2='130.161' stroke='#BDCDDB' />    <line x1='0.208984' y1='104.345' x2='7.87761' y2='104.345' stroke='#BDCDDB' />    <line x1='0.208984' y1='78.5278' x2='7.87761' y2='78.5278' stroke='#BDCDDB' />    <line x1='0.208984' y1='52.7112' x2='7.87761' y2='52.7112' stroke='#BDCDDB' />    <line x1='0.208984' y1='26.8945' x2='7.87761' y2='26.8945' stroke='#BDCDDB' />    <line x1='0.208984' y1='1.07764' x2='7.87761' y2='1.07764' stroke='#BDCDDB' />    <line x1='478.73' y1='233.137' x2='6.34338' y2='233.137' stroke='#BDCDDB' />  </svg>;\n\n/**\n * Sample chart component for visualization purposes\n * TODO: implement actual cards for various chart types\n */\nconst SampleChartCard = ({\n  config,\n  onDelete,\n}: {\n  onDelete: () => void;\n  config: CompareRunsChartSetup;\n}) => (\n  <div css={styles.chartEntry}>\n    <div css={styles.chartEntryTitle}>\n      <Typography.Title level={4}>\n        Chart {config.type} for {config.metricKey}\n      </Typography.Title>\n      <DropdownMenu.Root>\n        <DropdownMenu.Trigger asChild>\n          <Button type='tertiary' icon={<OverflowIcon />} />\n        </DropdownMenu.Trigger>\n        <DropdownMenu.Content align='end' minWidth={100}>\n          <DropdownMenu.Item\n            onClick={() => {\n              /* TODO: reconfiguring existing charts */\n            }}\n          >\n            Configure\n          </DropdownMenu.Item>\n          <DropdownMenu.Item onClick={onDelete}>Delete</DropdownMenu.Item>\n        </DropdownMenu.Content>\n      </DropdownMenu.Root>\n    </div>\n    <div css={(theme) => ({ fontSize: 10, color: theme.colors.grey600 })}>UUID: {config.uuid}</div>\n    <Spacer size='md' />\n    <ChartSamplePlaceholderData />\n  </div>\n);\n\nexport const RunsCompareCharts = ({ chartsConfig, onRemoveChart }: RunsCompareChartsProps) => {\n  return (\n    <div css={styles.chartsWrapper}>\n      {chartsConfig.map((chartConfig) => (\n        <SampleChartCard\n          key={chartConfig.uuid}\n          config={chartConfig}\n          onDelete={() => onRemoveChart(chartConfig)}\n        />\n      ))}\n    </div>\n  );\n};\n\nconst styles = {\n  chartsWrapper: (theme: Theme) => ({\n    display: 'grid' as const,\n    gridTemplateColumns: 'repeat(auto-fill, minmax(400px, 1fr))',\n    gap: theme.spacing.md,\n  }),\n  chartEntryTitle: (theme: Theme) => ({\n    display: 'grid' as const,\n    gridTemplateColumns: '1fr auto auto',\n    height: theme.general.heightSm,\n    alignItems: 'center',\n  }),\n  chartEntry: (theme: Theme) => ({\n    backgroundColor: theme.colors.backgroundPrimary,\n    padding: theme.spacing.md,\n    border: `1px solid ${theme.colors.border}`,\n    borderRadius: theme.general.borderRadiusBase,\n  }),\n};\n","import { throttle } from 'lodash';\nimport { Layout, Margin } from 'plotly.js';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { PlotParams } from 'react-plotly.js';\nimport { KeyValueEntity, MetricEntitiesByName, RunInfoEntity } from '../../../types';\n\n/**\n * Common props for all charts used in compare runs\n */\nexport interface CompareRunsCommonPlotProps {\n  /**\n   * A scatter layer marker size\n   */\n  markerSize?: number;\n\n  /**\n   * Additional class name passed to the chart wrapper\n   */\n  className?: string;\n\n  /**\n   * Plotly.js-compatible margin object\n   */\n  margin?: Partial<Margin>;\n\n  /**\n   * Callback fired when a run is hovered\n   */\n  onHover?: (runUuid: string) => void;\n\n  /**\n   * Callback fired when no run is hovered anymore\n   */\n  onUnhover?: () => void;\n\n  /**\n   * Callback fired when the either plot's data or its layout has changed\n   */\n  onUpdate?: PlotParams['onUpdate'];\n\n  /**\n   * Width in pixels. If not provided, chart uses auto-sizing.\n   */\n  width?: number;\n\n  /**\n   * Height in pixels. If not provided, chart uses auto-sizing.\n   */\n  height?: number;\n}\n\n/**\n * Defines single axis used in compare run charts\n */\nexport interface CompareRunsChartAxisDef {\n  key: string;\n  type: 'METRIC' | 'PARAM';\n}\n\nexport interface CompareChartRunData {\n  /**\n   * Run's RunInfo object containing the metadata\n   */\n  runInfo: RunInfoEntity;\n  /**\n   * Object containing run's metrics by key\n   */\n  metrics: MetricEntitiesByName;\n  /**\n   * Object containing run's params by key\n   */\n  params: Record<string, KeyValueEntity>;\n  /**\n   * Color corresponding to the run\n   */\n  color?: string;\n}\n\n/**\n * By default, Plotly.js is capable of autosizing only on resizing window with\n * no option to observe other constraints (e.g. container resize). This hooks\n * attaches a resize observer to the chart wrapper and dynamically returns its dimensions\n * so it can be passed to the chart's layout in order to correctly maintain responsive size.\n */\nexport const useDynamicPlotSize = (throttleMs = 100) => {\n  const [layoutWidth, setLayoutWidth] = useState<undefined | number>(undefined);\n  const [layoutHeight, setLayoutHeight] = useState<undefined | number>(undefined);\n\n  const isDynamicSizeSupported = Boolean(window.ResizeObserver);\n\n  const setDimensions = useCallback((width: number, height: number) => {\n    setLayoutWidth(width);\n    setLayoutHeight(height);\n  }, []);\n\n  const setDimensionsThrottled = useMemo(\n    () =>\n      throttle(setDimensions, throttleMs, {\n        leading: true,\n      }),\n    [setDimensions, throttleMs],\n  );\n\n  const [containerDiv, setContainerDiv] = useState<HTMLDivElement | null>(null);\n\n  useEffect(() => {\n    let unmounted = false;\n    if (!containerDiv || !window.ResizeObserver) {\n      return undefined;\n    }\n    const observer = new ResizeObserver(([observerEntry]) => {\n      if (unmounted) {\n        return;\n      }\n\n      setDimensionsThrottled(observerEntry.contentRect.width, observerEntry.contentRect.height);\n    });\n\n    observer.observe(containerDiv);\n    return () => {\n      unmounted = true;\n      observer.disconnect();\n    };\n  }, [containerDiv, setDimensionsThrottled]);\n\n  return { setContainerDiv, layoutWidth, layoutHeight, isDynamicSizeSupported };\n};\n\nexport type UseMemoizedChartLayoutParams<T = any> = Pick<CompareRunsCommonPlotProps, 'margin'> & {\n  resetViewOn: T[];\n  xAxisKey: string;\n  yAxisKey: string;\n  layoutWidth?: number;\n  layoutHeight?: number;\n  additionalXAxisParams?: Partial<Layout['xaxis']>;\n  additionalYAxisParams?: Partial<Layout['yaxis']>;\n};\n\n/**\n * Styles used in all compare run charts\n */\nexport const commonRunsChartStyles = {\n  chartWrapper: { width: '100%', height: '100%', overflow: 'hidden', fontSize: 0, lineHeight: 0 },\n  chart: { width: '100%', height: '100%' },\n};\n\n/**\n * Default margin for all compare run charts\n */\nexport const compareRunsChartDefaultMargin: Partial<Margin> = {\n  t: 0,\n  b: 48,\n  r: 0,\n  l: 48,\n  pad: 0,\n};\n\n/**\n * Default hover label style for all compare run charts\n */\nexport const compareRunsChartHoverlabel = {\n  bgcolor: 'white',\n  bordercolor: '#ccc',\n  font: {\n    color: 'black',\n  },\n};\n","import { useTheme } from '@emotion/react';\nimport { Data, Datum, Layout, PlotMouseEvent } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { LazyPlot } from '../../LazyPlot';\nimport {\n  commonRunsChartStyles,\n  CompareChartRunData,\n  CompareRunsChartAxisDef,\n  compareRunsChartDefaultMargin,\n  compareRunsChartHoverlabel,\n  CompareRunsCommonPlotProps,\n  useDynamicPlotSize,\n} from './CompareRunsCharts.common';\n\nexport interface CompareRunsScatterPlotProps extends CompareRunsCommonPlotProps {\n  /**\n   * Horizontal axis with a metric or a param\n   */\n  xAxis: CompareRunsChartAxisDef;\n\n  /**\n   * Vertical axis with a metric or a param\n   */\n  yAxis: CompareRunsChartAxisDef;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: CompareChartRunData[];\n}\n\nconst PLOT_CONFIG = {\n  displaylogo: false,\n  scrollZoom: true,\n};\n\nexport const createTooltipTemplate = () =>\n  '<b>%{customdata[1]}:</b><br>' +\n  '<b>%{xaxis.title.text}:</b> %{x:.2f}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  '<extra></extra>';\n\n/**\n * Implementation of plotly.js chart displaying\n * scatter plot comparing values for a given\n * set of experiments runs\n */\nexport const CompareRunsScatterPlot = React.memo(\n  ({\n    runsData,\n    xAxis,\n    yAxis,\n    markerSize = 10,\n    className,\n    margin = compareRunsChartDefaultMargin,\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n  }: CompareRunsScatterPlotProps) => {\n    const theme = useTheme();\n\n    const { layoutHeight, layoutWidth, setContainerDiv, isDynamicSizeSupported } =\n      useDynamicPlotSize();\n\n    const plotData = useMemo(() => {\n      // Prepare empty values\n      const xValues: (number | string)[] = [];\n      const yValues: (number | string)[] = [];\n      const colors: (number | string)[] = [];\n      const tooltipData: Datum[] = [];\n\n      // Iterate through all the runs and aggregate selected metrics/params\n      for (const runData of runsData) {\n        const {\n          runInfo: { run_uuid, run_name },\n          metrics,\n          params,\n          color,\n        } = runData;\n        const xAxisData = xAxis.type === 'METRIC' ? metrics : params;\n        const yAxisData = yAxis.type === 'METRIC' ? metrics : params;\n\n        const x = xAxisData?.[xAxis.key]?.value || undefined;\n        const y = yAxisData?.[yAxis.key]?.value || undefined;\n\n        if (x && y) {\n          xValues.push(x);\n          yValues.push(y);\n          colors.push(color || theme.colors.primary);\n          tooltipData.push([run_uuid, run_name || run_uuid] as any);\n        }\n      }\n\n      return [\n        {\n          x: xValues,\n          y: yValues,\n          customdata: tooltipData,\n          hovertemplate: createTooltipTemplate(),\n          hoverlabel: compareRunsChartHoverlabel,\n          type: 'scattergl',\n          mode: 'markers',\n          marker: {\n            size: markerSize,\n            color: colors,\n          },\n        } as Data,\n      ];\n    }, [runsData, xAxis, yAxis, theme, markerSize]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: { title: xAxis.key },\n      yaxis: { title: yAxis.key },\n    });\n\n    useEffect(() => {\n      setLayout((current) => ({\n        ...current,\n        width: width || layoutWidth,\n        height: height || layoutHeight,\n        margin,\n        xaxis: { ...current.xaxis, title: xAxis.key },\n        yaxis: { ...current.yaxis, title: yAxis.key },\n      }));\n    }, [layoutWidth, layoutHeight, margin, xAxis.key, yAxis.key, width, height]);\n\n    const hoverCallback = useCallback(\n      ({ points }: PlotMouseEvent) => {\n        // Find the corresponding run\n        const dataEntry = runsData[points[0]?.pointIndex];\n        if (dataEntry?.runInfo) {\n          onHover?.(dataEntry.runInfo.run_uuid);\n        }\n      },\n      [onHover, runsData],\n    );\n\n    return (\n      <div css={commonRunsChartStyles.chartWrapper} className={className} ref={setContainerDiv}>\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onUpdate={onUpdate}\n          onHover={hoverCallback}\n          onUnhover={onUnhover}\n        />\n      </div>\n    );\n  },\n);\n","/**\n * TODO: implement actual UI for this modal, it's a crude placeholder with minimal logic for now\n */\nimport { Input, Modal } from '@databricks/design-system';\nimport { Interpolation, Theme } from '@emotion/react';\nimport { useState } from 'react';\nimport { CompareRunsChartSetup } from '../../types';\nimport { CompareRunsScatterPlot } from './charts/CompareRunsScatterPlot';\n\nexport const ConfigureChartModal = ({\n  onCancel,\n  onSubmit,\n}: {\n  onCancel: () => void;\n  onSubmit: (formData: Pick<CompareRunsChartSetup, 'type' | 'metricKey'>) => void;\n}) => {\n  const [currentFormState, setCurrentFormState] = useState<\n    Pick<CompareRunsChartSetup, 'type' | 'metricKey'>\n  >({\n    type: 'BAR',\n    metricKey: 'metric_1',\n  });\n\n  return (\n    <Modal\n      visible\n      onCancel={onCancel}\n      onOk={() => onSubmit(currentFormState)}\n      title={'[TODO] Add new chart'}\n      cancelText='Cancel'\n      okText='Confirm'\n      size='wide'\n    >\n      <div css={styles.wrapper}>\n        <div>\n          <div css={styles.field}>\n            <span>Type:</span>\n            <Input\n              value={currentFormState.type}\n              onChange={(e) => setCurrentFormState((state) => ({ ...state, type: e.target.value }))}\n            />\n          </div>\n          <div css={styles.field}>\n            <span>Metric key:</span>\n            <Input\n              value={currentFormState.metricKey}\n              onChange={(e) =>\n                setCurrentFormState((state) => ({ ...state, metricKey: e.target.value }))\n              }\n            />\n          </div>\n        </div>\n        <div css={styles.chartWrapper}>\n          <CompareRunsScatterPlot\n            runsData={[]}\n            xAxis={{ key: 'TODO', type: 'METRIC' }}\n            yAxis={{ key: 'TODO', type: 'METRIC' }}\n          />\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nconst styles = {\n  wrapper: {\n    display: 'grid',\n    gridTemplateColumns: '200px 1fr',\n    gap: 32,\n  } as Interpolation<Theme>,\n  field: {\n    display: 'grid',\n    gridTemplateColumns: '80px 1fr',\n    marginBottom: 16,\n  } as Interpolation<Theme>,\n  chartWrapper: {\n    height: 400,\n  },\n};\n","import {\n  BarChartIcon,\n  Button,\n  ChartLineIcon,\n  DropdownMenu,\n  PlusIcon,\n  Skeleton,\n  SlidersIcon,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport type {\n  CompareRunsChartSetup,\n  ExperimentStoreEntities,\n  KeyValueEntity,\n  MetricEntitiesByName,\n  UpdateExperimentSearchFacetsFn,\n} from '../../types';\nimport { RunRowType } from '../experiment-page/utils/experimentPage.row-types';\nimport { RunsCompareCharts } from './RunsCompareCharts';\nimport { SearchExperimentRunsFacetsState } from '../experiment-page/models/SearchExperimentRunsFacetsState';\nimport { ConfigureChartModal } from './ConfigureChartModal';\nimport { getUUID } from '../../../common/utils/ActionUtils';\n\nexport interface RunsCompareProps {\n  comparedRuns: RunRowType[];\n  isLoading: boolean;\n  metricKeyList: string[];\n  paramKeyList: string[];\n  searchFacetsState: SearchExperimentRunsFacetsState;\n  updateSearchFacets: UpdateExperimentSearchFacetsFn;\n\n  // Provided by redux connect().\n  paramsByRunUuid: Record<string, Record<string, KeyValueEntity>>;\n  metricsByRunUuid: Record<string, MetricEntitiesByName>;\n}\n\n/**\n * Component displaying comparison charts and differences (and in future artifacts) between experiment runs.\n * Intended to be mounted next to runs table.\n *\n * This component extracts params/metrics from redux store by itself for quicker access, however\n * it needs a provided list of compared run entries using same model as runs table.\n */\nexport const RunsCompareImpl = ({\n  comparedRuns,\n  isLoading,\n  searchFacetsState,\n  updateSearchFacets,\n}: RunsCompareProps) => {\n  const [initiallyLoaded, setInitiallyLoaded] = useState(false);\n  const [configureChartModalVisible, setConfigureChartModalVisible] = useState(false);\n\n  useEffect(() => {\n    if (!initiallyLoaded && !isLoading) {\n      setInitiallyLoaded(true);\n    }\n  }, [initiallyLoaded, isLoading]);\n\n  // TODO: implement various plot type creation\n  const addNewPlot = useCallback(() => {\n    setConfigureChartModalVisible(true);\n  }, []);\n\n  const submitForm = (formConfig: Pick<CompareRunsChartSetup, 'type' | 'metricKey'>) => {\n    // TODO: implement validation\n    const chartSetupToSave: CompareRunsChartSetup = {\n      ...formConfig,\n      uuid: getUUID(),\n    };\n\n    // Register new chart in the persistable state\n    updateSearchFacets((current) => ({\n      ...current,\n      compareRunCharts: [...current.compareRunCharts, chartSetupToSave],\n    }));\n\n    // Hide the modal\n    setConfigureChartModalVisible(false);\n  };\n\n  const removeChart = (configToDelete: CompareRunsChartSetup) => {\n    updateSearchFacets((current) => ({\n      ...current,\n      compareRunCharts: current.compareRunCharts.filter(\n        (setup) => setup.uuid !== configToDelete.uuid,\n      ),\n    }));\n  };\n\n  if (!initiallyLoaded) {\n    return (\n      <div css={styles.wrapper}>\n        <Skeleton />\n      </div>\n    );\n  }\n\n  return (\n    <div css={styles.wrapper}>\n      <div css={styles.controlsWrapper}>\n        <DropdownMenu.Root>\n          <DropdownMenu.Trigger asChild>\n            <Button icon={<PlusIcon />}>Add</Button>\n          </DropdownMenu.Trigger>\n          <DropdownMenu.Content align='end'>\n            <DropdownMenu.Group>\n              <DropdownMenu.Label>Advanced Comparison</DropdownMenu.Label>\n              <DropdownMenu.Item onClick={addNewPlot}>\n                <DropdownMenu.IconWrapper>\n                  <ChartLineIcon />\n                </DropdownMenu.IconWrapper>\n                Scatter plot\n              </DropdownMenu.Item>\n              <DropdownMenu.Item onClick={addNewPlot}>\n                <DropdownMenu.IconWrapper>\n                  <SlidersIcon />\n                </DropdownMenu.IconWrapper>\n                Contour plot\n              </DropdownMenu.Item>\n            </DropdownMenu.Group>\n            <DropdownMenu.Group>\n              <DropdownMenu.Label>Metrics</DropdownMenu.Label>\n              <DropdownMenu.Item onClick={addNewPlot}>\n                <DropdownMenu.IconWrapper>\n                  <BarChartIcon />\n                </DropdownMenu.IconWrapper>\n                (TODO) Metric 1\n              </DropdownMenu.Item>\n            </DropdownMenu.Group>\n          </DropdownMenu.Content>\n        </DropdownMenu.Root>\n      </div>\n      <RunsCompareCharts\n        comparedRuns={comparedRuns}\n        chartsConfig={searchFacetsState.compareRunCharts}\n        onRemoveChart={removeChart}\n      />\n      {configureChartModalVisible && (\n        <ConfigureChartModal\n          onSubmit={submitForm}\n          onCancel={() => setConfigureChartModalVisible(false)}\n        />\n      )}\n    </div>\n  );\n};\n\nconst styles = {\n  controlsWrapper: (theme: Theme) => ({\n    marginBottom: theme.spacing.md,\n    display: 'flex' as const,\n    justifyContent: 'flex-end',\n  }),\n  wrapper: (theme: Theme) => ({\n    // Same height as \"Show N matching runs\" label.\n    // Going to be fixed after switching to grid's fixed viewport height mode.\n\n    // Let's cover 1 pixel of the grid's border for the sleek look\n    marginLeft: -1,\n\n    position: 'relative' as const,\n    backgroundColor: theme.colors.backgroundSecondary,\n    padding: theme.spacing.md,\n    borderLeft: `1px solid ${theme.colors.border}`,\n    zIndex: 1,\n  }),\n};\n\nconst mapStateToProps = ({ entities }: { entities: ExperimentStoreEntities }) => {\n  const { paramsByRunUuid, latestMetricsByRunUuid } = entities;\n  return { paramsByRunUuid, metricsByRunUuid: latestMetricsByRunUuid };\n};\n\nexport const RunsCompare = connect(\n  mapStateToProps,\n  // mapDispatchToProps function (not provided):\n  undefined,\n  // mergeProps function (not provided):\n  undefined,\n  {\n    // We're interested only in \"entities\" sub-tree so we won't\n    // re-render on other state changes (e.g. API request IDs)\n    areStatesEqual: (nextState, prevState) => nextState.entities === prevState.entities,\n  },\n)(RunsCompareImpl);\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  ExperimentEntity,\n  ExperimentStoreEntities,\n  LIFECYCLE_FILTER,\n  MODEL_VERSION_FILTER,\n  UpdateExperimentViewStateFn,\n} from '../../../../types';\nimport {\n  experimentRunsSelector,\n  ExperimentRunsSelectorParams,\n  ExperimentRunsSelectorResult,\n} from '../../utils/experimentRuns.selector';\nimport { ExperimentViewRunsControls } from './ExperimentViewRunsControls';\nimport { ExperimentViewRunsTable } from './ExperimentViewRunsTable';\n\nimport { searchModelVersionsApi } from '../../../../../model-registry/actions';\nimport { loadMoreRunsApi, searchRunsApi, searchRunsPayload } from '../../../../actions';\nimport { GetExperimentRunsContextProvider } from '../../contexts/GetExperimentRunsContext';\nimport { useFetchExperimentRuns } from '../../hooks/useFetchExperimentRuns';\nimport { SearchExperimentRunsViewState } from '../../models/SearchExperimentRunsViewState';\nimport { ExperimentViewLoadMore } from './ExperimentViewLoadMore';\nimport Utils from '../../../../../common/utils/Utils';\nimport { ATTRIBUTE_COLUMN_SORT_KEY } from '../../../../constants';\nimport { RunRowType } from '../../utils/experimentPage.row-types';\nimport { prepareRunsGridData } from '../../utils/experimentPage.row-utils';\nimport { RunsCompare } from '../../../runs-compare/RunsCompare';\n\nexport interface ExperimentViewRunsOwnProps {\n  experiments: ExperimentEntity[];\n  modelVersionFilter?: MODEL_VERSION_FILTER;\n  lifecycleFilter?: LIFECYCLE_FILTER;\n}\n\nexport interface ExperimentViewRunsProps extends ExperimentViewRunsOwnProps {\n  runsData: ExperimentRunsSelectorResult;\n}\n\n/**\n * Creates time with milliseconds set to zero, usable in calculating\n * relative time\n */\nconst createCurrentTime = () => {\n  const mountTime = new Date();\n  mountTime.setMilliseconds(0);\n  return mountTime;\n};\n\nexport const ExperimentViewRunsImpl = React.memo((props: ExperimentViewRunsProps) => {\n  const { experiments, runsData } = props;\n\n  // Persistable sort/filter model state is taken from the context\n  const {\n    searchFacetsState,\n    updateSearchFacets,\n    fetchExperimentRuns,\n    isLoadingRuns,\n    loadMoreRuns,\n    moreRunsAvailable,\n  } = useFetchExperimentRuns();\n\n  const [visibleRuns, setVisibleRuns] = useState<RunRowType[]>([]);\n\n  // Non-persistable view model state is being created locally\n  const [viewState, setViewState] = useState(new SearchExperimentRunsViewState());\n\n  // Initial fetch of runs after mounting\n  useEffect(() => {\n    fetchExperimentRuns();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const updateViewState = useCallback<UpdateExperimentViewStateFn>(\n    (newPartialViewState) =>\n      setViewState((currentViewState) => ({ ...currentViewState, ...newPartialViewState })),\n    [],\n  );\n\n  const addColumnClicked = useCallback(() => {\n    updateViewState({ columnSelectorVisible: true });\n  }, [updateViewState]);\n\n  const { orderByKey, searchFilter, runsExpanded, runsPinned, isComparingRuns } = searchFacetsState;\n\n  const shouldNestChildrenAndFetchParents = useMemo(\n    () => (!orderByKey && !searchFilter) || orderByKey === ATTRIBUTE_COLUMN_SORT_KEY.DATE,\n    [orderByKey, searchFilter],\n  );\n\n  // Value used a reference for the \"date\" column\n  const [referenceTime, setReferenceTime] = useState(createCurrentTime);\n\n  const {\n    paramKeyList,\n    metricKeyList,\n    tagsList,\n    modelVersionsByRunUuid,\n    paramsList,\n    metricsList,\n    runInfos,\n    runUuidsMatchingFilter,\n  } = runsData;\n\n  // We're setting new reference date only when new runs data package has arrived\n  useEffect(() => {\n    setReferenceTime(createCurrentTime);\n  }, [runInfos]);\n\n  const filteredTagKeys = useMemo(() => Utils.getVisibleTagKeyList(tagsList), [tagsList]);\n\n  useEffect(() => {\n    if (isLoadingRuns) {\n      return;\n    }\n    const runs = prepareRunsGridData({\n      experiments,\n      paramKeyList,\n      metricKeyList,\n      modelVersionsByRunUuid,\n      runsExpanded,\n      tagKeyList: filteredTagKeys,\n      nestChildren: shouldNestChildrenAndFetchParents,\n      referenceTime,\n      runData: runInfos.map((runInfo, index) => ({\n        runInfo,\n        params: paramsList[index],\n        metrics: metricsList[index],\n        tags: tagsList[index],\n      })),\n      runUuidsMatchingFilter,\n      runsPinned,\n    });\n\n    setVisibleRuns(runs);\n  }, [\n    isLoadingRuns,\n    experiments,\n    metricKeyList,\n    metricsList,\n    modelVersionsByRunUuid,\n    paramKeyList,\n    paramsList,\n    runInfos,\n    runsExpanded,\n    tagsList,\n    filteredTagKeys,\n    shouldNestChildrenAndFetchParents,\n    referenceTime,\n    runsPinned,\n    runUuidsMatchingFilter,\n  ]);\n\n  return (\n    <>\n      <ExperimentViewRunsControls\n        viewState={viewState}\n        updateViewState={updateViewState}\n        runsData={runsData}\n        searchFacetsState={searchFacetsState}\n        updateSearchFacets={updateSearchFacets}\n        visibleRowsCount={visibleRuns.length}\n      />\n      <div css={styles.createRunsTableWrapper(isComparingRuns)}>\n        <ExperimentViewRunsTable\n          experiments={experiments}\n          runsData={runsData}\n          searchFacetsState={searchFacetsState}\n          viewState={viewState}\n          isLoading={isLoadingRuns}\n          updateSearchFacets={updateSearchFacets}\n          updateViewState={updateViewState}\n          onAddColumnClicked={addColumnClicked}\n          rowsData={visibleRuns}\n        />\n        {isComparingRuns && (\n          <RunsCompare\n            isLoading={isLoadingRuns}\n            comparedRuns={visibleRuns}\n            metricKeyList={runsData.metricKeyList}\n            paramKeyList={runsData.paramKeyList}\n            searchFacetsState={searchFacetsState}\n            updateSearchFacets={updateSearchFacets}\n          />\n        )}\n      </div>\n      <ExperimentViewLoadMore\n        isLoadingRuns={isLoadingRuns}\n        loadMoreRuns={loadMoreRuns}\n        moreRunsAvailable={moreRunsAvailable}\n      />\n    </>\n  );\n});\n\nconst styles = {\n  createRunsTableWrapper: (isComparingRuns: boolean) => ({\n    display: 'grid',\n    // When comparing runs, we fix the table width to 260px.\n    // We can consider making it resizable by a user.\n    gridTemplateColumns: isComparingRuns ? '260px 1fr' : '1fr',\n  }),\n};\n\n/**\n * Concrete actions for GetExperimentRuns context provider\n */\nconst getExperimentRunsActions = {\n  searchRunsApi,\n  loadMoreRunsApi,\n  searchRunsPayload,\n  searchModelVersionsApi,\n};\n\n/**\n * Function mapping redux state used in connect()\n */\nconst mapStateToProps = (\n  state: { entities: ExperimentStoreEntities },\n  params: ExperimentRunsSelectorParams,\n) => {\n  return { runsData: experimentRunsSelector(state, params) };\n};\n\n/**\n * Component responsible for displaying runs table with its set of\n * respective sort and filter controls on the experiment page.\n */\nexport const ExperimentViewRunsConnect: React.ComponentType<ExperimentViewRunsOwnProps> = connect(\n  // mapStateToProps function:\n  mapStateToProps,\n  // mapDispatchToProps function (not provided):\n  undefined,\n  // mergeProps function (not provided):\n  undefined,\n  {\n    // We're interested only in \"entities\" sub-tree so we won't\n    // re-render on other state changes (e.g. API request IDs)\n    areStatesEqual: (nextState, prevState) => nextState.entities === prevState.entities,\n  },\n)(ExperimentViewRunsImpl);\n\n/**\n * This component serves as a layer for injecting props necessary for connect() to work\n */\nexport const ExperimentViewRunsInjectFilters = (props: ExperimentViewRunsOwnProps) => {\n  const { searchFacetsState } = useFetchExperimentRuns();\n  return (\n    <ExperimentViewRunsConnect\n      {...props}\n      modelVersionFilter={searchFacetsState.modelVersionFilter as MODEL_VERSION_FILTER}\n      lifecycleFilter={searchFacetsState.lifecycleFilter as LIFECYCLE_FILTER}\n    />\n  );\n};\n\n/**\n * This component serves as a layer for creating context for searching runs\n * and provides implementations of necessary redux actions.\n */\nexport const ExperimentViewRunsInjectContext = (props: ExperimentViewRunsOwnProps) => (\n  <GetExperimentRunsContextProvider actions={getExperimentRunsActions}>\n    <ExperimentViewRunsInjectFilters {...props} />\n  </GetExperimentRunsContextProvider>\n);\n\n/**\n * Export context injection layer as a main entry point\n */\nexport const ExperimentViewRuns = ExperimentViewRunsInjectContext;\n","import { Skeleton } from '@databricks/design-system';\nimport { useEffect } from 'react';\nimport { ErrorCodes } from '../../../common/constants';\nimport NotFoundPage from '../NotFoundPage';\nimport { PermissionDeniedView } from '../PermissionDeniedView';\nimport { ExperimentViewDescriptions } from './components/ExperimentViewDescriptions';\nimport { ExperimentViewNotes } from './components/ExperimentViewNotes';\nimport { ExperimentViewOnboarding } from './components/ExperimentViewOnboarding';\nimport { ExperimentViewHeader } from './components/header/ExperimentViewHeader';\nimport { ExperimentViewHeaderCompare } from './components/header/ExperimentViewHeaderCompare';\nimport { ExperimentViewRuns } from './components/runs/ExperimentViewRuns';\nimport { useExperimentIds } from './hooks/useExperimentIds';\nimport { useExperiments } from './hooks/useExperiments';\nimport { useFetchExperiments } from './hooks/useFetchExperiments';\n\nexport const ExperimentView = () => {\n  const experimentIds = useExperimentIds();\n  const experiments = useExperiments(experimentIds);\n\n  const [firstExperiment] = experiments;\n\n  const { fetchExperiments, isLoadingExperiment, requestError } = useFetchExperiments();\n\n  useEffect(() => {\n    fetchExperiments(experimentIds);\n  }, [fetchExperiments, experimentIds]);\n\n  const isComparingExperiments = experimentIds.length > 1;\n\n  if (requestError && requestError.getErrorCode() === ErrorCodes.PERMISSION_DENIED) {\n    return <PermissionDeniedView errorMessage={requestError.getMessageField()} />;\n  }\n\n  if (requestError && requestError.getErrorCode() === ErrorCodes.RESOURCE_DOES_NOT_EXIST) {\n    return <NotFoundPage />;\n  }\n\n  if (isLoadingExperiment || !firstExperiment) {\n    return <Skeleton active />;\n  }\n\n  return (\n    <>\n      {isComparingExperiments ? (\n        <ExperimentViewHeaderCompare experiments={experiments} />\n      ) : (\n        <>\n          <ExperimentViewHeader experiment={firstExperiment} />\n          <ExperimentViewOnboarding />\n          <ExperimentViewDescriptions experiment={firstExperiment} />\n          <ExperimentViewNotes experiment={firstExperiment} />\n        </>\n      )}\n\n      <ExperimentViewRuns experiments={experiments} />\n    </>\n  );\n};\n\nexport default ExperimentView;\n","import { isEqual } from 'lodash';\nimport { useSelector } from 'react-redux';\nimport type { ExperimentEntity, ExperimentStoreEntities } from '../../../types';\n\nexport type UseExperimentsResult = ExperimentEntity[];\n\n/**\n * Hook that returns data and functions necessary for rendering\n * experiment(s) details - name, title, tags etc.\n */\nexport const useExperiments = (ids: (number | string)[]): UseExperimentsResult =>\n  useSelector(\n    (state: { entities: ExperimentStoreEntities }) =>\n      ids.map((id) => state.entities.experimentsById[id]).filter(Boolean),\n    (oldExperiments, newExperiments) => isEqual(oldExperiments, newExperiments),\n  );\n","// prettier-ignore\nimport {\n  getExperimentApi,\n  setCompareExperiments,\n  setExperimentTagApi,\n} from '../../actions';\nimport { GetExperimentsContextProvider } from './contexts/GetExperimentsContext';\nimport { ExperimentView } from './ExperimentView';\n\n/**\n * Concrete actions for GetExperiments context\n */\nconst getExperimentActions = {\n  setExperimentTagApi,\n  getExperimentApi,\n  setCompareExperiments,\n};\n\n/**\n * Main entry point for the experiment page. This component\n * provides underlying structure with context containing\n * concrete versions of store actions.\n */\nexport const ExperimentPage = () => (\n  <GetExperimentsContextProvider actions={getExperimentActions}>\n    <ExperimentView />\n  </GetExperimentsContextProvider>\n);\n\nexport default ExperimentPage;\n"],"names":["useAsyncDispatch","useDispatch","GetExperimentsContext","createContext","GetExperimentsContextProvider","children","actions","fetchExperimentsRequestIds","setFetchExperimentsRequestIds","useState","isLoadingExperiment","setIsLoadingExperiment","requestError","setRequestError","dispatch","fetchExperiments","useCallback","experimentIds","newRequestIds","map","experimentId","requestAction","getExperimentApi","catch","e","Utils","meta","id","requestIds","isEqual","fetchFn","contextValue","useMemo","Provider","value","RequestStateWrapper","shouldOptimisticallyRender","_isLoading","_renderError","requests","some","r","includes","active","forEach","request","error","PermissionDeniedView","errorMessage","theme","useDesignSystemTheme","className","style","height","marginTop","src","permissionDeniedLock","alt","paddingTop","css","color","colors","textSecondary","ExperimentViewArtifactLocation","artifactLocation","ExperimentViewDescriptions","React","experiment","styles","container","defaultMessage","experiment_id","artifact_location","display","gap","spacing","lg","useFetchExperiments","getExperimentsContext","useContext","Error","ExperimentViewNotes","storedNote","useSelector","state","tags","getExperimentTags","Object","values","find","t","getKey","NOTE_CONTENT_TAG","undefined","extractNoteFromTags","showNotesEditor","setShowNotesEditor","setExperimentTagApi","handleSubmitEditNote","updatedNote","action","then","CollapsibleSection","title","collapsibleSectionHeader","type","onClick","forceOpen","defaultCollapsed","EditableNote","defaultMarkdown","onSubmit","onCancel","showEditor","lineHeight","showTrackingHelperStoreKey","ExperimentViewOnboarding","onboardingLocalStore","storeIdentifier","ONBOARDING","LocalStorageUtils","disableOnboardingHelper","setItem","getItem","message","link","chunks","href","ExperimentTrackingDocUrl","target","rel","closable","onClose","useIntl","intl","Context","invariantIntlContext","ExperimentViewCopyTitle","size","dangerouslySetAntdProps","copyable","text","name","icon","tooltips","formatMessage","CopyButton","copyText","showTooltip","setShowTooltip","visible","navigator","clipboard","writeText","setTimeout","onMouseLeave","CopyBox","readOnly","GetLinkModal","ExperimentViewHeaderShareButton","showGetLinkModal","setShowGetLinkModal","window","top","location","ExperimentViewHeader","normalizedExperimentName","split","pop","PageHeader","breadcrumbs","ExperimentViewHeaderCompare","experiments","pageTitle","numExperiments","length","LIFECYCLE_FILTER","MODEL_VERSION_FILTER","experimentRunsSelector","params","comparingExperiments","runUuids","entities","runInfosByUuid","filter","run_uuid","modelVersionsByRunUuid","runUuidsMatchingFilter","runInfos","lifecycleFilter","ACTIVE","modelVersionFilter","ALL_RUNS","run_id","getRunInfo","rInfo","lifecycle_stage","WITH_MODEL_VERSIONS","WTIHOUT_MODEL_VERSIONS","console","warn","extractRunInfos","metricKeysSet","Set","paramKeysSet","metricsList","runInfo","metricsByRunUuid","getLatestMetrics","metrics","metric","add","key","paramsList","paramValues","getParams","param","tagsList","getRunTags","firstExperimentId","experimentTags","metricKeyList","Array","from","sort","paramKeyList","ColumnHeaderCell","handleSortBy","canonicalSortKey","orderByAsc","orderByKey","this","props","newOrderByAsc","onSortBy","render","enableSorting","displayName","getClassName","role","headerLabelWrapper","sortable","width","alignItems","justifyContent","padding","svg","actionTertiaryTextHover","headerSortIcon","marginRight","ErrorIcon","textValidationDanger","FinishedIcon","textValidationSuccess","getRunStatusIcon","status","DateCellRenderer","startTime","referenceTime","runStatus","cellWrapper","sm","ExperimentNameCellRenderer","data","to","Routes","basename","TrimmedText","maxSize","allowShowMore","trimmedText","substr","showMore","setShowMore","expandButton","ModelsCellRenderer","registeredModels","loggedModels","runUuid","models","modelToRender","modelDiv","registeredModelName","registeredModelVersion","registeredModelSvg","getModelVersionPageRoute","flavors","loggedModelFlavorText","loggedModelLink","artifactPath","loggedModelSvg","imageWrapper","img","position","SourceCellRenderer","sourceType","VersionCellRenderer","version","formatTimestamp","getDuration","getRunNameFromTags","getSourceType","getSourceName","getUser","toMap","reduce","result","entity","csvEscape","str","test","replace","runInfosToCsv","tagKeyList","columns","i","csv","j","tableToCsv","index","row","start_time","end_time","run_name","paramsMap","metricsMap","tagsMap","paramKey","push","metricKey","tagKey","EXPERIMENT_FIELD_PREFIX_PARAM","EXPERIMENT_FIELD_PREFIX_METRIC","EXPERIMENT_FIELD_PREFIX_TAG","EXPERIMENT_PARENT_ID_TAG","PinRowCellRenderer","pinnable","placement","pinWrapper","checked","onChange","onTogglePin","input","appearance","cursor","grey600","RunNameCellRenderer","onExpand","runName","runDateAndNestInfo","hasExpander","expanderOpen","childrenIds","level","renderingAsParent","isNaN","expanderWrapper","nestLevel","expanderButton","minWidth","typography","fontSizeBase","minHeight","general","heightSm","makeCanonicalSortKey","keyType","keyName","isCanonicalSortKeyOfType","canonicalKey","startsWith","createParamFieldName","createMetricFieldName","createTagFieldName","TAGS_TO_COLUMNS_MAP","ATTRIBUTE_COLUMN_SORT_KEY","COLUMN_TYPES","getRowId","ADJUSTABLE_ATTRIBUTE_COLUMNS_SINGLE_EXPERIMENT","ATTRIBUTE_COLUMN_LABELS","ADJUSTABLE_ATTRIBUTE_COLUMNS","useRunsColumnDefinitions","searchFacetsState","compareExperiments","columnApi","isComparingRuns","selectedColumns","cumulativeColumns","cachedMetricKeys","useRef","cachedParamKeys","cachedTagKeys","paramKeys","current","metricKeys","tagKeys","useCumulativeColumnKeys","columnSet","commonSortOrderProps","getOrderedByClassName","getHeaderClassName","getCellClassName","colDef","headerComponentParams","field","checkboxSelection","headerName","headerCheckboxSelection","cellClass","cellRenderer","cellRendererParams","pinned","maxWidth","resizable","colId","headerTooltip","equals","dateInfo1","dateInfo2","initialWidth","experimentName1","experimentName2","initialHide","tags1","tags2","version1","version2","models1","models2","tooltipField","canonicalSortKeys","useEffect","setColumnVisible","EXPERIMENTS_DEFAULT_COLUMN_SETUP","autoSizePadding","menuIcon","suppressMenu","suppressMovable","DeleteRunModalImpl","Component","constructor","super","handleSubmit","bind","deletePromises","selectedRunIds","runId","deleteRunApi","Promise","all","openErrorModal","number","ConfirmModal","isOpen","helpText","confirmButtonText","mapDispatchToProps","connect","RestoreRunModalImpl","restorePromises","restoreRunApi","useExperimentIds","match","useRouteMatch","useLocation","normalizedLocationSearch","decodeURIComponent","search","compareExperimentIdsQueryParam","queryParams","qs","substring","experimentIdsRaw","toString","JSON","parse","START_TIME_COLUMN_OFFSET","ALL","LAST_HOUR","LAST_24_HOURS","LAST_7_DAYS","LAST_30_DAYS","LAST_YEAR","shouldRefetchRuns","currentSearchFacetsState","newSearchFacetsState","searchFilter","createSearchRunsParams","pageToken","runViewType","ViewType","runsPinned","orderBy","createOrderByExpression","startTimeExpression","offset","createStartTimeExpression","createFilterExpression","shouldFetchParents","shouldNestChildrenAndFetchParents","fetchModelVersionsForRuns","runsPayload","actionCreator","runsWithLogModelHistory","run","chunk","MAX_RUNS_IN_SEARCH_MODEL_VERSIONS_FILTER","runsChunk","info","DEFAULT_SELECTED_COLUMNS","SearchExperimentRunsFacetsState","DEFAULT_ORDER_BY_KEY","DEFAULT_ORDER_BY_ASC","DEFAULT_START_TIME","DEFAULT_LIFECYCLE_FILTER","DEFAULT_MODEL_VERSION_FILTER","runsExpanded","compareRunCharts","KNOWN_STATE_KEYS","keys","urlParserDecoder","defaultDecoder","_","mergeFacetsStates","base","object","assign","persistLocalStorage","idKey","sortFilterModelToSave","saveComponentState","createPersistedQueryString","serializedSortFilterModelToSave","QueryString","addQueryPrefix","arrayFormat","encodeValuesOnly","restoreExperimentSearchFacetsState","locationSearch","baseState","rawLocalStorageValue","loadComponentState","model","isObject","isArray","rawUrlData","ignoreQueryPrefix","comma","arrayLimit","decoder","restData","stateData","rawURLSearchData","hasOwnProperty","isKnownField","extractExperimentSearchFacetsState","transformedStateData","urlState","queryString","GetExperimentRunsContext","GetExperimentRunsContextProvider","history","useHistory","searchRunsRequestId","setSearchRunsRequestId","isLoadingRuns","setIsLoadingRuns","moreRunsAvailable","setMoreRunsAvailable","experimentIdsHash","stringify","setSearchFacetsState","pathname","nextPageToken","isPristineFlag","isPristine","internalFetchExperimentRuns","requestSearchFacetsState","requestExperimentIds","requestReferenceTime","Date","now","requestNextPageToken","loadMore","Boolean","actionToUse","loadMoreRunsApi","searchRunsApi","next_page_token","runs","searchModelVersionsApi","loadMoreRuns","fetchExperimentRuns","persistState","newQueryString","currentLocationSearch","currentParameters","persistExperimentSearchFacetsState","updateSearchFacets","newFilterModel","updateOptions","forceRefresh","preservePristine","oldModel","newModel","isFunction","listen","useFetchExperimentRuns","getExperimentRunsContextValue","ExperimentViewRunModals","showDeleteRunModal","showRestoreRunModal","showRenameRunModal","runsSelected","onCloseDeleteRunModal","onCloseRestoreRunModal","onCloseRenameRunModal","renamedRunName","entries","selected","refreshRuns","DeleteRunModal","RestoreRunModal","RenameRunModal","onSuccess","ExperimentViewRunsControlsActions","viewState","runsData","visibleRowsCount","startTimeColumnLabels","getStartTimeColumnDisplayName","setShowDeleteRunModal","setShowRestoreRunModal","setShowRenameRunModal","setRenamedRunName","renameButtonClicked","runsSelectedList","selectedRun","compareButtonClicked","onDeleteRun","onRestoreRun","selectedRunsCount","canRestoreRuns","canRenameRuns","canCompareRuns","showActionButtons","currentLifecycleFilterLabel","currentStartTimeFilterLabel","controlBar","label","labelInValue","newStartTime","virtual","startTimeKey","disabled","danger","groupSeparator","flex","borderTop","border","UnitNumber","_ref","prefixCls","_ref$offset","concat","left","classNames","getOffset","start","end","unit","SingleNumber","unitNodes","offsetStyle","originCount","count","originValue","Number","Math","abs","_React$useState","_React$useState2","_slicedToArray","prevValue","setPrevValue","_React$useState3","_React$useState4","prevCount","setPrevCount","onTransitionEnd","timeout","clearTimeout","_extends","transition","unitNumberList","prevIndex","findIndex","n","singleUnit","transform","__rest","s","p","prototype","call","indexOf","getOwnPropertySymbols","propertyIsEnumerable","_a","customizePrefixCls","motionClassName","show","_a$component","component","restProps","getPrefixCls","ConfigContext","newProps","numberNodes","numberList","String","num","borderColor","boxShadow","cloneElement","oriProps","isPresetColor","PresetColorTypes","Badge","_classNames","_classNames2","customizeScrollNumberPrefixCls","scrollNumberPrefixCls","_a$count","_a$overflowCount","overflowCount","_a$dot","dot","_a$size","_a$showZero","showZero","_React$useContext","direction","numberedDisplayCount","hasStatus","isZero","showAsDot","mergedCount","isHidden","countRef","livingCount","displayCountRef","displayCount","isDotRef","mergedStyle","parseInt","right","titleNode","statusTextNode","displayNode","_typeof","statusCls","_defineProperty","statusStyle","background","badgeClassName","statusTextColor","CSSMotion","motionName","motionAppear","_classNames3","isDot","scrollNumberCls","scrollNumberStyle","ScrollNumber","Ribbon","_ref$placement","colorInPreset","ribbonCls","colorStyle","cornerColorStyle","ExperimentViewRefreshButtonImpl","searchRunsPayload","lastFetchTime","setLastFetchTime","newRunsCount","setNewRunsCount","interval","setInterval","searchPayloadData","maxResults","MAX_DETECT_NEW_RUNS_RESULTS","newRuns","POLL_INTERVAL","clearInterval","pill","sup","backgroundColor","lime","zIndex","ExperimentViewRefreshButton","areStatesEqual","nextState","prevState","GROUP_KEY","GROUP_KEY_ATTRIBUTES","GROUP_KEY_PARAMS","GROUP_KEY_METRICS","GROUP_KEY_TAGS","ATTRIBUTE_COLUMNS","ATTRIBUTE_COLUMNS_COMPARE","findMatching","filterQuery","v","toLowerCase","createHighlightedNode","beforeStr","matchStr","afterStr","ExperimentViewRunsColumnSelectorImpl","columnSelectorVisible","onChangeColumnSelectorVisible","setFilter","searchInputRef","scrollableContainerRef","buttonRef","attributeColumnNames","setCheckedColumns","updateFn","facets","newColumns","uniqueNewColumns","tagsKeyList","canonicalKeyNames","treeData","filteredAttributes","filteredParams","filteredMetrics","filteredTags","attributeKey","toggleGroup","isChecked","keyList","k","toggleSingleKey","requestAnimationFrame","scrollTo","focus","preventScroll","scrollIntoView","block","behavior","onCheck","node","columnType","slice","canonicalKeysForGroup","searchInputKeyDown","treeElement","parent","querySelector","dropdownContent","dropdown","md","prefix","placeholder","allowClear","ref","onKeyDown","scrollableContainer","mode","checkedKeys","defaultExpandedKeys","overlay","trigger","onVisibleChange","ExperimentViewRunsColumnSelector","white","maxHeight","overflowY","overflowX","paddingBottom","whiteSpace","textOverflow","overflow","ExperimentViewRunsControlsFilters","updateViewState","onDownloadCsv","sortOptions","searchFilterValue","setSearchFilterValue","sortKeyChanged","compiledOrderByKey","newOrderBy","newOrderAscending","SORT_DELIMITER_SYMBOL","columnToAdd","isOrderAscending","COLUMN_SORT_BY_ASC","currentFacets","clearFacetsState","cleanSearchFacetsState","changeColumnSelectorVisible","currentSortSelectValue","COLUMN_SORT_BY_DESC","currentSortSelectLabel","sortOption","option","sortOptionLabel","extractedKeyName","groupBar","searchBox","searchBarIcon","suffix","searchInputSuffix","whereBold","ExperimentSearchSyntaxDocUrl","overlayInnerStyle","sortSelectControl","dropdownStyle","sortSelectDropdown","order","sortMenuArrowWrapper","middleTruncateStr","gridTemplateColumns","flexWrap","columnSwitch","margin","lifecycleFilters","marginBottom","marginLeft","ExperimentViewRunsControls","filteredParamKeys","filteredMetricKeys","filteredTagKeys","blob","Blob","saveAs","downloadRunsCsv","ColumnSortByOrder","ATTRIBUTE_COLUMN_SORT_LABEL","options","sortLabelKey","sortLabel","useRunSortOptions","wrapper","flexDirection","MLFlowAgGridImpl","MLFlowAgGridLoader","fallback","cssTheme","ExperimentRunsTableEmptyOverlay","getLearnMoreLinkUrl","LoggingRunsDocUrl","learnMoreLinkUrl","newLine","fontSize","pointerEvents","CLASS_OUT_OF_VIEWPORT","CLASS_IS_HIDDEN","CLASS_IS_MINIMIZED","AG_GRID_CLS","ExperimentViewRunsTableAddColumnCTA","gridContainerElement","isInitialized","moreAvailableParamsAndMetricsColumnCount","ctaRef","savedContainerRef","initialize","containerElement","ResizeObserver","targetElement","rootElement","refLeftElem","refCenterElem","refHeaderElem","gridAreaWidth","leftColContainerWidth","centerColContainerWidth","colContainerHeight","headerHeight","resizeObserver","entry","contentRect","calculatedLeft","calculatedTop","classList","remove","observe","disconnect","columnContainer","buttonContainer","button","buttonIcon","caption","grey200","borderLeft","willChange","paddingLeft","paddingRight","xs","ExperimentViewRunsTable","isLoading","onAddColumnClicked","rowsData","gridApi","setGridApi","setColumnApi","prevSelectRunUuids","expandersVisible","onSelectionChange","api","selectedUUIDs","getSelectedRows","aggregate","curr","handleRowSelected","event","selectedRows","isSelected","isParent","childrenIdsToSelect","forEachNode","childRunDateInfo","childrenRunUuid","setSelected","newOrderByKey","toggleRowExpanded","parentId","currentRunsExpanded","togglePinnedRow","uuid","existingFacets","rowNode","getRowNode","redrawRows","rowNodes","gridReadyHandler","columnDefs","showLoadingOverlay","hideOverlay","setRowData","allAvailableColumnsCount","hasSelectedAllColumns","moreAvailableParamsAndMetricsColumns","selectedMetricsAndParamsColumns","allMetricsAndParamsColumns","max","displayAddColumnsCTA","useLayoutEffect","sizeColumnsToFit","cx","agGridOverrides","defaultColDef","domLayout","rowSelection","onGridReady","onSelectionChanged","rowHeight","onRowSelected","suppressRowClickSelection","suppressColumnMoveAnimation","suppressScrollOnNewData","suppressFieldDotNotation","enableCellTextSelection","components","agColumnHeader","loadingOverlayComponent","Spinner","suppressNoRowsOverlay","loadingOverlayComponentParams","showImmediately","noResultsWrapper","textAlign","backgroundPrimary","gridColors","rowBackground","rowBackgroundHover","rowBackgroundSelected","rowBackgroundHoverSelected","columnSortedBy","blue100","headerBackground","grey100","headerTextColor","headerGroupTextColor","headerBorderColor","checkboxBorderColor","actionDefaultBorderDefault","checkboxBorderColorChecked","checkboxBackgroundColorChecked","actionPrimaryBackgroundDefault","getGridColors","borderRadius","content","opacity","borderRight","SearchExperimentRunsViewState","hiddenChildRunsSelected","nestedRunsTooltipWrapper","ExperimentViewLoadMore","currentRunUUIDs","containsNestedRuns","tagsByRunUuid","tagList","loadMoreButton","loading","getFlatRowRenderMetadata","runData","isPinnable","createKeyValueDataForRunRow","list","isNumber","prepareRunsGridData","nestChildren","experimentNameMap","rowRenderMetadata","runIdToIndex","treeNodes","foundHierarchy","parentRunId","parentRunIndex","parentIdToChildren","rootIndexes","treeNode","resultRowsMetadata","visited","doDfs","dfsIndex","currLevel","has","currentNodeRunInfo","currentNodeRunId","rowMetadata","cIdx","childrenIndices","dIdx","rootNodeIndex","getNestedRowRenderMetadata","childrenToPin","runInfoMetadata","formattedMetrics","experimentName","user","duration","visibleTags","isCurrentRowPinned","isParentPinned","ChartSamplePlaceholderData","viewBox","fill","xmlns","d","stroke","strokeWidth","strokeLinecap","strokeLinejoin","x1","y1","x2","y2","SampleChartCard","config","onDelete","chartEntry","chartEntryTitle","asChild","align","RunsCompareCharts","chartsConfig","onRemoveChart","chartsWrapper","chartConfig","borderRadiusBase","commonRunsChartStyles","chartWrapper","chart","compareRunsChartDefaultMargin","b","l","pad","compareRunsChartHoverlabel","bgcolor","bordercolor","font","PLOT_CONFIG","displaylogo","scrollZoom","CompareRunsScatterPlot","xAxis","yAxis","markerSize","onUpdate","onHover","onUnhover","useTheme","layoutHeight","layoutWidth","setContainerDiv","isDynamicSizeSupported","throttleMs","setLayoutWidth","setLayoutHeight","setDimensions","setDimensionsThrottled","throttle","leading","containerDiv","unmounted","observer","observerEntry","useDynamicPlotSize","plotData","xValues","yValues","tooltipData","xAxisData","yAxisData","x","y","primary","customdata","hovertemplate","hoverlabel","marker","layout","setLayout","xaxis","yaxis","hoverCallback","points","dataEntry","pointIndex","LazyPlot","L","useResizeHandler","ConfigureChartModal","currentFormState","setCurrentFormState","onOk","cancelText","okText","controlsWrapper","backgroundSecondary","RunsCompare","paramsByRunUuid","latestMetricsByRunUuid","comparedRuns","initiallyLoaded","setInitiallyLoaded","configureChartModalVisible","setConfigureChartModalVisible","addNewPlot","configToDelete","setup","formConfig","chartSetupToSave","getUUID","createCurrentTime","mountTime","setMilliseconds","ExperimentViewRunsImpl","visibleRuns","setVisibleRuns","setViewState","newPartialViewState","currentViewState","addColumnClicked","setReferenceTime","createRunsTableWrapper","getExperimentRunsActions","ExperimentViewRunsConnect","ExperimentViewRunsInjectFilters","ExperimentViewRuns","ExperimentView","ids","experimentsById","oldExperiments","newExperiments","firstExperiment","isComparingExperiments","getErrorCode","ErrorCodes","getMessageField","NotFoundPage","getExperimentActions","setCompareExperiments","ExperimentPage"],"sourceRoot":""}